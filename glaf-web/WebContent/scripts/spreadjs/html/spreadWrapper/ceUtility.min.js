var GcSpread;(function(n){(function(n){(function(t){var i=function(){function i(){}return i.unparse=function(n,r,u,f){return i.calcService||(i.calcService=t.wrapper.spread.calcService),i.calcService.unparse(n,r,u,f)},i.parse=function(n,r,u,f,e,o){return i.calcService||(i.calcService=t.wrapper.spread.calcService),i.calcService.parse(n,r,u,f,e,o)},i.parseRangeToExpString=function(r){var f=t.SpreadUtility.getRangeType(r),u;return f==3?(u=new n.Calc.Expressions.RangeExpression,u.initBand(0,r.rowCount-1,!0,!0,!0),i.unparse(null,u,0,0)):f==0?(u=new n.Calc.Expressions.RangeExpression,u.initBand(r.col,r.col+r.colCount-1,!0,!0,!1),i.unparse(null,u,0,0)):f==1?(u=new n.Calc.Expressions.RangeExpression,u.initBand(r.row,r.row+r.rowCount-1,!0,!0,!0),i.unparse(null,u,0,0)):f==2?(u=new n.Calc.Expressions.RangeExpression(r.row,r.col,r.row+r.rowCount-1,r.col+r.colCount-1,!0,!0,!0,!0),i.unparse(null,u,0,0)):void 0},i.parseExpStringToRanges=function(r){var o=[],l=r.split(","),e,f,v;try{for(e=0;e<l.length;e++){f=i.parse(null,l[e],0,0);if(f instanceof n.Calc.Expressions.RangeExpression){var u=f,a=u.startRow,c=u.startColumn,s=u.endRow-u.startRow+1,h=u.endColumn-u.startColumn+1;u.isFullRow&&(c=-1,h=t.wrapper.spread.getActiveSheet().getColumnCount()),u.isFullColumn&&(a=-1,s=t.wrapper.spread.getActiveSheet().getRowCount()),o.push(new n.Range(a,c,s,h))}else if(f instanceof n.Calc.Expressions.CellExpression)v=f,o.push(new n.Range(f.row,f.column,1,1));else return null}}catch(y){return null}return o},i.parseExternalRangeToString=function(n){var t="";return n.resource&&(t+="'"+n.resource.name()+"'"),n.range&&(t+=i.parseRangeToExpString(n.range)),t},i.parseStringToExternalRanges=function(r){var o=[],l=r.split(","),s,u,y,e;try{for(s=0;s<l.length;s++){u=i.parse(null,l[s],0,0);if(u instanceof n.Calc.Expressions.RangeExpression||u instanceof n.Calc.Expressions.ExternalRangeExpression){var f=u,a=f.startRow,v=f.startColumn,h=f.endRow-f.startRow+1,c=f.endColumn-f.startColumn+1;f.isFullRow&&(v=-1,c=t.wrapper.spread.getActiveSheet().getColumnCount()),f.isFullColumn&&(a=-1,h=t.wrapper.spread.getActiveSheet().getRowCount()),e=new n.Range(a,v,h,c),u instanceof n.Calc.Expressions.ExternalRangeExpression?u.source&&u.source._sheet&&o.push({range:e,resource:u.source._sheet}):o.push({range:e})}else if(u instanceof n.Calc.Expressions.CellExpression)y=u,e=new n.Range(u.row,u.column,1,1),o.push({range:e});else return null}}catch(p){return null}return o},i}();t.CEUtility=i})(n.designer||(n.designer={}));var t=n.designer})(n.Sheets||(n.Sheets={}));var t=n.Sheets})(GcSpread||(GcSpread={}))