var GcSpread;
(function (n) {
	(function (t) {
		(function (i) {
			(function (r) {
				"use strict";
				function h() {
					var n = r.spread.getActiveSheet().currentTheme().colors();
					return [{
							name : "Background 1",
							baseColor : n.getColor("Background 1")
						}, {
							name : "Text 1",
							baseColor : n.getColor("Text 1")
						}, {
							name : "Background 2",
							baseColor : n.getColor("Background 2")
						}, {
							name : "Text 2",
							baseColor : n.getColor("Text 2")
						}, {
							name : "Accent 1",
							baseColor : n.getColor("Accent 1")
						}, {
							name : "Accent 2",
							baseColor : n.getColor("Accent 2")
						}, {
							name : "Accent 3",
							baseColor : n.getColor("Accent 3")
						}, {
							name : "Accent 4",
							baseColor : n.getColor("Accent 4")
						}, {
							name : "Accent 5",
							baseColor : n.getColor("Accent 5")
						}, {
							name : "Accent 6",
							baseColor : n.getColor("Accent 6")
						}
					]
				}
				function o(o) {
					var h,
					a,
					s;
					for (typeof o == "undefined" && (o = !1), o || (r.spread.destroy(), u.empty(), r.spread = null), r.spread = new t.Spread(u[0], {
								sheetCount : 2
							}), r.spreadElement = u, i.formulaBar.initFormulaBar(o), i.contextMenu.addTabStripEvents(), h = 0; h < r.spread.getSheetCount(); h++)
						a = r.spread.sheets[h], a.addKeyMap(113, !1, !1, !1, !1, function () {
							this.isEditing() || this.startEdit()
						});
					r.shouldModifiedHandlerExecute = app.isNative && app.getLicenseStatus() !== LicenseStatus.Valid && app.getLicenseStatus() !== LicenseStatus.Trial ? !1 : !0,
					s = function () {
						i.actions.isFileModified = !0,
						r.shouldModifiedHandlerExecute && (i.actions.updateWindowTitle(), r.shouldModifiedHandlerExecute = !1)
					},
					r.spread.bind(t.Events.CellChanged, s),
					r.spread.bind(t.Events.RowChanged, s),
					r.spread.bind(t.Events.ColumnChanged, s),
					r.spread.bind(t.Events.ActiveSheetChanged, s),
					r.spread.bind(t.Events.InvalidOperation, function (n, t) {
						t.invalidType === 5 && i.MessageBox.show(t.message, i.res.title, 3)
					}),
					r.spread.bind(n.Sheets.Events.CustomFloatingObjectLoaded, function (n, t) {
						c(r.spread, t.customFloatingObject, t.element)
					}),
					r.spread.bind(n.Sheets.Events.RangeChanged, function (n, t) {
						var i = r.spread.getActiveSheet(),
						e = i.getActiveRowIndex(),
						u = i.getActiveColumnIndex();
						t.action === 0 && $(".ribbon-bar").gcuiribbon("setTabPageVisible", "tableTab", i.findTable(e, u));
						if (t.action === 2) {
							f();
							if (i.findTable(e, u)) {
								$(".ribbon-bar").gcuiribbon("setTabPageVisible", "tableTab", !0),
								$(".ribbon-bar").gcuitabs("select", "tableTab");
								return
							}
							$(".ribbon-bar").gcuiribbon("setButtonDisabled", "insert-table", !1),
							$(".ribbon-bar").gcuiribbon("setTabPageVisible", "homeTab", !0),
							$(".ribbon-bar").gcuitabs("select", "homeTab")
						}
					}),
					r.spread.bind(n.Sheets.Events.FloatingObjectRemoved, function (n, i) {
						if (i.floatingObject instanceof t.Slicer) {
							f();
							var u = r.spread.getActiveSheet(),
							o = u.getActiveRowIndex(),
							e = u.getActiveColumnIndex();
							u.findTable(o, e) ? ($(".ribbon-bar").gcuiribbon("setTabPageVisible", "tableTab", !0), $(".ribbon-bar").gcuitabs("select", "tableTab")) : ($(".ribbon-bar").gcuiribbon("setTabPageVisible", "homeTab", !0), $(".ribbon-bar").gcuitabs("select", "homeTab"))
						}
					}),
					l(),
					i.ribbon.attachEvent(),
					e(),
					i.ribbon.resetSpreadNamedStyle()
				}
				function f() {
					var n = 6;
					$(".ribbon-bar>ul").find("li:gt(" + n + ")").css("display", "none"),
					$(".ribbon-bar>div:gt(" + n + ")").attr("aria-hidden", !0)
				}
				function l() {
					$(".custom-format-table").css("display", "none"),
					$(".custom-preview").find(".table-format-preview").css("display", "none"),
					i.FormatTableDialog.customTableStyle = {},
					i.FormatTableDialog.currentId = 1,
					$(".custom-format-slicer").css("display", "none"),
					$(".slicer-custom-preview").find(".slicer-format-preview").css("display", "none"),
					i.SlicerStyleDialog.customSlicerStyle = {},
					i.SlicerStyleDialog.currentId = 1
				}
				function a() {
					var n,
					f = r.spread.getActiveSheet(),
					t = i.util.getSelectedSlicers(f),
					u;
					if (t && t.length !== 0)
						t.length === 1 ? (u = t[0], n = u.captionName(), n = '"' + n + '"') : n = "Slicers";
					else
						return;
					return n
				}
				function c(n, r, u) {
					var h = r,
					o = $(".slicer-contextmenu-width"),
					f = $("#name-container"),
					v = 100,
					l = 175,
					e = 400,
					c;
					if (!(h instanceof t.Slicer))
						return;
					c = u,
					$(c).bind("contextmenu", function (r) {
						var p = n.getActiveSheet(),
						c,
						u,
						y;
						if (p.getIsProtected() && h.isLocked() && !p.protectionOption().allowEditObjects) {
							t.util.cancelDefault(r);
							return
						}
						u = a();
						if (u === undefined)
							return;
						o.removeClass("hidden"),
						f.text(u),
						c = f.width(),
						c > e && (c = e, u = s(o, f, u, e)),
						$("#removedSlicerName").text(i.res.contextMenu.remove + " " + u),
						y = c + v,
						y < l ? $("#slicer-menu").width(l) : $("#slicer-menu").width(y),
						o.addClass("hidden"),
						$(".context-menu").removeClass("hidden"),
						$("#slicer-menu").removeClass("hidden"),
						$("#tabstrip-menu").addClass("hidden"),
						$("#sheet-menu").addClass("hidden"),
						$("#comment-menu").addClass("hidden"),
						$("#slicer-menu").position({
							my : "left top",
							of : r
						}),
						t.util.cancelDefault(r)
					})
				}
				function s(n, t, i, r) {
					var e,
					u,
					f;
					if (!i)
						return;
					if (i.length < 20)
						return;
					e = 5,
					n.hasClass("hidden") && n.removeClass("hidden"),
					u = i.length;
					while (u > 0) {
						i = i.substring(0, u - e) + "...",
						t.text(i),
						f = t.width();
						if (f < r)
							break;
						u = i.length
					}
					return i = '"' + i + '"'
				}
				function e() {
					r.spread.getActiveSheet() && r.spread.focus(!0)
				}
				r.spread;
				var u;
				r.spreadElement,
				r.getThemeColors = h,
				r.shouldModifiedHandlerExecute = !0,
				r.reset = o,
				r.setFocusToSpread = e,
				i.loader.ready(function () {
					u = $(".spreadWrapper .ss"),
					o(!0)
				})
			})(i.wrapper || (i.wrapper = {}));
			var r = i.wrapper
		})(t.designer || (t.designer = {}));
		var i = t.designer
	})(n.Sheets || (n.Sheets = {}));
	var t = n.Sheets
})(GcSpread || (GcSpread = {}))
