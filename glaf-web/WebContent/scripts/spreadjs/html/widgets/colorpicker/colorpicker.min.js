var __extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype,n.prototype=new r},GcSpread;(function(n){(function(n){(function(n){var u="colorpicker",i=function(i){function u(){i.apply(this,arguments)}return __extends(u,i),u.prototype._create=function(){var i=this.options,o,h,s,u,e,n;this.colorItems=[];var t=$("<div class='colorpicker-outDiv'></div>"),f=this._createThemeColorFrame(),c=this._createStandardColorFrame();i.showThemeColorTitle||(o=f.find("tr").get(0),$(o).css("display","none")),i.showStandardColorTitle||(h=c.find("tr").get(0),$(h).css("display","none"),u=$("<span class='colorpicker-horizontalseparator'></span>"),$(u).css("margin","5px"),f.append(u),$(f).find(".colorpicker-colorcell").css("margin","1px")),i.showOutline||t.css("border","0px"),t.append(f,c),i.showNoFill&&(s=this._createNoColorFrame(),t.append(s)),i.showMoreColors&&(u=$("<span class='colorpicker-horizontalseparator'></span>"),e=this._createMoreColorFrame(),t.append(u,e)),t.appendTo(this.element),t.bind("selectstart",function(){return!1}),this._addEvents();if(this.dialog===null||this.dialog===undefined){this.dialog=new r,this.dialog._create(),n=this;$(this.dialog).on("dialogClose",function(t,i){if(i){var r;r={color:n.dialog.value},n._clearSelection(),n._setSelection(n.dialog.value),n.options.value=n.dialog.value,n.options.selectedItem={name:"",baseColor:"",tint:0,color:n.dialog.value},n._raiseValueChanged(t,r)}})}},u.prototype._createThemeColorFrame=function(){var r=this._initThemeColors(this.options.themeColors),c=$("<div></div>"),h=$("<table class='colorpicker-colortable' cellspacing= 0 cellpadding= 0></table>"),e=$("<tbody></tbody>"),s=$("<tr></tr>"),o=$("<td></td>"),t,u,n,f,i;for(o.attr("colspan","10"),o.append($("<div class='colorpicker-title colorpicker-div-themecolor-title'></div>").text(this.options.themeColorsTitle)),s.append(o),e.append(s),t=0;t<6;t++){for(u=$("<tr></tr>"),this.colorItems[t]=[],t===0&&u.addClass("colorpicker-themecolors-firstline"),n=0;n<10;n++)f=$("<td></td>"),i=$("<div></div>"),i.addClass("colorpicker-colorcell"),t===0?(i.css("background",this.options.themeColors[n].baseColor),i.attr("row","0"),i.attr("col",n.toString()),this.colorItems[t][n]={name:this.options.themeColors[n].name,baseColor:this.options.themeColors[n].baseColor,tint:0,color:this.options.themeColors[n].baseColor}):(i.css("background",r[n*5+t-1].color),i.attr("row",t.toString()),i.attr("col",n.toString()),this.colorItems[t][n]={name:this.options.themeColors[n].name+" "+r[n*5+t-1].tint.toString(),baseColor:this.options.themeColors[n].baseColor,tint:r[n*5+t-1].tint,color:r[n*5+t-1].color}),i.append($("<div class='colorpicker-div-inner-colorcell'></div>")),f.append(i),u.append(f);e.append(u)}return h.append(e),c.append(h),c},u.prototype._createStandardColorFrame=function(){var i,n,r,t;this.colorItems[6]=[];var e=$("<div></div>"),o=$("<table class='colorpicker-colortable' cellspacing= 0 cellpadding= 0></table>"),f=$("<tbody></tbody>"),s=$("<tr></tr>"),u=$("<td></td>");for(u.attr("colspan","10"),u.append($("<div class='colorpicker-title colorpicker-div-standardcolor-title'></div>").text(this.options.standardColorsTitle)),s.append(u),f.append(s),i=$("<tr></tr>"),n=0;n<10;n++)r=$("<td></td>"),t=$("<div></div>"),t.css("background",this.options.standardColors[n].baseColor),t.attr("row","6"),t.attr("col",n.toString()),this.colorItems[6][n]={name:this.options.standardColors[n].name,baseColor:this.options.standardColors[n].baseColor,tint:0,color:this.options.standardColors[n].baseColor},t.addClass("colorpicker-colorcell"),t.append($("<div class='colorpicker-div-inner-colorcell'></div>")),r.append(t),i.append(r);return f.append(i),o.append(f),e.append(o),e},u.prototype._createNoColorFrame=function(){var n=$("<div class='colorpicker-div-nocolor'></div>");return n.append($("<table class='colorpicker-table-nocolor'><tbody><tr><td class='colorpicker-td-nocolor-image'><div class='colorpicker-div-out-nofill' ><div class='colorpicker-div-nocolor-image'></div></div></td><td><span class='colorpicker-verticalseparator'></span><label class='colorpicker-Labeltext colorpicker-label-nofill-text'>"+this.options.noFillText+"</label></td></tr></tbody></table>")),n},u.prototype._createMoreColorFrame=function(){var n=$("<div class='colorpicker-div-morecolors' ></div>");return n.append($("<table class='colorpicker-table-morecolors'><tbody><tr><td class='colorpicker-td-morecolors-image'><div class='colorpicker-div-morecolor-icon'></div></td><td><span class='colorpicker-verticalseparator'></span><label class='colorpicker-Labeltext colorpicker-label-morecolors-text'>"+this.options.moreColorsText+"</label></td></tr></tbody></table>")),n},u.prototype._addEvents=function(){var n=this;this.element.find(".colorpicker-colorcell").on("mouseover.colorpicker",function(t){var u=t.target||t.srcElement,i=u,r;i.className.indexOf("colorpicker-div-inner-colorcell")!==-1&&(i=i.parentElement),(n.options.value==""||i.style.background!=n.options.value)&&($(i).addClass("hover"),r=i.childNodes[0],$(r).addClass("hover"))});this.element.find(".colorpicker-colorcell").on("mousedown.colorpicker",function(t){var r,f,h=t.target||t.srcElement,i=h,s,e,u,o;i.className.indexOf("colorpicker-div-inner-colorcell")!==-1&&(i=i.parentElement),r=$(i).attr("col"),f=$(i).attr("row"),n._raiseChoosedColor(t,n.colorItems[f][r]);if($(i).hasClass("selected"))return;$(i).removeClass("hover").addClass("selected"),s=i.childNodes[0],$(s).removeClass("hover").addClass("selected");if(n.options.value!=="")if(n.options.value===undefined)n.element.find(".colorpicker-div-out-nofill").removeClass("selected");else for(e=n.element.find(".colorpicker-colorcell"),u=0;u<e.length;u++)e[u].style.background===n.options.value&&($(e[u]).removeClass("selected"),o=e[u].childNodes[0],$(o).removeClass("selected"));n.options.value=n._convertColor(i.style.background),n.colorItems[f][r].color=n._convertColor(n.colorItems[f][r].color),n.options.selectedItem=n.colorItems[f][r],n._raiseValueChanged(t,n.colorItems[f][r])});this.element.find(".colorpicker-colorcell").on("mouseout.colorpicker",function(t){var u=t.target||t.srcElement,i=u,r;i.className.indexOf("colorpicker-div-inner-colorcell")!==-1&&(i=i.parentElement),(n.options.value==""||i.style.background!=n.options.value)&&($(i).removeClass("hover"),r=i.childNodes[0],$(r).removeClass("hover"))});this.element.find(".colorpicker-div-nocolor,.colorpicker-div-morecolors").on("mouseover.colorpicker",function(t){var f=t.target||t.srcElement,u=f,i=n.element.find(".colorpicker-div-nocolor"),r=n.element.find(".colorpicker-div-morecolors");i.length>0&&i[0].contains(u)?i.addClass("hovered"):r.length>0&&r[0].contains(u)&&r.addClass("hovered")});this.element.find(".colorpicker-div-nocolor").on("mousedown.colorpicker",function(t){var r,i,u;n.element.find(".colorpicker-div-out-nofill").addClass("selected");if(n.options.value!=="")for(r=n.element.find(".colorpicker-colorcell"),i=0;i<r.length;i++)if(r[i].style.background===n.options.value){$(r[i]).removeClass("selected"),u=r[i].childNodes[0],$(u).removeClass("selected");break}n.options.value=undefined,n.options.selectedItem=undefined,n._raiseValueChanged(t,undefined),n._raiseChoosedColor(t,undefined)});this.element.find(".colorpicker-div-nocolor,.colorpicker-div-morecolors").on("mouseout.colorpicker",function(t){var f=t.target||t.srcElement,u=f,i=n.element.find(".colorpicker-div-nocolor"),r=n.element.find(".colorpicker-div-morecolors");i.length>0&&i[0].contains(u)?i.removeClass("hovered"):r.length>0&&r[0].contains(u)&&r.removeClass("hovered")});this.element.find(".colorpicker-div-morecolors").on("click.colorpicker",function(t){n._raiseOpenColorDialog(t),n._showColorDialog()})},u.prototype._removeEvent=function(){this.element.find(".colorpicker-colorcell,.colorpicker-div-nocolor,.colorpicker-div-morecolors").off(".colorpicker")},u.prototype._showColorDialog=function(){this.dialog.value=this.options.value,this.dialog.value===""||this.dialog.value===undefined?this.dialog._updateColor(!0,"rgb(0,0,0)"):this.dialog._updateColor(!0,this.dialog.value),this.dialog.open()},u.prototype._setOption=function(n,t){n==="noFillText"?(this.options.noFillText=t,this.options.showNoFill&&this.element.find(".colorpicker-label-nofill-text").text(t)):n==="moreColorsText"?(this.options.moreColorsText=t,this.options.showMoreColors&&this.element.find(".colorpicker-label-morecolors-text").text(t)):n==="showNoFill"?(this.options.showNoFill=t,this._redraw()):n==="showMoreColors"?(this.options.showMoreColors=t,this._redraw()):n==="themeColorsTitle"?(this.options.themeColorsTitle=t,this.element.find(".colorpicker-div-themecolor-title").text(t)):n==="standardColorsTitle"?(this.options.standardColorsTitle=t,this.element.find(".colorpicker-div-standardcolor-title").text(t)):n==="themeColors"?(this.options.themeColors=t,this._redraw()):n==="standardColors"?(this.options.standardColors=t,this._redraw()):n==="value"?(t=this._convertColor(t),this._setSelection(t),this.options.value=t,this.options.selectedItem={name:"",baseColor:"",tint:0,color:t}):n==="selectedItem"?t===undefined||t===null?(this._clearSelection(),this.options.selectedItem=t,this.options.value=t):(t.color=this._convertColor(t.color),this._setSelectionbyItem(t),this.options.selectedItem=t,this.options.value=this.options.selectedItem.color):n==="showThemeColorTitle"?(this.options.showThemeColorTitle=t,this._redraw()):n==="showStandardColorTitle"?(this.options.showStandardColorTitle=t,this._redraw()):n==="showOutline"&&(this.options.showOutline=t,this._redraw())},u.prototype._redraw=function(){this._removeEvent(),this.element.empty(),this._create()},u.prototype._convertColor=function(n){return $("<span></span>").css("background-color",n).css("background-color")},u.prototype._setSelection=function(n){var u,i,t,r;if(this.options.value!=="")if(this.options.value===undefined)this.element.find(".colorpicker-div-out-nofill").removeClass("selected");else for(i=this.element.find(".colorpicker-colorcell"),t=0;t<i.length;t++)if(i[t].style.background===this.options.value){$(i[t]).removeClass("selected"),u=i[t].childNodes[0],$(u).removeClass("selected");break}if(n!=="")if(n===undefined)this.element.find(".colorpicker-div-out-nofill").addClass("selected");else for(i=this.element.find(".colorpicker-colorcell"),t=0;t<i.length;t++)if(i[t].style.background===n){$(i[t]).addClass("selected"),r=i[t].childNodes[0],$(r).addClass("selected");break}},u.prototype._clearSelection=function(){var t,f,e,i,r,n,u;if(this.options.selectedItem!==null)if(this.options.selectedItem===undefined)this.element.find(".colorpicker-div-out-nofill").removeClass("selected");else{t=this.element.find(".colorpicker-colorcell");if(this.options.selectedItem.name!==null&&this.options.selectedItem.name!==undefined){for(f=-1,e=-1,i=0;i<this.colorItems.length;i++){for(r=0;r<this.colorItems[i].length;r++)if(this.colorItems[i][r].name===this.options.selectedItem.name){f=i,e=r;break}if(f!==-1&&e!==-1)break}for(n=0;n<t.length;n++)if($(t[n]).attr("row")===f.toString()&&$(t[n]).attr("col")===e.toString()){$(t[n]).removeClass("selected"),u=t[n].childNodes[0],$(u).removeClass("selected");break}}else for(n=0;n<t.length;n++)if(t[n].style.background===this.options.selectedItem.color){$(t[n]).removeClass("selected"),u=t[n].childNodes[0],$(u).removeClass("selected");break}}},u.prototype._setSelectionbyItem=function(n){var i,e,o,r,u,t,f;this._clearSelection();if(n!=="")if(n===undefined)this.element.find(".colorpicker-div-out-nofill").addClass("selected");else{i=this.element.find(".colorpicker-colorcell");if(n.name!==null&&n.name!==undefined){for(e=-1,o=-1,r=0;r<this.colorItems.length;r++){for(u=0;u<this.colorItems[r].length;u++)if(this.colorItems[r][u].name===n.name){e=r,o=u;break}if(e!==-1&&o!==-1)break}for(t=0;t<i.length;t++)if($(i[t]).attr("row")===e.toString()&&$(i[t]).attr("col")===o.toString()){$(i[t]).addClass("selected"),f=i[t].childNodes[0],$(f).addClass("selected");break}}else for(t=0;t<i.length;t++)if(i[t].style.background===n.color){$(i[t]).addClass("selected"),f=i[t].childNodes[0],$(f).addClass("selected");break}}},u.prototype._raiseValueChanged=function(n,t){this._trigger("valueChanged",n,t)},u.prototype._raiseOpenColorDialog=function(n){this._trigger("openColorDialog",n)},u.prototype._raiseChoosedColor=function(n,t){this._trigger("choosedColor",n,t)},u.prototype._initThemeColors=function(n){for(var u=[],e,i,r=0;r<n.length;r++)u.push(n[r].baseColor);var o=5,f=[],s=[-5,-15,-25,-35,-50],h=[-10,-25,-50,-75,-90],c=[80,60,40,-25,-50];for(r=0;r<10;r++)for(e=t._getColorBrightness(u[r]),i=0;i<5;i++)e===1?f.push({color:this._updateTint(u[r],s[i]),tint:s[i]}):e<.8?e===0?f.push({color:this._updateTint(u[r],Math.abs(s[o-i-1])),tint:Math.abs(s[o-i-1])}):e>.2?f.push({color:this._updateTint(u[r],c[i]),tint:c[i]}):f.push({color:this._updateTint(u[r],Math.abs(h[o-i-1])),tint:Math.abs(h[o-i-1])}):f.push({color:this._updateTint(u[r],h[i]),tint:h[i]});return f},u.prototype._updateTint=function(n,i){i=i/100;if(i===0)return n;var r=t._hLSColor(n,!1),f=parseInt((i>0?(240-r.luminosity)*i:r.luminosity*i).toString(),10),u=t._colorFromHLS(r.hue,r.luminosity+f,r.saturation);return"rgb("+u.r.toString()+", "+u.g.toString()+", "+u.b.toString()+")"},u.prototype.destroy=function(){this._removeEvent(),this.element.empty(),this.dialog&&this.dialog.destroy()},u.DefaultOptions={themeColors:[{name:"text 1",baseColor:"#FFFFFF"},{name:"background 1",baseColor:"#000000"},{name:"text 2",baseColor:"#E7E6E6"},{name:"background 2",baseColor:"#44546A"},{name:"accent 1",baseColor:"#5B9BD5"},{name:"accent 2",baseColor:"#ED7D31"},{name:"accent 3",baseColor:"#8064A2"},{name:"accent 4",baseColor:"#4BACC6"},{name:"accent 5",baseColor:"#F79646"},{name:"accent 6",baseColor:"#0000FF"}],themeColorsTitle:n.res.colorPicker.themeColorsTitle,standardColors:[{baseColor:"#C00000"},{baseColor:"#FF0000"},{baseColor:"#FFC000"},{baseColor:"#FFFF00"},{baseColor:"#92D050"},{baseColor:"#00B050"},{baseColor:"#00B0F0"},{baseColor:"#0070C0"},{baseColor:"#002060"},{baseColor:"#7030A0"}],standardColorsTitle:n.res.colorPicker.standardColorsTitle,showNoFill:!0,noFillText:n.res.colorPicker.noFillText,showMoreColors:!0,moreColorsText:n.res.colorPicker.moreColorsText,value:"",showThemeColorTitle:!0,showStandardColorTitle:!0,showOutline:!0},u}(gcui.gcuiWidget),r,t;n.ColorPicker=i,i.prototype.options=$.extend(!0,{},gcui.gcuiWidget.prototype.options,i.DefaultOptions),$.gcui.registerWidget(u,i.prototype),r=function(){function i(){this.value=""}return i.prototype.open=function(){this.innerDialog.dialog("open"),this.value===""?(this.innerDialog.find(".colordialog-div-currentcolor").css("background","rgb(0,0,0)"),this.innerDialog.find(".colordialog-div-newcolor").css("background","rgb(0,0,0)")):this.value===undefined?(this.innerDialog.find(".colordialog-div-currentcolor").css("background","rgb(255,255,255)"),this.innerDialog.find(".colordialog-div-newcolor").css("background","rgb(255,255,255)")):(this.innerDialog.find(".colordialog-div-currentcolor").css("background",this.value),this.innerDialog.find(".colordialog-div-newcolor").css("background",this.value))},i.prototype._create=function(){var t=this,i;this.hls={luminosity:128,saturation:0,hue:0},this.isDragingLum=!1,this.isDragingHueSat=!1,this.innerDialog=$("<div title='Color' class='colordialog-div-container'></div>"),this.innerDialog.dialog({title:n.res.colorPicker.colorDialogTitle,autoOpen:!1,resizable:!1,width:280,modal:!0,buttons:[{text:n.res.ok,click:function(n){$(this).dialog("close"),t.value="rgb("+t.innerDialog.find(".colordialog-input-red").val()+","+t.innerDialog.find(".colordialog-input-green").val()+","+t.innerDialog.find(".colordialog-input-blue").val()+")",t._raiseClose(event,!0)}},{text:n.res.cancel,click:function(n){$(this).dialog("close"),t._raiseClose(n,!1)}}],beforeClose:function(n,i){n.currentTarget&&t._raiseClose(n,!1)}}).append($("<table><tbody><tr><td><div class='colordialog-div-pickercolor-image'><span class='colordialog-span-pickercolor-mousepointer'></span></div></td><td><div class='colordialog-div-dragcolor-container'><div class='colordialog-div-dragcolor'></div><span class='colordialog-span-dragcolor-arrow'></span></div></td></tr><tr><td><table><tbody><tr><td class='red-input-label'>Red:</td><td><input class='colordialog-rgb colordialog-input-red'></input></td></tr><tr><td class='green-input-label'>Green:</td><td><input class='colordialog-rgb colordialog-input-green'></input></td></tr><tr><td class='blue-input-label'>Blue:</td><td><input class='colordialog-rgb colordialog-input-blue'></input></td></tr></tbody></table></td><td><table class='colordialog-table-newcurrentcolor'><tbody><tr><td class='new-label'>New</td></tr><tr><td><div class='colordialog-div-newcolor'></div></td></tr><tr><td><div class='colordialog-div-currentcolor'></div></td></tr><tr><td class='current-label'>Current</td></tr></tbody></table></td></tr></tbody></table>")),this.innerDialog.find(".colordialog-table-newcurrentcolor").attr("cellSpacing","0px").attr("cellPadding","0px"),this.innerDialog.find(".red-input-label").text(n.res.colorPicker.red),this.innerDialog.find(".green-input-label").text(n.res.colorPicker.green),this.innerDialog.find(".blue-input-label").text(n.res.colorPicker.blue),this.innerDialog.find(".new-label").text(n.res.colorPicker.newLabel),this.innerDialog.find(".current-label").text(n.res.colorPicker.currentLabel),this.innerDialog.find(".colordialog-rgb").spinner({max:255,min:0,change:function(){t._updateColorDraw()},spin:function(){t._updateColorDraw()}}),this.value!==""&&this.innerDialog.find(".colordialog-div-currentcolor").css("background",this.value),this.value===""?(i=this.innerDialog.find(".colordialog-div-dragcolor"),i.css("background-image","linear-gradient(to bottom, rgb(255,  255, 255), rgb(0, 0, 0))"),i.css("background-image","-o-linear-gradient(to bottom, rgb(255,  255, 255), rgb(0, 0, 0))"),i.css("background-image","-moz-linear-gradient(to bottom, rgb(255,  255, 255), rgb(0, 0, 0))"),i.css("background-image","-webkit-linear-gradient(to bottom, rgb(255,  255, 255), rgb(0, 0, 0))"),i.css("background-image","-ms-linear-gradient(to bottom, rgb(255,  255, 255), rgb(0, 0, 0))"),i.css("background-image","-webkit-gradient(linear, left top, left bottom, color-stop(0, rgb(255,  255, 255)),  color-stop(1, rgb(0, 0, 0)))"),this.innerDialog.find(".colordialog-input-red").spinner().spinner("value",0),this.innerDialog.find(".colordialog-input-green").spinner().spinner("value",0),this.innerDialog.find(".colordialog-input-blue").spinner().spinner("value",0)):this._updateColor(!0,this.value),this._addEvent()},i.prototype._updateColorDraw=function(){var n=this,e,o,r;if(n.isDragingLum)return;n.innerDialog.find(".colordialog-input-red").val()==""&&n.innerDialog.find(".colordialog-input-red").spinner().spinner("value",0),n.innerDialog.find(".colordialog-input-green").val()==""&&n.innerDialog.find(".colordialog-input-green").spinner().spinner("value",0),n.innerDialog.find(".colordialog-input-blue").val()==""&&n.innerDialog.find(".colordialog-input-blue").spinner().spinner("value",0);var u=parseInt(n.innerDialog.find(".colordialog-input-red").val()),f=parseInt(n.innerDialog.find(".colordialog-input-green").val()),i=parseInt(n.innerDialog.find(".colordialog-input-blue").val());u.toString()==="NaN"&&(u=0),f.toString()==="NaN"&&(f=0),i.toString()==="NaN"&&(i=0),e="rgb("+u.toString()+","+f.toString()+","+i.toString()+")",n._updateColor(!0,e),o={a:255,r:u,g:f,b:i},r=t._hLSColor(o,!0),n.hls.hue=Math.floor(r.hue/240*255),n.hls.luminosity=Math.floor(r.luminosity/240*255),n.hls.saturation=Math.floor(r.saturation/240*255),n.isDragingLum||n.isDragingHueSat||n.innerDialog.find(".colordialog-span-dragcolor-arrow").css("display","block").css("top",164-n.hls.luminosity/255*160),n.innerDialog.find(".colordialog-span-pickercolor-mousepointer").css("display","block").css("left",n.hls.hue/255*190-5).css("top",155-n.hls.saturation/255*160)},i.prototype._addEvent=function(){var n=this,r,i,t;this.innerDialog.find(".colordialog-div-pickercolor-image").mousedown(function(t){var o,e,i,r,u,s,f;n.isDragingHueSat=!0,o=t.target||t.srcElement,e=o,e.className.indexOf("colordialog-span-pickercolor-mousepointer")!==-1?(u=e,i=t.offsetX+parseInt(u.style.left),r=t.offsetY+parseInt(u.style.top)):(i=t.offsetX,r=t.offsetY),s=190,f=160,n.hls.saturation=(f-r)/f*255,n.hls.hue=i/s*255,n._updateColor(!1,undefined),n.innerDialog.find(".colordialog-span-pickercolor-mousepointer").css("display","block").css("left",i-5).css("top",r-5)}),$(document).mouseup(function(t){n.isDragingHueSat=!1,n.isDragingLum=!1}),this.innerDialog.find(".colordialog-div-pickercolor-image").mousemove(function(t){var o,e,i,r,u,s,f;n.isDragingHueSat&&(o=t.target||t.srcElement,e=o,e.className.indexOf("colordialog-span-pickercolor-mousepointer")!==-1?(u=e,i=t.offsetX+parseInt(u.style.left),r=t.offsetY+parseInt(u.style.top)):(i=t.offsetX,r=t.offsetY),s=190,f=160,n.hls.saturation=(f-r)/f*255,n.hls.hue=i/s*255,n._updateColor(!1,undefined),n.innerDialog.find(".colordialog-span-pickercolor-mousepointer").css("display","block").css("left",i-5).css("top",r-5))}),this.innerDialog.find(".colordialog-div-dragcolor-container").mousedown(function(u){var h,e,f,s,o;n.isDragingLum=!0,h=u.target||u.srcElement,e=h,e.className.indexOf("colordialog-span-dragcolor-arrow")!==-1?(s=e,f=u.offsetY+parseInt(s.style.top)-8):f=u.offsetY,f>160&&(f=160),f<0&&(f=0),n.innerDialog.find(".colordialog-span-dragcolor-arrow").css("display","block").css("top",f+4),o=160,n.hls.luminosity=(160-f)/o*255,n._updateColor(!1,undefined),r=f,i=u.clientY;$(document).on("mousemove",t)}),t=function(t){var u,f;n.isDragingLum&&(u=t.clientY-i+r,u>160&&(u=160),u<0&&(u=0),n.innerDialog.find(".colordialog-span-dragcolor-arrow").css("display","block").css("top",u+4),f=160,n.hls.luminosity=(160-u)/f*255,n._updateColor(!1,undefined))}},i.prototype._raiseClose=function(n,t){$(this).trigger("dialogClose",t)},i.prototype._updateColor=function(n,i){var r,u,o,h,e,f;if(i){var s=i.split(","),a=s[0].split("("),c=s[2].split(")"),l=a[1],y=s[1],v=c[0];r={a:255,r:parseInt(l),g:parseInt(y),b:parseInt(v)},n&&(o=t._hLSColor(r,!0),u=t._colorFromHLS(Math.floor(o.hue/255*240),Math.floor(128/255*240),Math.floor(o.saturation/255*240)))}else r=this.hls.luminosity===0?{a:255,r:0,g:0,b:0}:this.hls.luminosity===255?{a:255,r:255,g:255,b:255}:t._colorFromHLS(Math.floor(this.hls.hue/255*240),Math.floor(this.hls.luminosity/255*240),Math.floor(this.hls.saturation/255*240)),(n||this.hls.luminosity===0||this.hls.luminosity===255)&&(u=t._colorFromHLS(Math.floor(this.hls.hue/255*240),Math.floor(128/255*240),Math.floor(this.hls.saturation/255*240)));r.r=parseInt(r.r.toString(),10),r.g=parseInt(r.g.toString(),10),r.b=parseInt(r.b.toString(),10),this.innerDialog.find(".colordialog-input-red").spinner().spinner("value",r.r.toString()),this.innerDialog.find(".colordialog-input-green").spinner().spinner("value",r.g.toString()),this.innerDialog.find(".colordialog-input-blue").spinner().spinner("value",r.b.toString()),h="rgb("+r.r.toString()+", "+r.g.toString()+", "+r.b.toString()+")",this.innerDialog.find(".colordialog-div-newcolor").css("background",h),(n||this.hls.luminosity===0||this.hls.luminosity===255)&&(u.r=parseInt(u.r.toString(),10),u.g=parseInt(u.g.toString(),10),u.b=parseInt(u.b.toString(),10),e="rgb("+u.r.toString()+", "+u.g.toString()+", "+u.b.toString()+")",f=this.innerDialog.find(".colordialog-div-dragcolor"),f.css("background-image","linear-gradient(to bottom, rgb(255,  255, 255),"+e+", rgb(0, 0, 0))"),f.css("background-image","-o-linear-gradient(to bottom, rgb(255,  255, 255),"+e+", rgb(0, 0, 0))"),f.css("background-image","-moz-linear-gradient(to bottom, rgb(255,  255, 255),"+e+", rgb(0, 0, 0))"),f.css("background-image","-webkit-linear-gradient(to bottom, rgb(255,  255, 255),"+e+", rgb(0, 0, 0))"),f.css("background-image","-ms-linear-gradient(to bottom, rgb(255,  255, 255),"+e+", rgb(0, 0, 0))"),f.css("background-image","-webkit-gradient(linear, left top, left bottom, color-stop(0, rgb(255,  255, 255)), color-stop(0.5, "+e+"), color-stop(1, rgb(0, 0, 0)))"))},i.prototype.destroy=function(){this.innerDialog&&(this.innerDialog.dialog("destroy"),this.innerDialog.remove())},i}(),n.ColorDailog=r,t=function(){function n(){}return n._getColorBrightness=function(n){var t=this._hLSColor(n,!1);return t.luminosity/240},n._colorFromHLS=function(n,t,i){var e,o,f,u,r,s;return i===0?e=o=f=parseInt((t*255/240).toString(),10):(r=t>120?t+i-(t*i+120)/240:(t*(240+i)+120)/240,u=2*t-r,e=parseInt(((this._hueToRGB(u,r,n+80)*255+120)/240).toString(),10),o=parseInt(((this._hueToRGB(u,r,n)*255+120)/240).toString(),10),f=parseInt(((this._hueToRGB(u,r,n-80)*255+120)/240).toString(),10)),s={a:255,r:e,g:o,b:f}},n._hLSColor=function(n,t){var c,s,r,e,o,h,i,a;t?(e=n.r,o=n.g,h=n.b):(e=parseInt(n.substring(1,3),16),o=parseInt(n.substring(3,5),16),h=parseInt(n.substring(5,7),16));var u=Math.max(Math.max(e,o),h),y=Math.min(Math.min(e,o),h),f=u+y;c=parseInt(((f*240+255)/510).toString(),10),i=u-y;if(i===0)s=0,r=160;else{c>120?s=parseInt(((i*240+(510-f)/2)/(510-f)).toString(),10):(s=parseInt(((i*240+f/2)/f).toString(),10),s=parseInt(((i*240+f/2)/f).toString(),10));var p=((u-e)*40+i/2)/i,v=((u-o)*40+i/2)/i,l=((u-h)*40+i/2)/i;r=e===u?parseInt((l-v).toString(),10):o===u?parseInt((80+p-l).toString(),10):parseInt((160+v-p).toString(),10),r<0&&(r+=240),r>240&&(r-=240)}return a={luminosity:c,saturation:s,hue:r}},n._hueToRGB=function(n,t,i){return i<0&&(i+=240),i>240&&(i-=240),i<40?n+((t-n)*i+20)/40:i<120?t:i<160?n+((t-n)*(160-i)+20)/40:n},n}()})(n.designer||(n.designer={}));var t=n.designer})(n.Sheets||(n.Sheets={}));var t=n.Sheets})(GcSpread||(GcSpread={}))