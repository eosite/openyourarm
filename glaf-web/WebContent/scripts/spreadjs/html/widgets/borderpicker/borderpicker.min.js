var __extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype,n.prototype=new r},GcSpread;(function(n){(function(n){(function(t){var r="borderpicker",i=function(i){function r(){i.apply(this,arguments)}return __extends(r,i),r.prototype._create=function(){var t,r,n,i;this.element.addClass("gcui-borderpicker"),t=$("<div></div>"),r=$("<label></label>"),r.addClass("gcui-borderpicker-line-style-label").text(this.options.lineStyleTitle).appendTo(t),this.element.append(t),this._createLineStylePanel(this.element),n=$("<div></div>"),i=$("<label></label>"),i.addClass("gcui-borderpicker-line-color-label").text(this.options.borderColorTitle).appendTo(n),this.element.append(n),this._createColorPicker(this.element),this._addEvents()},r.prototype._setOption=function(n,t){if(n==="lineStyle")this.options.lineStyle=t,this._updateLineStyle();else if(n==="borderColor")this.options.borderColor=t,this._updateLineColor(),this._updateColorPicker();else if(n==="lineStyleTitle")this.options.lineStyleTitle=t,this.element.find(".gcui-borderpicker-line-style-label").text(t);else if(n==="borderColorTitle")this.options.lineStyleTitle=t,this.element.find(".gcui-borderpicker-line-color-label").text(t);else if(n=="colorOptions")this.options.colorOptions=t,this._reDrawColorPicker();else throw"This key doesn't exist.";},r.prototype._addEvents=function(){var t=this,i=this;this.element.find(".line-style").on("click.borderpicker",function(i){var r=i.target||i.srcElement,f=$(r).data("lineStyle"),u=n.LineStyle;t.options.lineStyle=u[f],t._setBorder($(r)),t._trigger("lineStyleChanged",i,t.options.lineStyle)})},r.prototype._createLineStylePanel=function(n){var u=$("<div class='line-style-out-div'></div>"),r=$("<div class='line-style-backcolor-div'></div>"),i=$("<div class='line-style line-style-empty' data-line-style='empty'>None</div>"),y=$("<div class='line-style line-style-dotted' data-line-style='dotted' ></div>"),v=$("<div class='line-style line-style-dashed' data-line-style='dashed' ></div>"),a=$("<div class='line-style line-style-dash-dot-dot' data-line-style='dashDotDot' ></div>"),b=$("<div class='line-style line-style-dash-dot' data-line-style='dashDot' ></div>"),w=$("<div class='line-style line-style-hair' data-line-style='hair' ></div>"),p=$("<div class='line-style line-style-thin' data-line-style='thin' ></div>"),l=$("<div class='line-style line-style-medium-dash-dot-dot' data-line-style='mediumDashDotDot' ></div>"),o=$("<div class='line-style line-style-slanted-dash-dot' data-line-style='slantedDashDot' ></div>"),e=$("<div class='line-style line-style-medium-dash-dot' data-line-style='mediumDashDot' ></div>"),f=$("<div class='line-style line-style-medium-dashed' data-line-style='mediumDashed' ></div>"),c=$("<div class='line-style line-style-medium' data-line-style='medium' ></div>"),h=$("<div class='line-style line-style-thick' data-line-style='thick' ></div>"),s=$("<div class='line-style line-style-double' data-line-style='double' ></div>");i.text(t.res.borderPicker.none),r.append(i).append(y).append(v).append(a).append(b).append(w).append(p).append(l).append(o).append(e).append(f).append(c).append(h).append(s),u.append(r),n.append(u)},r.prototype._createColorPicker=function(n){var i=this,t=$("<div></div>").addClass("gcui-borderpicker-color"),u=$("<span></span>").appendTo(t),f=$("<span></span>").addClass("gcui-borderpicker-color-preview").appendTo(u),r=$("<div></div>").addClass("gcui-borderpicker-color-popup").appendTo(t);this._colorPicker=$("<div></div>").addClass("gcui-borderpicker-color-picker").colorpicker({valueChanged:function(n,t){t.color===undefined?(i.options.borderColor=undefined,i._onChanged(n,undefined)):(i.options.borderColor=t,i._onChanged(n,t))},choosedColor:function(n,i){t.comboframe("close")},openColorDialog:function(n,i){t.comboframe("close")}}).appendTo(r),t.comboframe().click(function(){t.comboframe("open")}),this._colorPicker.colorpicker("option",this.options.colorOptions),n.append(t)},r.prototype._reDrawColorPicker=function(){this.element.find(".gcui-borderpicker-color").remove(),this._createColorPicker(this.element)},r.prototype._onChanged=function(n,t){this._updatePreview(),this._updateLineColor(),this._colorPicker.colorpicker("option","selectedItem",this.options.borderColor),this._trigger("colorChanged",n,t)},r.prototype._updatePreview=function(){this.options.borderColor?this.element.find(".gcui-borderpicker-color-preview").css("background-color",this.options.borderColor.color):this.element.find(".gcui-borderpicker-color-preview").css("background-color","black")},r.prototype._updateColorPicker=function(){this._updatePreview(),this._colorPicker.colorpicker("option","selectedItem",this.options.borderColor)},r.prototype._updateLineColor=function(){this.options.borderColor?this.element.find(".line-style-backcolor-div").css("background-color",this.options.borderColor.color):this.element.find(".line-style-backcolor-div").css("background-color","black")},r.prototype._updateLineStyle=function(){var t=this;this.element.find(".line-style").each(function(){var i=$(this).data("lineStyle");i==n.LineStyle[t.options.lineStyle]&&t._setBorder($(this))})},r.prototype._clearBorder=function(){this.element.find(".line-style").removeClass("line-style-selected")},r.prototype._setBorder=function(n){this._clearBorder(),n.addClass("line-style-selected")},r.DefaultOptions={lineStyle:1,borderColor:{name:"Text 1",baseColor:"#000000",tint:0,color:"rgb(0,0,0)"},lineStyleTitle:t.res.borderPicker.lineStyleTitle,borderColorTitle:t.res.borderPicker.borderColorTitle,colorOptions:{showNoFill:!1}},r}(gcui.gcuiWidget);t.BorderPicker=i,i.prototype.options=$.extend(!0,{},gcui.gcuiWidget.prototype.options,i.DefaultOptions),$.gcui.registerWidget(r,i.prototype)})(n.designer||(n.designer={}));var t=n.designer})(n.Sheets||(n.Sheets={}));var t=n.Sheets})(GcSpread||(GcSpread={}))