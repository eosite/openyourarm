!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.flkEnc=e():t.flkEnc=e()}(this,function(){return function(t){function e(n){if(i[n])return i[n].exports;var r=i[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var i={};return e.m=t,e.c=i,e.d=function(t,i,n){e.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=4)}([function(t,e,i){"use strict";function n(t,i,n){e[i]={},t.forEach(function(t){e[i][t]=n})}var r=["王","张","黄","周","徐","胡","高","林","马","于","程","傅","曾","叶","余","夏","钟","田","任","方","石","熊","白","毛","江","史","候","龙","万","段","雷","钱","汤","易","常","武","赖","文","查","赵","肖","孙","李","吴","郑","冯","陈","褚","卫","蒋","沈","韩","杨","朱","秦","尤","许","何","吕","施","桓","孔","曹","严","华","金","魏","陶","姜","戚","谢","邹","喻","柏","窦","苏","潘","葛","奚","范","彭","鲁","韦","昌","俞","袁","酆","鲍","唐","费","廉","岑","薛","贺","倪","滕","殷","罗","毕","郝","邬","卞","康","卜","顾","孟","穆","萧","尹","姚","邵","湛","汪","祁","禹","狄","贝","臧","伏","戴","宋","茅","庞","纪","舒","屈","祝","董","梁","杜","阮","闵","贾","娄","颜","郭","邱","骆","蔡","樊","凌","霍","虞","柯","昝","卢","柯","缪","宗","丁","贲","邓","郁","杭","洪","崔","龚","嵇","邢","滑","裴","陆","荣","荀","惠","甄","芮","羿","储","靳","汲","邴","糜","隗","侯","宓","蓬","郗","仲","栾","钭","历","戎","刘","詹","幸","韶","郜","黎","蓟","溥","蒲","邰","鄂","咸","卓","蔺","屠","乔","郁","胥","苍","莘","翟","谭","贡","劳","冉","郦","雍","璩","桑","桂","濮","扈","冀","浦","庄","晏","瞿","阎","慕","茹","习","宦","艾","容","慎","戈","廖","庾","衡","耿","弘","匡","阙","殳","沃","蔚","夔","隆","巩","聂","晁","敖","融","訾","辛","阚","毋","乜","鞠","丰","蒯","荆","竺","盍","单","欧"],s=["司马","上官","欧阳","夏侯","诸葛","闻人","东方","赫连","皇甫","尉迟","公羊","澹台","公冶","宗政","濮阳","淳于","单于","太叔","申屠","公孙","仲孙","轩辕","令狐","徐离","宇文","长孙","慕容","司徒","司空","万俟"],o=["阿","建","小","晓","文","志","国","玉","丽","永","海","春","金","明","新","德","秀","红","亚","伟","雪","俊","桂","爱","美","世","正","庆","学","家","立","淑","振","云","华","光","惠","兴","天","长","艳","慧","利","宏","佳","瑞","凤","荣","秋","继","嘉","卫","燕","思","维","少","福","忠","宝","子","成","月","洪","东","一","泽","林","大","素","旭","宇","智","锦","冬","玲","雅","伯","翠","传","启","剑","安","树","良","中","梦","广","昌","元","万","清","静","友","宗","兆","丹","克","彩","绍","喜","远","朝","敏","培","胜","祖","先","菊","士","向","有","连","军","健","巧","耀","莉","英","方","和","仁","孝","梅","汉","兰","松","水","江","益","开","景","运","贵","祥","青","芳","碧","婷","龙","鹏","自","顺","双","书","生","义","跃","银","佩","雨","保","贤","仲","鸿","浩","加","定","炳","飞","锡","柏","发","超","道","怀","进","其","富","平","全","阳","吉","茂","彦","诗","洁","润","承","治","焕","如","君","增","善","希","根","应","勇","宜","守","会","凯","育","湘","凌","本","敬","博","延","乐","三","二","四","五","六","七","八","九","十"],a=["华","平","明","英","军","林","萍","芳","玲","红","生","霞","梅","文","荣","珍","兰","娟","峰","琴","云","辉","东","龙","敏","伟","强","丽","春","杰","燕","民","君","波","国","芬","清","祥","斌","婷","飞","良","忠","新","凤","锋","成","勇","刚","玉","元","宇","海","兵","安","庆","涛","鹏","亮","青","阳","艳","松","江","莲","娜","兴","光","德","武","香","俊","秀","慧","雄","才","宏","群","琼","胜","超","彬","莉","中","山","富","花","宁","利","贵","福","发","义","蓉","喜","娥","昌","仁","志","全","宝","权","美","琳","建","金","贤","星","丹","根","和","珠","康","菊","琪","坤","泉","秋","静","佳","顺","源","珊","达","欣","如","莹","章","浩","勤","芹","容","友","芝","豪","洁","鑫","惠","洪","旺","虎","远","妮","森","妹","南","雯","奇","健","卿","虹","娇","媛","怡","铭","川","进","博","智","来","琦","学","聪","洋","乐","年","翔","然","栋","凯","颖","鸣","丰","瑞","奎","立","堂","威","雪","鸿","晶","桂","凡","娣","先","洲","毅","雅","月","旭","田","晖","方","恒","亚","泽","风","银","高","贞","九","薇"],h=["家","民","敏","伟","勇","军","斌","静","丽","涛","芳","杰","萍","强","俊","明","燕","磊","玲","华","平","鹏","健","波","红","丹","辉","超","艳","莉","刚","娟","峰","婷","亮","洁","颖","琳","英","慧","飞","霞","浩","凯","宇","毅","林","佳","云","莹","娜","晶","洋","文","鑫","欣","琴","宁","琼","兵","青","琦","翔","彬","锋","阳","璐","旭","蕾","剑","虹","蓉","建","倩","梅","宏","威","博","君","力","龙","晨","薇","雪","琪","欢","荣","江","炜","成","庆","冰","东","帆","雷","楠","锐","进","海","凡","巍","维","迪","媛","玮","杨","群","瑛","悦","春","瑶","婧","兰","茜","松","爽","立","瑜","睿","晖","聪","帅","瑾","骏","雯","晓","昊","勤","新","瑞","岩","星","忠","志","怡","坤","康","航","利","畅","坚","雄","智","萌","哲","岚","洪","捷","珊","恒","靖","清","扬","昕","乐","武","玉","诚","菲","锦","凤","珍","晔","妍","璇","胜","菁","科","芬","露","越","彤","曦","义","良","鸣","芸","方","月","铭","光","震","冬","源","政","虎","莎","彪","蓓","钢","凌","奇","卫","彦","烨","可","黎","川","淼","惠","祥","然","三","二","一","四","五","六","七","八","九","十"];n(r,"FAMILY_NAME_1",1),n(s,"FAMILY_NAME_2",2),n(o,"DOUBLE_NAME_1",1),n(a,"DOUBLE_NAME_2",2),n(h,"SINGLE_NAME",1)},function(t,e,i){(function(n){function r(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))}function s(t){var i=this.useColors;if(t[0]=(i?"%c":"")+this.namespace+(i?" %c":" ")+t[0]+(i?"%c ":" ")+"+"+e.humanize(this.diff),i){var n="color: "+this.color;t.splice(1,0,n,"color: inherit");var r=0,s=0;t[0].replace(/%[a-zA-Z%]/g,function(t){"%%"!==t&&(r++,"%c"===t&&(s=r))}),t.splice(s,0,n)}}function o(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function a(t){try{null==t?e.storage.removeItem("debug"):e.storage.debug=t}catch(t){}}function h(){var t;try{t=e.storage.debug}catch(t){}return!t&&void 0!==n&&"env"in n&&(t=n.env.DEBUG),t}e=t.exports=i(7),e.log=o,e.formatArgs=s,e.save=a,e.load=h,e.useColors=r,e.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(t){}}(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.formatters.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}},e.enable(h())}).call(e,i(6))},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(t){this.toString=function(){return"CORRUPT: "+this.message},this.message=t},invalid:function(t){this.toString=function(){return"INVALID: "+this.message},this.message=t},bug:function(t){this.toString=function(){return"BUG: "+this.message},this.message=t},notReady:function(t){this.toString=function(){return"NOT READY: "+this.message},this.message=t}}};void 0!==t&&t.exports&&(t.exports=r),r.cipher.aes=function(t){this._tables[0][0][0]||this._precompute();var e,i,n,s,o,a=this._tables[0][4],h=this._tables[1],c=t.length,u=1;if(4!==c&&6!==c&&8!==c)throw new r.exception.invalid("invalid aes key size");for(this._key=[s=t.slice(0),o=[]],e=c;e<4*c+28;e++)n=s[e-1],(e%c==0||8===c&&e%c==4)&&(n=a[n>>>24]<<24^a[n>>16&255]<<16^a[n>>8&255]<<8^a[255&n],e%c==0&&(n=n<<8^n>>>24^u<<24,u=u<<1^283*(u>>7))),s[e]=s[e-c]^n;for(i=0;e;i++,e--)n=s[3&i?e:e-4],o[i]=e<=4||i<4?n:h[0][a[n>>>24]]^h[1][a[n>>16&255]]^h[2][a[n>>8&255]]^h[3][a[255&n]]},r.cipher.aes.prototype={encrypt:function(t){return this._crypt(t,0)},decrypt:function(t){return this._crypt(t,1)},_tables:[[[],[],[],[],[]],[[],[],[],[],[]]],_precompute:function(){var t,e,i,n,r,s,o,a,h,c=this._tables[0],u=this._tables[1],l=c[4],f=u[4],p=[],g=[];for(t=0;t<256;t++)g[(p[t]=t<<1^283*(t>>7))^t]=t;for(e=i=0;!l[e];e^=n||1,i=g[i]||1)for(o=i^i<<1^i<<2^i<<3^i<<4,o=o>>8^255&o^99,l[e]=o,f[o]=e,s=p[r=p[n=p[e]]],h=16843009*s^65537*r^257*n^16843008*e,a=257*p[o]^16843008*o,t=0;t<4;t++)c[t][e]=a=a<<24^a>>>8,u[t][o]=h=h<<24^h>>>8;for(t=0;t<5;t++)c[t]=c[t].slice(0),u[t]=u[t].slice(0)},_crypt:function(t,e){if(4!==t.length)throw new r.exception.invalid("invalid aes block size");var i,n,s,o,a=this._key[e],h=t[0]^a[0],c=t[e?3:1]^a[1],u=t[2]^a[2],l=t[e?1:3]^a[3],f=a.length/4-2,p=4,g=[0,0,0,0],d=this._tables[e],m=d[0],y=d[1],v=d[2],F=d[3],b=d[4];for(o=0;o<f;o++)i=m[h>>>24]^y[c>>16&255]^v[u>>8&255]^F[255&l]^a[p],n=m[c>>>24]^y[u>>16&255]^v[l>>8&255]^F[255&h]^a[p+1],s=m[u>>>24]^y[l>>16&255]^v[h>>8&255]^F[255&c]^a[p+2],l=m[l>>>24]^y[h>>16&255]^v[c>>8&255]^F[255&u]^a[p+3],p+=4,h=i,c=n,u=s;for(o=0;o<4;o++)g[e?3&-o:o]=b[h>>>24]<<24^b[c>>16&255]<<16^b[u>>8&255]<<8^b[255&l]^a[p++],i=h,h=c,c=u,u=l,l=i;return g}},r.bitArray={bitSlice:function(t,e,i){return t=r.bitArray._shiftRight(t.slice(e/32),32-(31&e)).slice(1),void 0===i?t:r.bitArray.clamp(t,i-e)},extract:function(t,e,i){var n=Math.floor(-e-i&31);return(-32&(e+i-1^e)?t[e/32|0]<<32-n^t[e/32+1|0]>>>n:t[e/32|0]>>>n)&(1<<i)-1},concat:function(t,e){if(0===t.length||0===e.length)return t.concat(e);var i=t[t.length-1],n=r.bitArray.getPartial(i);return 32===n?t.concat(e):r.bitArray._shiftRight(e,n,0|i,t.slice(0,t.length-1))},bitLength:function(t){var e,i=t.length;return 0===i?0:(e=t[i-1],32*(i-1)+r.bitArray.getPartial(e))},clamp:function(t,e){if(32*t.length<e)return t;t=t.slice(0,Math.ceil(e/32));var i=t.length;return e&=31,i>0&&e&&(t[i-1]=r.bitArray.partial(e,t[i-1]&2147483648>>e-1,1)),t},partial:function(t,e,i){return 32===t?e:(i?0|e:e<<32-t)+1099511627776*t},getPartial:function(t){return Math.round(t/1099511627776)||32},equal:function(t,e){if(r.bitArray.bitLength(t)!==r.bitArray.bitLength(e))return!1;var i,n=0;for(i=0;i<t.length;i++)n|=t[i]^e[i];return 0===n},_shiftRight:function(t,e,i,n){var s,o,a=0;for(void 0===n&&(n=[]);e>=32;e-=32)n.push(i),i=0;if(0===e)return n.concat(t);for(s=0;s<t.length;s++)n.push(i|t[s]>>>e),i=t[s]<<32-e;return a=t.length?t[t.length-1]:0,o=r.bitArray.getPartial(a),n.push(r.bitArray.partial(e+o&31,e+o>32?i:n.pop(),1)),n},_xor4:function(t,e){return[t[0]^e[0],t[1]^e[1],t[2]^e[2],t[3]^e[3]]}},r.codec.utf8String={fromBits:function(t){var e,i,n="",s=r.bitArray.bitLength(t);for(e=0;e<s/8;e++)0==(3&e)&&(i=t[e/4]),n+=String.fromCharCode(i>>>24),i<<=8;return decodeURIComponent(escape(n))},toBits:function(t){t=unescape(encodeURIComponent(t));var e,i=[],n=0;for(e=0;e<t.length;e++)n=n<<8|t.charCodeAt(e),3==(3&e)&&(i.push(n),n=0);return 3&e&&i.push(r.bitArray.partial(8*(3&e),n)),i}},r.codec.hex={fromBits:function(t){var e,i="";for(e=0;e<t.length;e++)i+=(0xf00000000000+(0|t[e])).toString(16).substr(4);return i.substr(0,r.bitArray.bitLength(t)/4)},toBits:function(t){var e,i,n=[];for(t=t.replace(/\s|0x/g,""),i=t.length,t+="00000000",e=0;e<t.length;e+=8)n.push(0^parseInt(t.substr(e,8),16));return r.bitArray.clamp(n,4*i)}},r.codec.base64={_chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fromBits:function(t,e,i){var n,s="",o=0,a=r.codec.base64._chars,h=0,c=r.bitArray.bitLength(t);for(i&&(a=a.substr(0,62)+"-_"),n=0;6*s.length<c;)s+=a.charAt((h^t[n]>>>o)>>>26),o<6?(h=t[n]<<6-o,o+=26,n++):(h<<=6,o-=6);for(;3&s.length&&!e;)s+="=";return s},toBits:function(t,e){t=t.replace(/\s|=/g,"");var i,n,s=[],o=0,a=r.codec.base64._chars,h=0;for(e&&(a=a.substr(0,62)+"-_"),i=0;i<t.length;i++){if((n=a.indexOf(t.charAt(i)))<0)throw new r.exception.invalid("this isn't base64!");o>26?(o-=26,s.push(h^n>>>o),h=n<<32-o):(o+=6,h^=n<<32-o)}return 56&o&&s.push(r.bitArray.partial(56&o,h,1)),s}},r.codec.base64url={fromBits:function(t){return r.codec.base64.fromBits(t,1,1)},toBits:function(t){return r.codec.base64.toBits(t,1)}},r.hash.sha256=function(t){this._key[0]||this._precompute(),t?(this._h=t._h.slice(0),this._buffer=t._buffer.slice(0),this._length=t._length):this.reset()},r.hash.sha256.hash=function(t){return(new r.hash.sha256).update(t).finalize()},r.hash.sha256.prototype={blockSize:512,reset:function(){return this._h=this._init.slice(0),this._buffer=[],this._length=0,this},update:function(t){"string"==typeof t&&(t=r.codec.utf8String.toBits(t));var e,i=this._buffer=r.bitArray.concat(this._buffer,t),n=this._length,s=this._length=n+r.bitArray.bitLength(t);for(e=512+n&-512;e<=s;e+=512)this._block(i.splice(0,16));return this},finalize:function(){var t,e=this._buffer,i=this._h;for(e=r.bitArray.concat(e,[r.bitArray.partial(1,1)]),t=e.length+2;15&t;t++)e.push(0);for(e.push(Math.floor(this._length/4294967296)),e.push(0|this._length);e.length;)this._block(e.splice(0,16));return this.reset(),i},_init:[],_key:[],_precompute:function(){function t(t){return 4294967296*(t-Math.floor(t))|0}var e,i=0,n=2;t:for(;i<64;n++){for(e=2;e*e<=n;e++)if(n%e==0)continue t;i<8&&(this._init[i]=t(Math.pow(n,.5))),this._key[i]=t(Math.pow(n,1/3)),i++}},_block:function(t){var e,i,n,r,s=t.slice(0),o=this._h,a=this._key,h=o[0],c=o[1],u=o[2],l=o[3],f=o[4],p=o[5],g=o[6],d=o[7];for(e=0;e<64;e++)e<16?i=s[e]:(n=s[e+1&15],r=s[e+14&15],i=s[15&e]=(n>>>7^n>>>18^n>>>3^n<<25^n<<14)+(r>>>17^r>>>19^r>>>10^r<<15^r<<13)+s[15&e]+s[e+9&15]|0),i=i+d+(f>>>6^f>>>11^f>>>25^f<<26^f<<21^f<<7)+(g^f&(p^g))+a[e],d=g,g=p,p=f,f=l+i|0,l=u,u=c,c=h,h=i+(c&u^l&(c^u))+(c>>>2^c>>>13^c>>>22^c<<30^c<<19^c<<10)|0;o[0]=o[0]+h|0,o[1]=o[1]+c|0,o[2]=o[2]+u|0,o[3]=o[3]+l|0,o[4]=o[4]+f|0,o[5]=o[5]+p|0,o[6]=o[6]+g|0,o[7]=o[7]+d|0}},r.mode.cbc={name:"cbc",encrypt:function(t,e,i){var n=r.codec.utf8String.toBits(t),s=new r.cipher.aes(n),o=r.codec.utf8String.toBits(e),a=r.codec.utf8String.toBits(i);if(128!==r.bitArray.bitLength(a))throw new r.exception.invalid("cbc iv must be 128 bits");var h,c=r.bitArray,u=c._xor4,l=c.bitLength(o),f=0,p=[];if(7&l)throw new r.exception.invalid("pkcs#5 padding only works for multiples of a byte");for(h=0;f+128<=l;h+=4,f+=128)a=s.encrypt(u(a,o.slice(h,h+4))),p.splice(h,0,a[0],a[1],a[2],a[3]);return l=16843009*(16-(l>>3&15)),a=s.encrypt(u(a,c.concat(o,[l,l,l,l]).slice(h,h+4))),p.splice(h,0,a[0],a[1],a[2],a[3]),r.codec.base64.fromBits(p)},decrypt:function(t,e,i){var n=r.codec.utf8String.toBits(t),s=new r.cipher.aes(n),o=r.codec.base64.toBits(e),a=r.codec.utf8String.toBits(i);if(128!==r.bitArray.bitLength(a))throw new r.exception.invalid("cbc iv must be 128 bits");if(127&r.bitArray.bitLength(o)||!o.length)throw new r.exception.corrupt("cbc ciphertext must be a positive multiple of the block size");var h,c,u,l=r.bitArray,f=l._xor4,p=[];for(h=0;h<o.length;h+=4)c=o.slice(h,h+4),u=f(a,s.decrypt(c)),p.splice(h,0,u[0],u[1],u[2],u[3]),a=c;if(0===(c=255&p[h-1])||c>16)throw new r.exception.corrupt("pkcs#5 padding corrupt");if(u=16843009*c,!l.equal(l.bitSlice([u,u,u,u],0,8*c),l.bitSlice(p,32*p.length-8*c,32*p.length)))throw new r.exception.corrupt("pkcs#5 padding corrupt");return r.codec.utf8String.fromBits(l.bitSlice(p,0,32*p.length-8*c))}},r.mode.ccm={name:"ccm",encrypt:function(t,e,i,n,s){var o,a,h=e.slice(0),c=r.bitArray,u=c.bitLength(i)/8,l=c.bitLength(h)/8;if(s=s||64,n=n||[],u<7)throw new r.exception.invalid("ccm: iv must be at least 7 bytes");for(o=2;o<4&&l>>>8*o;o++);return o<15-u&&(o=15-u),i=c.clamp(i,8*(15-o)),a=r.mode.ccm._computeTag(t,e,i,n,s,o),h=r.mode.ccm._ctrMode(t,h,i,a,s,o),c.concat(h.data,h.tag)},decrypt:function(t,e,i,n,s){s=s||64,n=n||[];var o,a,h=r.bitArray,c=h.bitLength(i)/8,u=h.bitLength(e),l=h.clamp(e,u-s),f=h.bitSlice(e,u-s);if(u=(u-s)/8,c<7)throw new r.exception.invalid("ccm: iv must be at least 7 bytes");for(o=2;o<4&&u>>>8*o;o++);if(o<15-c&&(o=15-c),i=h.clamp(i,8*(15-o)),l=r.mode.ccm._ctrMode(t,l,i,f,s,o),a=r.mode.ccm._computeTag(t,l.data,i,n,s,o),!h.equal(l.tag,a))throw new r.exception.corrupt("ccm: tag doesn't match");return l.data},_computeTag:function(t,e,i,n,s,o){var a,h,c,u=[],l=r.bitArray,f=l._xor4;if((s/=8)%2||s<4||s>16)throw new r.exception.invalid("ccm: invalid tag length");if(n.length>4294967295||e.length>4294967295)throw new r.exception.bug("ccm: can't deal with 4GiB or more data");if(a=[l.partial(8,(n.length?64:0)|s-2<<2|o-1)],a=l.concat(a,i),a[3]|=l.bitLength(e)/8,a=t.encrypt(a),n.length)for(h=l.bitLength(n)/8,h<=65279?u=[l.partial(16,h)]:h<=4294967295&&(u=l.concat([l.partial(16,65534)],[h])),u=l.concat(u,n),c=0;c<u.length;c+=4)a=t.encrypt(f(a,u.slice(c,c+4).concat([0,0,0])));for(c=0;c<e.length;c+=4)a=t.encrypt(f(a,e.slice(c,c+4).concat([0,0,0])));return l.clamp(a,8*s)},_ctrMode:function(t,e,i,n,s,o){var a,h,c,u=r.bitArray,l=u._xor4,f=e.length,p=u.bitLength(e);if(c=u.concat([u.partial(8,o-1)],i).concat([0,0,0]).slice(0,4),n=u.bitSlice(l(n,t.encrypt(c)),0,s),!f)return{tag:n,data:[]};for(h=0;h<f;h+=4)c[3]++,a=t.encrypt(c),e[h]^=a[0],e[h+1]^=a[1],e[h+2]^=a[2],e[h+3]^=a[3];return{tag:n,data:u.clamp(e,p)}}},r.mode.ocb2={name:"ocb2",encrypt:function(t,e,i,n,s,o){if(128!==r.bitArray.bitLength(i))throw new r.exception.invalid("ocb iv must be 128 bits");var a,h,c,u,l=r.mode.ocb2._times2,f=r.bitArray,p=f._xor4,g=[0,0,0,0],d=l(t.encrypt(i)),m=[];for(n=n||[],s=s||64,a=0;a+4<e.length;a+=4)h=e.slice(a,a+4),g=p(g,h),m=m.concat(p(d,t.encrypt(p(d,h)))),d=l(d);return h=e.slice(a),c=f.bitLength(h),u=t.encrypt(p(d,[0,0,0,c])),h=f.clamp(p(h.concat([0,0,0]),u),c),g=p(g,p(h.concat([0,0,0]),u)),g=t.encrypt(p(g,p(d,l(d)))),n.length&&(g=p(g,o?n:r.mode.ocb2.pmac(t,n))),m.concat(f.concat(h,f.clamp(g,s)))},decrypt:function(t,e,i,n,s,o){if(128!==r.bitArray.bitLength(i))throw new r.exception.invalid("ocb iv must be 128 bits");s=s||64;var a,h,c,u,l=r.mode.ocb2._times2,f=r.bitArray,p=f._xor4,g=[0,0,0,0],d=l(t.encrypt(i)),m=r.bitArray.bitLength(e)-s,y=[];for(n=n||[],a=0;a+4<m/32;a+=4)h=p(d,t.decrypt(p(d,e.slice(a,a+4)))),g=p(g,h),y=y.concat(h),d=l(d);if(c=m-32*a,u=t.encrypt(p(d,[0,0,0,c])),h=p(u,f.clamp(e.slice(a),c).concat([0,0,0])),g=p(g,h),g=t.encrypt(p(g,p(d,l(d)))),n.length&&(g=p(g,o?n:r.mode.ocb2.pmac(t,n))),!f.equal(f.clamp(g,s),f.bitSlice(e,m)))throw new r.exception.corrupt("ocb: tag doesn't match");return y.concat(f.clamp(h,c))},pmac:function(t,e){var i,n,s=r.mode.ocb2._times2,o=r.bitArray,a=o._xor4,h=[0,0,0,0],c=t.encrypt([0,0,0,0]);for(c=a(c,s(s(c))),i=0;i+4<e.length;i+=4)c=s(c),h=a(h,t.encrypt(a(c,e.slice(i,i+4))));return n=e.slice(i),o.bitLength(n)<128&&(c=a(c,s(c)),n=o.concat(n,[-2147483648,0,0,0])),h=a(h,n),t.encrypt(a(s(a(c,s(c))),h))},_times2:function(t){return[t[0]<<1^t[1]>>>31,t[1]<<1^t[2]>>>31,t[2]<<1^t[3]>>>31,t[3]<<1^135*(t[0]>>>31)]}},r.misc.hmac=function(t,e){this._hash=e=e||r.hash.sha256;var i,n=[[],[]],s=e.prototype.blockSize/32;for(this._baseHash=[new e,new e],t.length>s&&(t=e.hash(t)),i=0;i<s;i++)n[0][i]=909522486^t[i],n[1][i]=1549556828^t[i];this._baseHash[0].update(n[0]),this._baseHash[1].update(n[1])},r.misc.hmac.prototype.encrypt=r.misc.hmac.prototype.mac=function(t,e){var i=new this._hash(this._baseHash[0]).update(t,e).finalize();return new this._hash(this._baseHash[1]).update(i).finalize()},r.misc.pbkdf2=function(t,e,i,n,s){if(i=i||1e3,n<0||i<0)throw r.exception.invalid("invalid params to pbkdf2");"string"==typeof t&&(t=r.codec.utf8String.toBits(t)),s=s||r.misc.hmac;var o,a,h,c,u,l=new s(t),f=[],p=r.bitArray;for(u=1;32*f.length<(n||1);u++){for(o=a=l.encrypt(p.concat(e,[u])),h=1;h<i;h++)for(a=l.encrypt(a),c=0;c<a.length;c++)o[c]^=a[c];f=f.concat(o)}return n&&(f=p.clamp(f,n)),f},r.random={randomWords:function(t,e){var i,n,s=[],o=this.isReady(e);if(0===o)throw new r.exception.notReady("generator isn't seeded");for(2&o&&this._reseedFromPools(!(1&o)),i=0;i<t;i+=4)(i+1)%65536==0&&this._gate(),n=this._gen4words(),s.push(n[0],n[1],n[2],n[3]);return this._gate(),s.slice(0,t)},setDefaultParanoia:function(t){this._defaultParanoia=t},addEntropy:function(t,e,i){i=i||"user";var s,o,a,h=0,c=(new Date).valueOf(),u=this._robins[i],l=this.isReady();switch(s=this._collectorIds[i],void 0===s&&(s=this._collectorIds[i]=this._collectorIdNext++),void 0===u&&(u=this._robins[i]=0),this._robins[i]=(this._robins[i]+1)%this._pools.length,void 0===t?"undefined":n(t)){case"number":t=[t],h=1;break;case"object":if(void 0===e)for(e=0,o=0;o<t.length;o++)for(a=t[o];a>0;)e++,a>>>=1;this._pools[u].update([s,this._eventId++,h||2,e,c,t.length].concat(t));break;case"string":void 0===e&&(e=t.length),this._pools[u].update([s,this._eventId++,3,e,c,t.length]),this._pools[u].update(t);break;default:throw new r.exception.bug("random: addEntropy only supports number, array or string")}this._poolEntropy[u]+=e,this._poolStrength+=e,0===l&&(0!==this.isReady()&&this._fireEvent("seeded",Math.max(this._strength,this._poolStrength)),this._fireEvent("progress",this.getProgress()))},isReady:function(t){var e=this._PARANOIA_LEVELS[void 0!==t?t:this._defaultParanoia];return this._strength&&this._strength>=e?this._poolEntropy[0]>80&&(new Date).valueOf()>this._nextReseed?3:1:this._poolStrength>=e?2:0},getProgress:function(t){var e=this._PARANOIA_LEVELS[t||this._defaultParanoia];return this._strength>=e?1:this._poolStrength>e?1:this._poolStrength/e},startCollectors:function(){if(!this._collectorsStarted){if(window.addEventListener)window.addEventListener("load",this._loadTimeCollector,!1),window.addEventListener("mousemove",this._mouseCollector,!1);else{if(!document.attachEvent)throw new r.exception.bug("can't attach event");document.attachEvent("onload",this._loadTimeCollector),document.attachEvent("onmousemove",this._mouseCollector)}this._collectorsStarted=!0}},stopCollectors:function(){this._collectorsStarted&&(window.removeEventListener?(window.removeEventListener("load",this._loadTimeCollector,!1),window.removeEventListener("mousemove",this._mouseCollector,!1)):window.detachEvent&&(window.detachEvent("onload",this._loadTimeCollector),window.detachEvent("onmousemove",this._mouseCollector)),this._collectorsStarted=!1)},addEventListener:function(t,e){this._callbacks[t][this._callbackI++]=e},removeEventListener:function(t,e){var i,n,r=this._callbacks[t],s=[];for(n in r)r.hasOwnProperty(n)&&r[n]===e&&s.push(n);for(i=0;i<s.length;i++)n=s[i],delete r[n]},_pools:[new r.hash.sha256],_poolEntropy:[0],_reseedCount:0,_robins:{},_eventId:0,_collectorIds:{},_collectorIdNext:0,_strength:0,_poolStrength:0,_nextReseed:0,_key:[0,0,0,0,0,0,0,0],_counter:[0,0,0,0],_cipher:void 0,_defaultParanoia:6,_collectorsStarted:!1,_callbacks:{progress:{},seeded:{}},_callbackI:0,_PARANOIA_LEVELS:[0,48,64,96,128,192,256,384,512,768,1024],_gen4words:function(){for(var t=0;t<4&&(this._counter[t]=this._counter[t]+1|0,!this._counter[t]);t++);return this._cipher.encrypt(this._counter)},_gate:function(){this._key=this._gen4words().concat(this._gen4words()),this._cipher=new r.cipher.aes(this._key)},_reseed:function(t){this._key=r.hash.sha256.hash(this._key.concat(t)),this._cipher=new r.cipher.aes(this._key);for(var e=0;e<4&&(this._counter[e]=this._counter[e]+1|0,!this._counter[e]);e++);},_reseedFromPools:function(t){var e,i=[],n=0;for(this._nextReseed=i[0]=(new Date).valueOf()+3e4,e=0;e<16;e++)i.push(4294967296*Math.random()|0);for(e=0;e<this._pools.length&&(i=i.concat(this._pools[e].finalize()),n+=this._poolEntropy[e],this._poolEntropy[e]=0,t||!(this._reseedCount&1<<e));e++);this._reseedCount>=1<<this._pools.length&&(this._pools.push(new r.hash.sha256),this._poolEntropy.push(0)),this._poolStrength-=n,n>this._strength&&(this._strength=n),this._reseedCount++,this._reseed(i)},_mouseCollector:function(t){var e=t.x||t.clientX||t.offsetX,i=t.y||t.clientY||t.offsetY;r.random.addEntropy([e,i],2,"mouse")},_loadTimeCollector:function(t){var e=new Date;r.random.addEntropy(e,2,"loadtime")},_fireEvent:function(t,e){var i,n=r.random._callbacks[t],s=[];for(i in n)n.hasOwnProperty(i)&&s.push(n[i]);for(i=0;i<s.length;i++)s[i](e)}},function(){if("undefined"!=typeof crypto&&crypto&&crypto.getRandomValues){var t=new Uint32Array(32);crypto.getRandomValues(t),r.random.addEntropy(t,1024,"crypto.getRandomValues")}}(),r.json={defaults:{v:1,iter:1e3,ks:128,ts:64,mode:"ccm",adata:"",cipher:"aes"},encrypt:function(t,e,i,n){i=i||{},n=n||{};var s,o,a,h=r.json,c=h._add({iv:r.random.randomWords(4,0)},h.defaults);if(h._add(c,i),a=c.adata,"string"==typeof c.salt&&(c.salt=r.codec.base64.toBits(c.salt)),"string"==typeof c.iv&&(c.iv=r.codec.base64.toBits(c.iv)),!r.mode[c.mode]||!r.cipher[c.cipher]||"string"==typeof t&&c.iter<=100||64!==c.ts&&96!==c.ts&&128!==c.ts||128!==c.ks&&192!==c.ks&&256!==c.ks||c.iv.length<2||c.iv.length>4)throw new r.exception.invalid("json encrypt: invalid parameters");return"string"==typeof t?(s=r.misc.cachedPbkdf2(t,c),t=s.key.slice(0,c.ks/32),c.salt=s.salt):r.ecc&&t instanceof r.ecc.elGamal.publicKey&&(s=t.kem(),c.kemtag=s.tag,t=s.key.slice(0,c.ks/32)),"string"==typeof e&&(e=r.codec.utf8String.toBits(e)),"string"==typeof a&&(a=r.codec.utf8String.toBits(a)),o=new r.cipher[c.cipher](t),h._add(n,c),n.key=t,c.ct=r.mode[c.mode].encrypt(o,e,c.iv,a,c.ts),h.encode(c)},decrypt:function(t,e,i,n){i=i||{},n=n||{};var s,o,a,h=r.json,c=h._add(h._add(h._add({},h.defaults),h.decode(e)),i,!0),u=c.adata;if("string"==typeof c.salt&&(c.salt=r.codec.base64.toBits(c.salt)),"string"==typeof c.iv&&(c.iv=r.codec.base64.toBits(c.iv)),!r.mode[c.mode]||!r.cipher[c.cipher]||"string"==typeof t&&c.iter<=100||64!==c.ts&&96!==c.ts&&128!==c.ts||128!==c.ks&&192!==c.ks&&256!==c.ks||!c.iv||c.iv.length<2||c.iv.length>4)throw new r.exception.invalid("json decrypt: invalid parameters");return"string"==typeof t?(o=r.misc.cachedPbkdf2(t,c),t=o.key.slice(0,c.ks/32),c.salt=o.salt):r.ecc&&t instanceof r.ecc.elGamal.secretKey&&(t=t.unkem(r.codec.base64.toBits(c.kemtag)).slice(0,c.ks/32)),"string"==typeof u&&(u=r.codec.utf8String.toBits(u)),a=new r.cipher[c.cipher](t),s=r.mode[c.mode].decrypt(a,c.ct,c.iv,u,c.ts),h._add(n,c),n.key=t,r.codec.utf8String.fromBits(s)},encode:function(t){var e,i="{",s="";for(e in t)if(t.hasOwnProperty(e)){if(!e.match(/^[a-z0-9]+$/i))throw new r.exception.invalid("json encode: invalid property name");switch(i+=s+'"'+e+'":',s=",",n(t[e])){case"number":case"boolean":i+=t[e];break;case"string":i+='"'+escape(t[e])+'"';break;case"object":i+='"'+r.codec.base64.fromBits(t[e],1)+'"';break;default:throw new r.exception.bug("json encode: unsupported type")}}return i+"}"},decode:function(t){if(t=t.replace(/\s/g,""),!t.match(/^\{.*\}$/))throw new r.exception.invalid("json decode: this isn't json!");var e,i,n=t.replace(/^\{|\}$/g,"").split(/,/),s={};for(e=0;e<n.length;e++){if(!(i=n[e].match(/^(?:(["']?)([a-z][a-z0-9]*)\1):(?:(\d+)|"([a-z0-9+\/%*_.@=\-]*)")$/i)))throw new r.exception.invalid("json decode: this isn't json!");i[3]?s[i[2]]=parseInt(i[3],10):s[i[2]]=i[2].match(/^(ct|salt|iv)$/)?r.codec.base64.toBits(i[4]):unescape(i[4])}return s},_add:function(t,e,i){if(void 0===t&&(t={}),void 0===e)return t;var n;for(n in e)if(e.hasOwnProperty(n)){if(i&&void 0!==t[n]&&t[n]!==e[n])throw new r.exception.invalid("required parameter overridden");t[n]=e[n]}return t},_subtract:function(t,e){var i,n={};for(i in t)t.hasOwnProperty(i)&&t[i]!==e[i]&&(n[i]=t[i]);return n},_filter:function(t,e){var i,n={};for(i=0;i<e.length;i++)void 0!==t[e[i]]&&(n[e[i]]=t[e[i]]);return n}},r.encrypt=r.json.encrypt,r.decrypt=r.json.decrypt,r.misc._pbkdf2Cache={},r.misc.cachedPbkdf2=function(t,e){var i,n,s,o,a=r.misc._pbkdf2Cache;return e=e||{},o=e.iter||1e3,n=a[t]=a[t]||{},i=n[o]=n[o]||{firstSalt:e.salt&&e.salt.length?e.salt.slice(0):r.random.randomWords(2,0)},s=void 0===e.salt?i.firstSalt:e.salt,i[s]=i[s]||r.misc.pbkdf2(t,s,e.iter),{key:i[s].slice(0),salt:s.slice(0)}},r.bn=function(t){this.initWith(t)},r.bn.prototype={radix:24,maxMul:8,_class:r.bn,copy:function(){return new this._class(this)},initWith:function(t){var e,i=0;switch(void 0===t?"undefined":n(t)){case"object":this.limbs=t.limbs.slice(0);break;case"number":this.limbs=[t],this.normalize();break;case"string":for(t=t.replace(/^0x/,""),this.limbs=[],e=this.radix/4,i=0;i<t.length;i+=e)this.limbs.push(parseInt(t.substring(Math.max(t.length-i-e,0),t.length-i),16));break;default:this.limbs=[0]}return this},equals:function(t){"number"==typeof t&&(t=new this._class(t));var e,i=0;for(this.fullReduce(),t.fullReduce(),e=0;e<this.limbs.length||e<t.limbs.length;e++)i|=this.getLimb(e)^t.getLimb(e);return 0===i},getLimb:function(t){return t>=this.limbs.length?0:this.limbs[t]},greaterEquals:function(t){"number"==typeof t&&(t=new this._class(t));var e,i,n,r=0,s=0;for(e=Math.max(this.limbs.length,t.limbs.length)-1;e>=0;e--)i=this.getLimb(e),n=t.getLimb(e),s|=n-i&~r,r|=i-n&~s;return(s|~r)>>>31},toString:function(){this.fullReduce();var t,e,i="",n=this.limbs;for(t=0;t<this.limbs.length;t++){for(e=n[t].toString(16);t<this.limbs.length-1&&e.length<6;)e="0"+e;i=e+i}return"0x"+i},addM:function(t){"object"!==(void 0===t?"undefined":n(t))&&(t=new this._class(t));var e,i=this.limbs,r=t.limbs;for(e=i.length;e<r.length;e++)i[e]=0;for(e=0;e<r.length;e++)i[e]+=r[e];return this},doubleM:function(){var t,e,i=0,n=this.radix,r=this.radixMask,s=this.limbs;for(t=0;t<s.length;t++)e=s[t],e=e+e+i,s[t]=e&r,i=e>>n;return i&&s.push(i),this},halveM:function(){var t,e,i=0,n=this.radix,r=this.limbs;for(t=r.length-1;t>=0;t--)e=r[t],r[t]=e+i>>1,i=(1&e)<<n;return r[r.length-1]||r.pop(),this},subM:function(t){"object"!==(void 0===t?"undefined":n(t))&&(t=new this._class(t));var e,i=this.limbs,r=t.limbs;for(e=i.length;e<r.length;e++)i[e]=0;for(e=0;e<r.length;e++)i[e]-=r[e];return this},mod:function(t){t=new r.bn(t).normalize();for(var e=new r.bn(this).normalize(),i=0;e.greaterEquals(t);i++)t.doubleM();for(;i>0;i--)t.halveM(),e.greaterEquals(t)&&e.subM(t).normalize();return e.trim()},inverseMod:function(t){var e,i,n=new r.bn(1),s=new r.bn(0),o=new r.bn(this),a=new r.bn(t),h=1;if(!(1&t.limbs[0]))throw new r.exception.invalid("inverseMod: p must be odd");do{for(1&o.limbs[0]&&(o.greaterEquals(a)||(e=o,o=a,a=e,e=n,n=s,s=e),o.subM(a),o.normalize(),n.greaterEquals(s)||n.addM(t),n.subM(s)),o.halveM(),1&n.limbs[0]&&n.addM(t),n.normalize(),n.halveM(),i=h=0;i<o.limbs.length;i++)h|=o.limbs[i]}while(h);if(!a.equals(1))throw new r.exception.invalid("inverseMod: p and x must be relatively prime");return s},add:function(t){return this.copy().addM(t)},sub:function(t){return this.copy().subM(t)},mul:function(t){"number"==typeof t&&(t=new this._class(t));var e,i,n,r=this.limbs,s=t.limbs,o=r.length,a=s.length,h=new this._class,c=h.limbs,u=this.maxMul;for(e=0;e<this.limbs.length+t.limbs.length+1;e++)c[e]=0;for(e=0;e<o;e++){for(n=r[e],i=0;i<a;i++)c[e+i]+=n*s[i];--u||(u=this.maxMul,h.cnormalize())}return h.cnormalize().reduce()},square:function(){return this.mul(this)},power:function(t){"number"==typeof t?t=[t]:void 0!==t.limbs&&(t=t.normalize().limbs);var e,i,n=new this._class(1),r=this;for(e=0;e<t.length;e++)for(i=0;i<this.radix;i++)t[e]&1<<i&&(n=n.mul(r)),r=r.square();return n},mulmod:function(t,e){return this.mod(e).mul(t.mod(e)).mod(e)},powermod:function(t,e){for(var i=new r.bn(1),n=new r.bn(this),s=new r.bn(t);;){if(1&s.limbs[0]&&(i=i.mulmod(n,e)),s.halveM(),s.equals(0))break;n=n.mulmod(n,e)}return i.normalize().reduce()},trim:function(){var t,e=this.limbs;do{t=e.pop()}while(e.length&&0===t);return e.push(t),this},reduce:function(){return this},fullReduce:function(){return this.normalize()},normalize:function(){var t,e,i,n=0,r=(this.placeVal,this.ipv),s=this.limbs,o=s.length,a=this.radixMask;for(t=0;t<o||0!==n&&-1!==n;t++)e=(s[t]||0)+n,i=s[t]=e&a,n=(e-i)*r;return-1===n&&(s[t-1]-=this.placeVal),this},cnormalize:function(){var t,e,i,n=0,r=this.ipv,s=this.limbs,o=s.length,a=this.radixMask;for(t=0;t<o-1;t++)e=s[t]+n,i=s[t]=e&a,n=(e-i)*r;return s[t]+=n,this},toBits:function(t){this.fullReduce(),t=t||this.exponent||this.limbs.length*this.radix;var e=Math.floor((t-1)/24),i=r.bitArray,n=(t+7&-8)%this.radix||this.radix,s=[i.partial(n,this.getLimb(e))];for(e--;e>=0;e--)s=i.concat(s,[i.partial(this.radix,this.getLimb(e))]);return s},bitLength:function(){this.fullReduce();for(var t=this.radix*(this.limbs.length-1),e=this.limbs[this.limbs.length-1];e;e>>=1)t++;return t+7&-8}},r.bn.fromBits=function(t){var e=this,i=new e,n=[],s=r.bitArray,o=this.prototype,a=Math.min(this.bitLength||4294967296,s.bitLength(t)),h=a%o.radix||o.radix;for(n[0]=s.extract(t,0,h);h<a;h+=o.radix)n.unshift(s.extract(t,h,o.radix));return i.limbs=n,i},r.bn.prototype.ipv=1/(r.bn.prototype.placeVal=Math.pow(2,r.bn.prototype.radix)),r.bn.prototype.radixMask=(1<<r.bn.prototype.radix)-1,r.bn.pseudoMersennePrime=function(t,e){function i(t){this.initWith(t)}var n,s,o,a=i.prototype=new r.bn;for(o=a.modOffset=Math.ceil(s=t/a.radix),a.exponent=t,a.offset=[],a.factor=[],a.minOffset=o,a.fullMask=0,a.fullOffset=[],a.fullFactor=[],a.modulus=i.modulus=new r.bn(Math.pow(2,t)),a.fullMask=0|-Math.pow(2,t%a.radix),n=0;n<e.length;n++)a.offset[n]=Math.floor(e[n][0]/a.radix-s),a.fullOffset[n]=Math.ceil(e[n][0]/a.radix-s),a.factor[n]=e[n][1]*Math.pow(.5,t-e[n][0]+a.offset[n]*a.radix),a.fullFactor[n]=e[n][1]*Math.pow(.5,t-e[n][0]+a.fullOffset[n]*a.radix),a.modulus.addM(new r.bn(Math.pow(2,e[n][0])*e[n][1])),a.minOffset=Math.min(a.minOffset,-a.offset[n]);return a._class=i,a.modulus.cnormalize(),a.reduce=function(){var t,e,i,n,r=this.modOffset,s=this.limbs,o=this.offset,a=this.offset.length,h=this.factor;for(t=this.minOffset;s.length>r;){for(i=s.pop(),n=s.length,e=0;e<a;e++)s[n+o[e]]-=h[e]*i;t--,t||(s.push(0),this.cnormalize(),t=this.minOffset)}return this.cnormalize(),this},a._strongReduce=-1===a.fullMask?a.reduce:function(){var t,e,i=this.limbs,n=i.length-1;if(this.reduce(),n===this.modOffset-1){for(e=i[n]&this.fullMask,i[n]-=e,t=0;t<this.fullOffset.length;t++)i[n+this.fullOffset[t]]-=this.fullFactor[t]*e;this.normalize()}},a.fullReduce=function(){var t,e;for(this._strongReduce(),this.addM(this.modulus),this.addM(this.modulus),this.normalize(),this._strongReduce(),e=this.limbs.length;e<this.modOffset;e++)this.limbs[e]=0;for(t=this.greaterEquals(this.modulus),e=0;e<this.limbs.length;e++)this.limbs[e]-=this.modulus.limbs[e]*t;return this.cnormalize(),this},a.inverse=function(){return this.power(this.modulus.sub(2))},i.fromBits=r.bn.fromBits,i},r.bn.prime={p127:r.bn.pseudoMersennePrime(127,[[0,-1]]),p25519:r.bn.pseudoMersennePrime(255,[[0,-19]]),p192:r.bn.pseudoMersennePrime(192,[[0,-1],[64,-1]]),p224:r.bn.pseudoMersennePrime(224,[[0,1],[96,-1]]),p256:r.bn.pseudoMersennePrime(256,[[0,-1],[96,1],[192,1],[224,-1]]),p384:r.bn.pseudoMersennePrime(384,[[0,-1],[32,1],[96,-1],[128,-1]]),p521:r.bn.pseudoMersennePrime(521,[[0,-1]])},r.bn.random=function(t,e){"object"!==(void 0===t?"undefined":n(t))&&(t=new r.bn(t));for(var i,s,o=t.limbs.length,a=t.limbs[o-1]+1,h=new r.bn;;){do{i=r.random.randomWords(o,e),i[o-1]<0&&(i[o-1]+=4294967296)}while(Math.floor(i[o-1]/a)===Math.floor(4294967296/a));for(i[o-1]%=a,s=0;s<o-1;s++)i[s]&=t.radixMask;if(h.limbs=i,!h.greaterEquals(t))return h}},r.ecc={},r.ecc.point=function(t,e,i){void 0===e?this.isIdentity=!0:(this.x=e,this.y=i,this.isIdentity=!1),this.curve=t},r.ecc.point.prototype={toJac:function(){return new r.ecc.pointJac(this.curve,this.x,this.y,new this.curve.field(1))},mult:function(t){return this.toJac().mult(t,this).toAffine()},mult2:function(t,e,i){return this.toJac().mult2(t,this,e,i).toAffine()},multiples:function(){var t,e,i;if(void 0===this._multiples)for(i=this.toJac().doubl(),t=this._multiples=[new r.ecc.point(this.curve),this,i.toAffine()],e=3;e<16;e++)i=i.add(this),t.push(i.toAffine());return this._multiples},isValid:function(){return this.y.square().equals(this.curve.b.add(this.x.mul(this.curve.a.add(this.x.square()))))},toBits:function(){return r.bitArray.concat(this.x.toBits(),this.y.toBits())}},r.ecc.pointJac=function(t,e,i,n){void 0===e?this.isIdentity=!0:(this.x=e,this.y=i,this.z=n,this.isIdentity=!1),this.curve=t},r.ecc.pointJac.prototype={add:function(t){var e,i,n,s,o,a,h,c,u,l,f,p=this;if(p.curve!==t.curve)throw"sjcl.ecc.add(): Points must be on the same curve to add them!";return p.isIdentity?t.toJac():t.isIdentity?p:(e=p.z.square(),i=t.x.mul(e).subM(p.x),i.equals(0)?p.y.equals(t.y.mul(e.mul(p.z)))?p.doubl():new r.ecc.pointJac(p.curve):(n=t.y.mul(e.mul(p.z)).subM(p.y),s=i.square(),o=n.square(),a=i.square().mul(i).addM(p.x.add(p.x).mul(s)),h=o.subM(a),c=p.x.mul(s).subM(h).mul(n),u=p.y.mul(i.square().mul(i)),l=c.subM(u),f=p.z.mul(i),new r.ecc.pointJac(this.curve,h,l,f)))},doubl:function(){if(this.isIdentity)return this;var t=this.y.square(),e=t.mul(this.x.mul(4)),i=t.square().mul(8),n=this.z.square(),s=this.x.sub(n).mul(3).mul(this.x.add(n)),o=s.square().subM(e).subM(e),a=e.sub(o).mul(s).subM(i),h=this.y.add(this.y).mul(this.z);return new r.ecc.pointJac(this.curve,o,a,h)},toAffine:function(){if(this.isIdentity||this.z.equals(0))return new r.ecc.point(this.curve);var t=this.z.inverse(),e=t.square();return new r.ecc.point(this.curve,this.x.mul(e).fullReduce(),this.y.mul(e.mul(t)).fullReduce())},mult:function(t,e){"number"==typeof t?t=[t]:void 0!==t.limbs&&(t=t.normalize().limbs);var i,n,s=new r.ecc.point(this.curve).toJac(),o=e.multiples();for(i=t.length-1;i>=0;i--)for(n=r.bn.prototype.radix-4;n>=0;n-=4)s=s.doubl().doubl().doubl().doubl().add(o[t[i]>>n&15]);return s},mult2:function(t,e,i,n){"number"==typeof t?t=[t]:void 0!==t.limbs&&(t=t.normalize().limbs),"number"==typeof i?i=[i]:void 0!==i.limbs&&(i=i.normalize().limbs);var s,o,a,h,c=new r.ecc.point(this.curve).toJac(),u=e.multiples(),l=n.multiples();for(s=Math.max(t.length,i.length)-1;s>=0;s--)for(a=0|t[s],h=0|i[s],o=r.bn.prototype.radix-4;o>=0;o-=4)c=c.doubl().doubl().doubl().doubl().add(u[a>>o&15]).add(l[h>>o&15]);return c},isValid:function(){var t=this.z.square(),e=t.square(),i=e.mul(t);return this.y.square().equals(this.curve.b.mul(i).add(this.x.mul(this.curve.a.mul(e).add(this.x.square()))))}},r.ecc.curve=function(t,e,i,n,s,o){this.field=t,this.r=t.prototype.modulus.sub(e),this.a=new t(i),this.b=new t(n),this.G=new r.ecc.point(this,new t(s),new t(o))},r.ecc.curve.prototype.fromBits=function(t){var e=r.bitArray,i=this.field.prototype.exponent+7&-8,n=new r.ecc.point(this,this.field.fromBits(e.bitSlice(t,0,i)),this.field.fromBits(e.bitSlice(t,i,2*i)));if(!n.isValid())throw new r.exception.corrupt("not on the curve!");return n},r.ecc.curves={c192:new r.ecc.curve(r.bn.prime.p192,"0x662107c8eb94364e4b2dd7ce",-3,"0x64210519e59c80e70fa7e9ab72243049feb8deecc146b9b1","0x188da80eb03090f67cbf20eb43a18800f4ff0afd82ff1012","0x07192b95ffc8da78631011ed6b24cdd573f977a11e794811"),c224:new r.ecc.curve(r.bn.prime.p224,"0xe95c1f470fc1ec22d6baa3a3d5c4",-3,"0xb4050a850c04b3abf54132565044b0b7d7bfd8ba270b39432355ffb4","0xb70e0cbd6bb4bf7f321390b94a03c1d356c21122343280d6115c1d21","0xbd376388b5f723fb4c22dfe6cd4375a05a07476444d5819985007e34"),c256:new r.ecc.curve(r.bn.prime.p256,"0x4319055358e8617b0c46353d039cdaae",-3,"0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b","0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296","0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5"),c384:new r.ecc.curve(r.bn.prime.p384,"0x389cb27e0bc8d21fa7e5f24cb74f58851313e696333ad68c",-3,"0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef","0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7","0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f")},r.ecc._dh=function(t){r.ecc[t]={publicKey:function(t,e){this._curve=t,e instanceof Array?this._point=t.fromBits(e):this._point=e},secretKey:function(t,e){this._curve=t,this._exponent=e},generateKeys:function(e,i){if(void 0===e&&(e=256),"number"==typeof e&&void 0===(e=r.ecc.curves["c"+e]))throw new r.exception.invalid("no such curve");var n=r.bn.random(e.r,i),s=e.G.mult(n);return{pub:new r.ecc[t].publicKey(e,s),sec:new r.ecc[t].secretKey(e,n)}}}},r.ecc._dh("elGamal"),r.ecc.elGamal.publicKey.prototype={kem:function(t){var e=r.bn.random(this._curve.r,t),i=this._curve.G.mult(e).toBits();return{key:r.hash.sha256.hash(this._point.mult(e).toBits()),tag:i}}},r.ecc.elGamal.secretKey.prototype={unkem:function(t){return r.hash.sha256.hash(this._curve.fromBits(t).mult(this._exponent).toBits())},dh:function(t){return r.hash.sha256.hash(t._point.mult(this._exponent).toBits())}},r.ecc._dh("ecdsa"),r.ecc.ecdsa.secretKey.prototype={sign:function(t,e){var i=this._curve.r,n=i.bitLength(),s=r.bn.random(i.sub(1),e).add(1),o=this._curve.G.mult(s).x.mod(i),a=r.bn.fromBits(t).add(o.mul(this._exponent)).inverseMod(i).mul(s).mod(i);return r.bitArray.concat(o.toBits(n),a.toBits(n))}},r.ecc.ecdsa.publicKey.prototype={verify:function(t,e){var i=r.bitArray,n=this._curve.r,s=n.bitLength(),o=r.bn.fromBits(i.bitSlice(e,0,s)),a=r.bn.fromBits(i.bitSlice(e,s,2*s)),h=r.bn.fromBits(t).mul(a).mod(n),c=o.mul(a).mod(n),u=this._curve.G.mult2(h,c,this._point).x;if(o.equals(0)||a.equals(0)||o.greaterEquals(n)||a.greaterEquals(n)||!u.equals(o))throw new r.exception.corrupt("signature didn't check out");return!0}},e.default=r},function(t,e,i){"use strict";var n={};n.D_A=1073741824,n.D_B=536870912,n.D_C=268435456,n.D_D=134217728,n.D_E=67108864,n.D_F=33554432,n.D_I=16777216,n.D_L=8388608,n.A_M=4194304,n.D_MQ=2097152,n.D_N=1048576,n.D_O=524288,n.D_P=262144,n.A_Q=131072,n.D_R=65536,n.D_S=32768,n.D_T=16384,n.D_U=8192,n.D_V=4096,n.D_W=2048,n.D_X=1024,n.D_Y=512,n.D_Z=256,n.A_NR=128,n.A_NS=64,n.A_NT=32,n.A_NX=16,n.A_NZ=8,n.D_ZH=4,n.D_K=2,n.UNK=0,n.URL=1;var r={};for(var s in n)r[s]=n[s];for(var s in n)n[s.toLowerCase()]=n[s];n.chsName=function(t){if(isNaN(t))return o[t]||o.UNK;var e=[];for(var i in r)(t&r[i])>0&&e.push(o[i]);return e.length<1?o.UNK:e.toString()};var o=n.CHSNAME={};n.CHSNAME.D_A="形容词 形语素",n.CHSNAME.D_B="区别词 区别语素",n.CHSNAME.D_C="连词 连语素",n.CHSNAME.D_D="副词 副语素",n.CHSNAME.D_E="叹词 叹语素",n.CHSNAME.D_F="方位词 方位语素",n.CHSNAME.D_I="成语",n.CHSNAME.D_L="习语",n.CHSNAME.A_M="数词 数语素",n.CHSNAME.D_MQ="数量词",n.CHSNAME.D_N="名词 名语素",n.CHSNAME.D_O="拟声词",n.CHSNAME.D_P="介词",n.CHSNAME.A_Q="量词 量语素",n.CHSNAME.D_R="代词 代语素",n.CHSNAME.D_S="处所词",n.CHSNAME.D_T="时间词",n.CHSNAME.D_U="助词 助语素",n.CHSNAME.D_V="动词 动语素",n.CHSNAME.D_W="标点符号",n.CHSNAME.D_X="非语素字",n.CHSNAME.D_Y="语气词 语气语素",n.CHSNAME.D_Z="状态词",n.CHSNAME.A_NR="人名",n.CHSNAME.A_NS="地名",n.CHSNAME.A_NT="机构团体",n.CHSNAME.A_NX="外文字符",n.CHSNAME.A_NZ="其他专名",n.CHSNAME.D_ZH="前接成分",n.CHSNAME.D_K="后接成分",n.CHSNAME.UNK="未知",n.CHSNAME.URL="网址 邮箱地址";for(var s in o)o[s.toLowerCase()]=o[s];t.exports=n},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function r(t,e,i){F(t+"/2/gm/server_pub",function(n){_("Get /2/gm/server_pub res: ",n);var r=c(n);_("Device pub key hex value is: ",r);var o=h();_("SessionKey is: ",o);var a=e.app_id,p=e.organization_id,g=e.member_id,d=e.token,m=e.version,y=Date.now(),v=u(),b="a="+a+"&o="+p+"&m="+g+"&t="+d+"&v="+m+"&tt="+y+"&r="+v,A=l(o,b),S=s(o,b);_("Mac value being sent is: ",S);var E=w.default.doCryptAsn1(r,o);_("SessionKey cipher is: ",E),F(t+"/2/gm/secrets?s="+A+"&m="+S+"&k="+E,function(t){_("Get /2/gm/secrets res: ",t);var e=t.split("\n");_("Server res array is: ",e),f(o,e[e.length-2].split(" ")[0],e[e.length-2].split(" ")[1],function(t,e){i(t,e)})})})}function s(t,e){var i=[0,0,0,0],n=(0,S.sm4Cbc)(t,1,i,e),r=S.sjcl.codec.base64.toBits(n),s=S.sjcl.bitArray.bitSlice(r,32*r.length-128,32*r.length),o=S.sjcl.codec.base64.fromBits(s);return encodeURIComponent(o)}function o(t,e,i,n,r){_("Enc iv hex value is: ",S.sjcl.codec.hex.fromBits(e)),_("EncKey is: ",t),_("Enc iv is",e);var s=(0,S.sm4Cbc)(t,1,e,i),o=S.sjcl.codec.hex.fromBits(S.sjcl.codec.base64.toBits(s));_("DataCipher hex value is: ",o),_("DataCipher is: ",s);var a=S.sjcl.codec.utf8String.toBits(b+"&"+A);_("Cipher metadata being b64 is: ",a);var h=S.sjcl.codec.base64.fromBits(a);_("DataCipher metaData base64 value is: ",h),_("AssembledCihper is: ",h+"&"+s);var c=Date.now(),u=setInterval(function(){if(localStorage.getItem("dict_segment")&&localStorage.getItem("dict2_segment")&&localStorage.getItem("dict3_segment")&&localStorage.getItem("names_segment")&&localStorage.getItem("stopword_segment")&&localStorage.getItem("synonym_segment")&&localStorage.getItem("wildcard_segment")){clearInterval(u);var t=Date.now();_("Saving dict to localStorage within %s ms.",t-c),B.useDefault();var e=B.doSegment(i),o=[],a=JSON.parse(localStorage.symKey.split("&")[0]).symKeyBits,l=JSON.parse(localStorage.symKey.split("&")[0]).iv;_("Search key is: ",a),e.forEach(function(t,e){o.push((0,S.sm4Cbc)(a,1,l,t.w))});var f=(0,S.generateMetaId)(i);if(_("MetaId is: "+f),"function"==typeof r){var p=[];o.forEach(function(t,e){p.push(encodeURIComponent(t))});var g=p.join(" ");v(C,"metadata="+g+"&mid="+f+"&tag="+n,function(t){r(t,h+"&"+s,f)})}else _("Callback must be function.")}else _("Loading dict, please wait...")},50)}function a(t){for(var e=t.split("&")[1],i=t.split("&")[0],n=S.sjcl.codec.base64.toBits(i),r=S.sjcl.codec.utf8String.fromBits(n),s=r.split("&")[1],o=r.split("&")[0],a=localStorage.symKey.split("&"),h=0;h<a.length-1;h++)if(JSON.parse(a[h]).id===o){var c=JSON.parse(a[h]).symKeyBits,u=JSON.parse(a[h]).iv;break}if(!c)return void _("No key found in localStorage.");if(!u)return void _("No iv found in localStorage.");var l=S.sjcl.codec.hex.fromBits(c),f=S.sjcl.hash.sha256.hash(s+l).slice(0,4),p=S.sjcl.codec.hex.fromBits(f);return _("New dec key hex value is: ",p),(0,S.sm4Cbc)(f,0,u,e)}function h(){return K.hex(!0)(K.engines.nativeMath,16)}function c(t){var e=S.sjcl.codec.base64.toBits(t),i=S.sjcl.codec.hex.fromBits(e);return i.substring(i.length-128,i.length)}function u(){return K.hex(!0)(K.engines.nativeMath,16)}function l(t,e){return encodeURIComponent((0,S.sm4Ecb)(t,1,e))}function f(t,e,i,n){var r=(0,S.sm4Ecb)(t,0,e);1!==r.split("\n").length&&(r=r.split("\n")[r.split("\n").length-1]),_("Dec result is: ",r);var s=r.split(" ")[0];b=s;var o=m(t,r);if(_("Received mac is: ",i),_("Computed mac is: ",o),o!==i)return void _("Mac is not equal");var a=S.sjcl.codec.base64.toBits(r.split(" ")[4]),h=S.sjcl.codec.utf8String.toBits(r.split(" ")[5]);_("Iv received from server is: ",h),_("Iv hex value is: ",S.sjcl.codec.hex.fromBits(h)),p(s,a,h);var c=S.sjcl.codec.hex.fromBits(a);if(_("The hex value of sm4 key received from server is: ",c),!n||"function"!=typeof n)return void _("Callback must be function");n(d(c),h)}function p(t,e,i){if(localStorage.symKey){for(var n=localStorage.symKey.split("&"),r=0;r<n.length-1;r++)if(JSON.parse(n[r]).id==t)return;g(t,e,i)}else localStorage.symKey=JSON.stringify({id:t,symKeyBits:e,iv:i})+"&"}function g(t,e,i){localStorage.symKey+=JSON.stringify({id:t,symKeyBits:e,iv:i})+"&"}function d(t){var e=K.hex(!0)(K.engines.nativeMath,32);A=e,_("Generated salt is: ",e),_("Value being hashed is: ",e+t);var i=S.sjcl.hash.sha256.hash(e+t).slice(0,4),n=S.sjcl.codec.hex.fromBits(i);return _("New enc key hex value is: ",n),i}function m(t,e){var i=[0,0,0,0],n=(0,S.sm4Cbc)(t,1,i,e),r=S.sjcl.codec.base64.toBits(n),s=S.sjcl.bitArray.bitSlice(r,32*r.length-128,32*r.length);return S.sjcl.codec.base64.fromBits(s)}function y(t,e,i){if(!localStorage.getItem("symKey"))throw new Error("No key found in Ls.");var n=JSON.parse(localStorage.symKey.split("&")[0]).symKeyBits,r=JSON.parse(localStorage.symKey.split("&")[0]).iv,s=encodeURIComponent((0,S.sm4Cbc)(n,1,r,t));if(_("Searching for: "+decodeURIComponent(s)+" with tag: "+e),""===e)var o="querystring="+s+"&tag="+e;else var o="querystring="+e+":"+s+"&tag="+e;v(D,o,function(t){_("Search results: "+t),i(t)})}function v(t,e,i){var n=new XMLHttpRequest;if(!n)return _("Giving up :( Cannot create an XMLHTTP instance"),!1;n.open("POST",t,!0),n.onload=function(){200==n.status?"function"!=typeof i?_("cb必须要为函数"):i(n.responseText):_(n.statusText)},n.onerror=function(){_(Error("Network Error"))},n.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),n.send(e)}function F(t,e){var i=new XMLHttpRequest;if(!i)return _("Giving up :( Cannot create an XMLHTTP instance"),!1;i.open("GET",t,!0),i.onload=function(){200==i.status?"function"!=typeof e?_("cb必须要为函数"):e(i.responseText):_(i.statusText)},i.onerror=function(){_(Error("Network Error"))},i.send()}Object.defineProperty(e,"__esModule",{value:!0}),e.search=e.getKey=e.dec=e.enc=void 0;var b,A,S=i(5),E=i(9),w=n(E),x=i(10),R=n(x),B=new R.default,C="https://demo.flksec.com:2018/create",D="https://demo.flksec.com:2018/search",_=i(1)("flkEnc"),K=i(26);e.enc=o,e.dec=a,e.getKey=r,e.search=y},function(t,e,i){"use strict";function n(t,e){return t^e}function r(t,e,i){var i=i||32;return e%=i,t<<e|t>>>i-e}function s(t){return y[(4026531840&t)>>>28][(251658240&t)>>>24]<<24|y[(15728640&t)>>>20][(983040&t)>>>16]<<16|y[(61440&t)>>>12][(3840&t)>>>8]<<8|y[(240&t)>>>4][(15&t)>>>0]<<0}function o(t){return t=s(t),n(n(n(t,r(t,2)),n(r(t,10),r(t,18))),r(t,24))}function a(t){return t=s(t),n(t,n(r(t,13),r(t,23)))}function h(t){var e=new Array,i=new Array;e[0]=n(t[0],F[0]),e[1]=n(t[1],F[1]),e[2]=n(t[2],F[2]),e[3]=n(t[3],F[3]);for(var r=0;r<32;r++)e[r+4]=n(e[r],a(n(n(e[r+1],e[r+2]),n(e[r+3],v[r])))),i[r]=e[r+4];return i}function c(t,e){if(1===e)return h(t);for(var i=h(t),n=new Array,r=i.length-1;r>=0;r--)n[i.length-1-r]=i[r];return n}function u(t,e){for(var i=t,r=0;r<32;r++)i[r+4]=n(i[r],o(n(n(i[r+1],i[r+2]),n(i[r+3],e[r]))));return[i[35],i[34],i[33],i[32]]}function l(t){var e=0;if(0===t.length)return t[0]=r(128,31),t[1]=0,t[2]=0,t[3]=0,e=16;for(0!=(255&t[t.length-1])?(t[t.length]=r(128,24),e+=4):0!=(65280&t[t.length-1])?(t[t.length-1]=128|t[t.length-1],e+=1):0!=(16711680&t[t.length-1])?(t[t.length-1]=r(128,8)|t[t.length-1],e+=2):0!=(4278190080&t[t.length-1])&&(t[t.length-1]=r(128,16)|t[t.length-1],e+=3);t.length%4!=0;)t[t.length]=0,e+=4;return e}function f(t){for(var e=0;t.length>0&&0===t[t.length-1];)t.pop();return 128&t[t.length-1]?(t[t.length-1]-=128,e+=1):32768&t[t.length-1]?(t[t.length-1]-=32768,e+=2):8388608&t[t.length-1]?(t[t.length-1]-=8388608,e+=3):2147483648&t[t.length-1]&&t.pop(),e}function p(t){var e=d.default.hash.sha256.hash(t);return d.default.codec.hex.fromBits(e).slice(0,20)}Object.defineProperty(e,"__esModule",{value:!0}),e.sjcl=e.generateMetaId=e.sm4Ecb=e.sm4Cbc=void 0;var g=i(2),d=function(t){return t&&t.__esModule?t:{default:t}}(g),m=i(1)("flkEnc"),y=new Array;y[0]=new Array(214,144,233,254,204,225,61,183,22,182,20,194,40,251,44,5),y[1]=new Array(43,103,154,118,42,190,4,195,170,68,19,38,73,134,6,153),y[2]=new Array(156,66,80,244,145,239,152,122,51,84,11,67,237,207,172,98),y[3]=new Array(228,179,28,169,201,8,232,149,128,223,148,250,117,143,63,166),y[4]=new Array(71,7,167,252,243,115,23,186,131,89,60,25,230,133,79,168),y[5]=new Array(104,107,129,178,113,100,218,139,248,235,15,75,112,86,157,53),y[6]=new Array(30,36,14,94,99,88,209,162,37,34,124,59,1,33,120,135),y[7]=new Array(212,0,70,87,159,211,39,82,76,54,2,231,160,196,200,158),y[8]=new Array(234,191,138,210,64,199,56,181,163,247,242,206,249,97,21,161),y[9]=new Array(224,174,93,164,155,52,26,85,173,147,50,48,245,140,177,227),y[10]=new Array(29,246,226,46,130,102,202,96,192,41,35,171,13,83,78,111),y[11]=new Array(213,219,55,69,222,253,142,47,3,255,106,114,109,108,91,81),y[12]=new Array(141,27,175,146,187,221,188,127,17,217,92,65,31,16,90,216),y[13]=new Array(10,193,49,136,165,205,123,189,45,116,208,18,184,229,180,176),y[14]=new Array(137,105,151,74,12,150,119,126,101,185,241,9,197,110,198,132),y[15]=new Array(24,240,125,236,58,220,77,32,121,238,95,62,215,203,57,72);var v=new Array(462357,472066609,943670861,1415275113,1886879365,2358483617,2830087869,3301692121,3773296373,4228057617,404694573,876298825,1347903077,1819507329,2291111581,2762715833,3234320085,3705924337,4177462797,337322537,808926789,1280531041,1752135293,2223739545,2695343797,3166948049,3638552301,4110090761,269950501,741554753,1213159005,1684763257),F=new Array(2746333894,1453994832,1736282519,2993693404),b={mode:{}};b.mode.ecb={name:"ecb",sm4_ecb:function(t,e,i){var n;if("string"==typeof t){if(16!==t.length)return void m("key error");n=d.default.codec.utf8String.toBits(t)}if("[object Array]"===Object.prototype.toString.call(t)){if(4!==t.length)return void m("key error");n=t}var r="";r=1===e?d.default.codec.utf8String.toBits(i):d.default.codec.base64.toBits(i);var s=c(n,e),o=new Array,a=new Array;1===e&&l(r);for(var h=0;h<r.length;h+=4)a=[r[h],r[h+1],r[h+2],r[h+3]],a=u(a,s),o.splice(h,0,a[0],a[1],a[2],a[3]);if(1!==e){var p=f(o);return d.default.codec.utf8String.fromBits(d.default.bitArray.bitSlice(o,0,32*o.length-8*p))}return d.default.codec.base64.fromBits(o)}},b.mode.cbc={name:"cbc",sm4_cbc:function(t,e,i,r){var s,o;if("string"==typeof i){if(16!==i.length)return;o=d.default.codec.utf8String.toBits(i)}if("[object Array]"===Object.prototype.toString.call(i)){if(4!==i.length)return;o=i}if("string"==typeof t){if(16!==t.length)return;s=d.default.codec.utf8String.toBits(t)}if("[object Array]"===Object.prototype.toString.call(t)){if(4!==t.length)return;s=t}var a="";a=1===e?d.default.codec.utf8String.toBits(r):d.default.codec.base64.toBits(r);var h=c(s,e),p=new Array,g=new Array;if(1===e&&l(a),1===e)for(var m=0;m<a.length;m+=4)a[m]=n(o[0],a[m]),a[m+1]=n(o[1],a[m+1]),a[m+2]=n(o[2],a[m+2]),a[m+3]=n(o[3],a[m+3]),g=[a[m],a[m+1],a[m+2],a[m+3]],o=u(g,h),p.splice(m,0,o[0],o[1],o[2],o[3]);else for(var m=0;m<a.length;m+=4)g=[a[m],a[m+1],a[m+2],a[m+3]],g=u(g,h),p[m]=n(o[0],g[0]),p[m+1]=n(o[1],g[1]),p[m+2]=n(o[2],g[2]),p[m+3]=n(o[3],g[3]),o=[a[m],a[m+1],a[m+2],a[m+3]];if(1!==e){var y=f(p);return d.default.codec.utf8String.fromBits(d.default.bitArray.bitSlice(p,0,32*p.length-8*y))}return d.default.codec.base64.fromBits(p)}};var A=b.mode.cbc.sm4_cbc,S=b.mode.ecb.sm4_ecb;e.sm4Cbc=A,e.sm4Ecb=S,e.generateMetaId=p,e.sjcl=d.default},function(t,e){function i(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}function r(t){if(u===setTimeout)return setTimeout(t,0);if((u===i||!u)&&setTimeout)return u=setTimeout,setTimeout(t,0);try{return u(t,0)}catch(e){try{return u.call(null,t,0)}catch(e){return u.call(this,t,0)}}}function s(t){if(l===clearTimeout)return clearTimeout(t);if((l===n||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(t);try{return l(t)}catch(e){try{return l.call(null,t)}catch(e){return l.call(this,t)}}}function o(){d&&p&&(d=!1,p.length?g=p.concat(g):m=-1,g.length&&a())}function a(){if(!d){var t=r(o);d=!0;for(var e=g.length;e;){for(p=g,g=[];++m<e;)p&&p[m].run();m=-1,e=g.length}p=null,d=!1,s(t)}}function h(t,e){this.fun=t,this.array=e}function c(){}var u,l,f=t.exports={};!function(){try{u="function"==typeof setTimeout?setTimeout:i}catch(t){u=i}try{l="function"==typeof clearTimeout?clearTimeout:n}catch(t){l=n}}();var p,g=[],d=!1,m=-1;f.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];g.push(new h(t,e)),1!==g.length||d||r(a)},h.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=c,f.addListener=c,f.once=c,f.off=c,f.removeListener=c,f.removeAllListeners=c,f.emit=c,f.prependListener=c,f.prependOnceListener=c,f.listeners=function(t){return[]},f.binding=function(t){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(t){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},function(t,e,i){function n(t){var i,n=0;for(i in t)n=(n<<5)-n+t.charCodeAt(i),n|=0;return e.colors[Math.abs(n)%e.colors.length]}function r(t){function i(){if(i.enabled){var t=i,n=+new Date,s=n-(r||n);t.diff=s,t.prev=r,t.curr=n,r=n;for(var o=new Array(arguments.length),a=0;a<o.length;a++)o[a]=arguments[a];o[0]=e.coerce(o[0]),"string"!=typeof o[0]&&o.unshift("%O");var h=0;o[0]=o[0].replace(/%([a-zA-Z%])/g,function(i,n){if("%%"===i)return i;h++;var r=e.formatters[n];if("function"==typeof r){var s=o[h];i=r.call(t,s),o.splice(h,1),h--}return i}),e.formatArgs.call(t,o);(i.log||e.log||console.log.bind(console)).apply(t,o)}}var r;return i.namespace=t,i.enabled=e.enabled(t),i.useColors=e.useColors(),i.color=n(t),i.destroy=s,"function"==typeof e.init&&e.init(i),e.instances.push(i),i}function s(){var t=e.instances.indexOf(this);return-1!==t&&(e.instances.splice(t,1),!0)}function o(t){e.save(t),e.names=[],e.skips=[];var i,n=("string"==typeof t?t:"").split(/[\s,]+/),r=n.length;for(i=0;i<r;i++)n[i]&&(t=n[i].replace(/\*/g,".*?"),"-"===t[0]?e.skips.push(new RegExp("^"+t.substr(1)+"$")):e.names.push(new RegExp("^"+t+"$")));for(i=0;i<e.instances.length;i++){var s=e.instances[i];s.enabled=e.enabled(s.namespace)}}function a(){e.enable("")}function h(t){if("*"===t[t.length-1])return!0;var i,n;for(i=0,n=e.skips.length;i<n;i++)if(e.skips[i].test(t))return!1;for(i=0,n=e.names.length;i<n;i++)if(e.names[i].test(t))return!0;return!1}function c(t){return t instanceof Error?t.stack||t.message:t}e=t.exports=r.debug=r.default=r,e.coerce=c,e.disable=a,e.enable=o,e.enabled=h,e.humanize=i(8),e.instances=[],e.names=[],e.skips=[],e.formatters={}},function(t,e){function i(t){if(t=String(t),!(t.length>100)){var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(t);if(e){var i=parseFloat(e[1]);switch((e[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return i*u;case"days":case"day":case"d":return i*c;case"hours":case"hour":case"hrs":case"hr":case"h":return i*h;case"minutes":case"minute":case"mins":case"min":case"m":return i*a;case"seconds":case"second":case"secs":case"sec":case"s":return i*o;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return i;default:return}}}}function n(t){return t>=c?Math.round(t/c)+"d":t>=h?Math.round(t/h)+"h":t>=a?Math.round(t/a)+"m":t>=o?Math.round(t/o)+"s":t+"ms"}function r(t){return s(t,c,"day")||s(t,h,"hour")||s(t,a,"minute")||s(t,o,"second")||t+" ms"}function s(t,e,i){if(!(t<e))return t<1.5*e?Math.floor(t/e)+" "+i:Math.ceil(t/e)+" "+i+"s"}var o=1e3,a=60*o,h=60*a,c=24*h,u=365.25*c;t.exports=function(t,e){e=e||{};var s=typeof t;if("string"===s&&t.length>0)return i(t);if("number"===s&&!1===isNaN(t))return e.long?r(t):n(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function BigInteger(t,e,i){null!=t&&("number"==typeof t?this.fromNumber(t,e,i):null==e&&"string"!=typeof t?this.fromString(t,256):this.fromString(t,e))}function nbi(){return new BigInteger(null)}function am1(t,e,i,n,r,s){for(;--s>=0;){var o=e*this[t++]+i[n]+r;r=Math.floor(o/67108864),i[n++]=67108863&o}return r}function am2(t,e,i,n,r,s){for(var o=32767&e,a=e>>15;--s>=0;){var h=32767&this[t],c=this[t++]>>15,u=a*h+c*o;h=o*h+((32767&u)<<15)+i[n]+(1073741823&r),r=(h>>>30)+(u>>>15)+a*c+(r>>>30),i[n++]=1073741823&h}return r}function am3(t,e,i,n,r,s){for(var o=16383&e,a=e>>14;--s>=0;){var h=16383&this[t],c=this[t++]>>14,u=a*h+c*o;h=o*h+((16383&u)<<14)+i[n]+r,r=(h>>28)+(u>>14)+a*c,i[n++]=268435455&h}return r}function int2char(t){return BI_RM.charAt(t)}function intAt(t,e){var i=BI_RC[t.charCodeAt(e)];return null==i?-1:i}function bnpCopyTo(t){for(var e=this.t-1;e>=0;--e)t[e]=this[e];t.t=this.t,t.s=this.s}function bnpFromInt(t){this.t=1,this.s=t<0?-1:0,t>0?this[0]=t:t<-1?this[0]=t+this.DV:this.t=0}function nbv(t){var e=nbi();return e.fromInt(t),e}function bnpFromString(t,e){var i;if(16==e)i=4;else if(8==e)i=3;else if(256==e)i=8;else if(2==e)i=1;else if(32==e)i=5;else{if(4!=e)return void this.fromRadix(t,e);i=2}this.t=0,this.s=0;for(var n=t.length,r=!1,s=0;--n>=0;){var o=8==i?255&t[n]:intAt(t,n);o<0?"-"==t.charAt(n)&&(r=!0):(r=!1,0==s?this[this.t++]=o:s+i>this.DB?(this[this.t-1]|=(o&(1<<this.DB-s)-1)<<s,this[this.t++]=o>>this.DB-s):this[this.t-1]|=o<<s,(s+=i)>=this.DB&&(s-=this.DB))}8==i&&0!=(128&t[0])&&(this.s=-1,s>0&&(this[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),r&&BigInteger.ZERO.subTo(this,this)}function bnpClamp(){for(var t=this.s&this.DM;this.t>0&&this[this.t-1]==t;)--this.t}function bnToString(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(16==t)e=4;else if(8==t)e=3;else if(2==t)e=1;else if(32==t)e=5;else{if(4!=t)return this.toRadix(t);e=2}var i,n=(1<<e)-1,r=!1,s="",o=this.t,a=this.DB-o*this.DB%e;if(o-- >0)for(a<this.DB&&(i=this[o]>>a)>0&&(r=!0,s=int2char(i));o>=0;)a<e?(i=(this[o]&(1<<a)-1)<<e-a,i|=this[--o]>>(a+=this.DB-e)):(i=this[o]>>(a-=e)&n,a<=0&&(a+=this.DB,--o)),i>0&&(r=!0),r&&(s+=int2char(i));return r?s:"0"}function bnNegate(){var t=nbi();return BigInteger.ZERO.subTo(this,t),t}function bnAbs(){return this.s<0?this.negate():this}function bnCompareTo(t){var e=this.s-t.s;if(0!=e)return e;var i=this.t;if(0!=(e=i-t.t))return this.s<0?-e:e;for(;--i>=0;)if(0!=(e=this[i]-t[i]))return e;return 0}function nbits(t){var e,i=1;return 0!=(e=t>>>16)&&(t=e,i+=16),0!=(e=t>>8)&&(t=e,i+=8),0!=(e=t>>4)&&(t=e,i+=4),0!=(e=t>>2)&&(t=e,i+=2),0!=(e=t>>1)&&(t=e,i+=1),i}function bnBitLength(){return this.t<=0?0:this.DB*(this.t-1)+nbits(this[this.t-1]^this.s&this.DM)}function bnpDLShiftTo(t,e){var i;for(i=this.t-1;i>=0;--i)e[i+t]=this[i];for(i=t-1;i>=0;--i)e[i]=0;e.t=this.t+t,e.s=this.s}function bnpDRShiftTo(t,e){for(var i=t;i<this.t;++i)e[i-t]=this[i];e.t=Math.max(this.t-t,0),e.s=this.s}function bnpLShiftTo(t,e){var i,n=t%this.DB,r=this.DB-n,s=(1<<r)-1,o=Math.floor(t/this.DB),a=this.s<<n&this.DM;for(i=this.t-1;i>=0;--i)e[i+o+1]=this[i]>>r|a,a=(this[i]&s)<<n;for(i=o-1;i>=0;--i)e[i]=0;e[o]=a,e.t=this.t+o+1,e.s=this.s,e.clamp()}function bnpRShiftTo(t,e){e.s=this.s;var i=Math.floor(t/this.DB);if(i>=this.t)return void(e.t=0);var n=t%this.DB,r=this.DB-n,s=(1<<n)-1;e[0]=this[i]>>n;for(var o=i+1;o<this.t;++o)e[o-i-1]|=(this[o]&s)<<r,e[o-i]=this[o]>>n;n>0&&(e[this.t-i-1]|=(this.s&s)<<r),e.t=this.t-i,e.clamp()}function bnpSubTo(t,e){for(var i=0,n=0,r=Math.min(t.t,this.t);i<r;)n+=this[i]-t[i],e[i++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n-=t.s;i<this.t;)n+=this[i],e[i++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;i<t.t;)n-=t[i],e[i++]=n&this.DM,n>>=this.DB;n-=t.s}e.s=n<0?-1:0,n<-1?e[i++]=this.DV+n:n>0&&(e[i++]=n),e.t=i,e.clamp()}function bnpMultiplyTo(t,e){var i=this.abs(),n=t.abs(),r=i.t;for(e.t=r+n.t;--r>=0;)e[r]=0;for(r=0;r<n.t;++r)e[r+i.t]=i.am(0,n[r],e,r,0,i.t);e.s=0,e.clamp(),this.s!=t.s&&BigInteger.ZERO.subTo(e,e)}function bnpSquareTo(t){for(var e=this.abs(),i=t.t=2*e.t;--i>=0;)t[i]=0;for(i=0;i<e.t-1;++i){var n=e.am(i,e[i],t,2*i,0,1);(t[i+e.t]+=e.am(i+1,2*e[i],t,2*i+1,n,e.t-i-1))>=e.DV&&(t[i+e.t]-=e.DV,t[i+e.t+1]=1)}t.t>0&&(t[t.t-1]+=e.am(i,e[i],t,2*i,0,1)),t.s=0,t.clamp()}function bnpDivRemTo(t,e,i){var n=t.abs();if(!(n.t<=0)){var r=this.abs();if(r.t<n.t)return null!=e&&e.fromInt(0),void(null!=i&&this.copyTo(i));null==i&&(i=nbi());var s=nbi(),o=this.s,a=t.s,h=this.DB-nbits(n[n.t-1]);h>0?(n.lShiftTo(h,s),r.lShiftTo(h,i)):(n.copyTo(s),r.copyTo(i));var c=s.t,u=s[c-1];if(0!=u){var l=u*(1<<this.F1)+(c>1?s[c-2]>>this.F2:0),f=this.FV/l,p=(1<<this.F1)/l,g=1<<this.F2,d=i.t,m=d-c,y=null==e?nbi():e;for(s.dlShiftTo(m,y),i.compareTo(y)>=0&&(i[i.t++]=1,i.subTo(y,i)),BigInteger.ONE.dlShiftTo(c,y),y.subTo(s,s);s.t<c;)s[s.t++]=0;for(;--m>=0;){var v=i[--d]==u?this.DM:Math.floor(i[d]*f+(i[d-1]+g)*p);if((i[d]+=s.am(0,v,i,m,0,c))<v)for(s.dlShiftTo(m,y),i.subTo(y,i);i[d]<--v;)i.subTo(y,i)}null!=e&&(i.drShiftTo(c,e),o!=a&&BigInteger.ZERO.subTo(e,e)),i.t=c,i.clamp(),h>0&&i.rShiftTo(h,i),o<0&&BigInteger.ZERO.subTo(i,i)}}}function bnMod(t){var e=nbi();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(BigInteger.ZERO)>0&&t.subTo(e,e),e}function Classic(t){this.m=t}function cConvert(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function cRevert(t){return t}function cReduce(t){t.divRemTo(this.m,null,t)}function cMulTo(t,e,i){t.multiplyTo(e,i),this.reduce(i)}function cSqrTo(t,e){t.squareTo(e),this.reduce(e)}function bnpInvDigit(){if(this.t<1)return 0;var t=this[0];if(0==(1&t))return 0;var e=3&t;return e=e*(2-(15&t)*e)&15,e=e*(2-(255&t)*e)&255,e=e*(2-((65535&t)*e&65535))&65535,e=e*(2-t*e%this.DV)%this.DV,e>0?this.DV-e:-e}function Montgomery(t){this.m=t,this.mp=t.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function montConvert(t){var e=nbi();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(BigInteger.ZERO)>0&&this.m.subTo(e,e),e}function montRevert(t){var e=nbi();return t.copyTo(e),this.reduce(e),e}function montReduce(t){for(;t.t<=this.mt2;)t[t.t++]=0;for(var e=0;e<this.m.t;++e){var i=32767&t[e],n=i*this.mpl+((i*this.mph+(t[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(i=e+this.m.t,t[i]+=this.m.am(0,n,t,e,0,this.m.t);t[i]>=t.DV;)t[i]-=t.DV,t[++i]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function montSqrTo(t,e){t.squareTo(e),this.reduce(e)}function montMulTo(t,e,i){t.multiplyTo(e,i),this.reduce(i)}function bnpIsEven(){return 0==(this.t>0?1&this[0]:this.s)}function bnpExp(t,e){if(t>4294967295||t<1)return BigInteger.ONE;var i=nbi(),n=nbi(),r=e.convert(this),s=nbits(t)-1;for(r.copyTo(i);--s>=0;)if(e.sqrTo(i,n),(t&1<<s)>0)e.mulTo(n,r,i);else{var o=i;i=n,n=o}return e.revert(i)}function bnModPowInt(t,e){var i;return i=t<256||e.isEven()?new Classic(e):new Montgomery(e),this.exp(t,i)}function bnClone(){var t=nbi();return this.copyTo(t),t}function bnIntValue(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function bnByteValue(){return 0==this.t?this.s:this[0]<<24>>24}function bnShortValue(){return 0==this.t?this.s:this[0]<<16>>16}function bnpChunkSize(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function bnSigNum(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1}function bnpToRadix(t){if(null==t&&(t=10),0==this.signum()||t<2||t>36)return"0";var e=this.chunkSize(t),i=Math.pow(t,e),n=nbv(i),r=nbi(),s=nbi(),o="";for(this.divRemTo(n,r,s);r.signum()>0;)o=(i+s.intValue()).toString(t).substr(1)+o,r.divRemTo(n,r,s);return s.intValue().toString(t)+o}function bnpFromRadix(t,e){this.fromInt(0),null==e&&(e=10);for(var i=this.chunkSize(e),n=Math.pow(e,i),r=!1,s=0,o=0,a=0;a<t.length;++a){var h=intAt(t,a);h<0?"-"==t.charAt(a)&&0==this.signum()&&(r=!0):(o=e*o+h,++s>=i&&(this.dMultiply(n),this.dAddOffset(o,0),s=0,o=0))}s>0&&(this.dMultiply(Math.pow(e,s)),this.dAddOffset(o,0)),r&&BigInteger.ZERO.subTo(this,this)}function bnpFromNumber(t,e,i){if("number"==typeof e)if(t<2)this.fromInt(1);else for(this.fromNumber(t,i),this.testBit(t-1)||this.bitwiseTo(BigInteger.ONE.shiftLeft(t-1),op_or,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(BigInteger.ONE.shiftLeft(t-1),this);else{var n=new Array,r=7&t;n.length=1+(t>>3),e.nextBytes(n),r>0?n[0]&=(1<<r)-1:n[0]=0,this.fromString(n,256)}}function bnToByteArray(){var t=this.t,e=new Array;e[0]=this.s;var i,n=this.DB-t*this.DB%8,r=0;if(t-- >0)for(n<this.DB&&(i=this[t]>>n)!=(this.s&this.DM)>>n&&(e[r++]=i|this.s<<this.DB-n);t>=0;)n<8?(i=(this[t]&(1<<n)-1)<<8-n,i|=this[--t]>>(n+=this.DB-8)):(i=this[t]>>(n-=8)&255,n<=0&&(n+=this.DB,--t)),0!=(128&i)&&(i|=-256),0==r&&(128&this.s)!=(128&i)&&++r,(r>0||i!=this.s)&&(e[r++]=i);return e}function bnEquals(t){return 0==this.compareTo(t)}function bnMin(t){return this.compareTo(t)<0?this:t}function bnMax(t){return this.compareTo(t)>0?this:t}function bnpBitwiseTo(t,e,i){var n,r,s=Math.min(t.t,this.t);for(n=0;n<s;++n)i[n]=e(this[n],t[n]);if(t.t<this.t){for(r=t.s&this.DM,n=s;n<this.t;++n)i[n]=e(this[n],r);i.t=this.t}else{for(r=this.s&this.DM,n=s;n<t.t;++n)i[n]=e(r,t[n]);i.t=t.t}i.s=e(this.s,t.s),i.clamp()}function op_and(t,e){return t&e}function bnAnd(t){var e=nbi();return this.bitwiseTo(t,op_and,e),e}function op_or(t,e){return t|e}function bnOr(t){var e=nbi();return this.bitwiseTo(t,op_or,e),e}function op_xor(t,e){return t^e}function bnXor(t){var e=nbi();return this.bitwiseTo(t,op_xor,e),e}function op_andnot(t,e){return t&~e}function bnAndNot(t){var e=nbi();return this.bitwiseTo(t,op_andnot,e),e}function bnNot(){for(var t=nbi(),e=0;e<this.t;++e)t[e]=this.DM&~this[e];return t.t=this.t,t.s=~this.s,t}function bnShiftLeft(t){var e=nbi();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}function bnShiftRight(t){var e=nbi();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}function lbit(t){if(0==t)return-1;var e=0;return 0==(65535&t)&&(t>>=16,e+=16),0==(255&t)&&(t>>=8,e+=8),0==(15&t)&&(t>>=4,e+=4),0==(3&t)&&(t>>=2,e+=2),0==(1&t)&&++e,e}function bnGetLowestSetBit(){for(var t=0;t<this.t;++t)if(0!=this[t])return t*this.DB+lbit(this[t]);return this.s<0?this.t*this.DB:-1}function cbit(t){for(var e=0;0!=t;)t&=t-1,++e;return e}function bnBitCount(){for(var t=0,e=this.s&this.DM,i=0;i<this.t;++i)t+=cbit(this[i]^e);return t}function bnTestBit(t){var e=Math.floor(t/this.DB);return e>=this.t?0!=this.s:0!=(this[e]&1<<t%this.DB)}function bnpChangeBit(t,e){var i=BigInteger.ONE.shiftLeft(t);return this.bitwiseTo(i,e,i),i}function bnSetBit(t){return this.changeBit(t,op_or)}function bnClearBit(t){return this.changeBit(t,op_andnot)}function bnFlipBit(t){return this.changeBit(t,op_xor)}function bnpAddTo(t,e){for(var i=0,n=0,r=Math.min(t.t,this.t);i<r;)n+=this[i]+t[i],e[i++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n+=t.s;i<this.t;)n+=this[i],e[i++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;i<t.t;)n+=t[i],e[i++]=n&this.DM,n>>=this.DB;n+=t.s}e.s=n<0?-1:0,n>0?e[i++]=n:n<-1&&(e[i++]=this.DV+n),e.t=i,e.clamp()}function bnAdd(t){var e=nbi();return this.addTo(t,e),e}function bnSubtract(t){var e=nbi();return this.subTo(t,e),e}function bnMultiply(t){var e=nbi();return this.multiplyTo(t,e),e}function bnSquare(){var t=nbi();return this.squareTo(t),t}function bnDivide(t){var e=nbi();return this.divRemTo(t,e,null),e}function bnRemainder(t){var e=nbi();return this.divRemTo(t,null,e),e}function bnDivideAndRemainder(t){var e=nbi(),i=nbi();return this.divRemTo(t,e,i),new Array(e,i)}function bnpDMultiply(t){this[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function bnpDAddOffset(t,e){if(0!=t){for(;this.t<=e;)this[this.t++]=0;for(this[e]+=t;this[e]>=this.DV;)this[e]-=this.DV,++e>=this.t&&(this[this.t++]=0),++this[e]}}function NullExp(){}function nNop(t){return t}function nMulTo(t,e,i){t.multiplyTo(e,i)}function nSqrTo(t,e){t.squareTo(e)}function bnPow(t){return this.exp(t,new NullExp)}function bnpMultiplyLowerTo(t,e,i){var n=Math.min(this.t+t.t,e);for(i.s=0,i.t=n;n>0;)i[--n]=0;var r;for(r=i.t-this.t;n<r;++n)i[n+this.t]=this.am(0,t[n],i,n,0,this.t);for(r=Math.min(t.t,e);n<r;++n)this.am(0,t[n],i,n,0,e-n);i.clamp()}function bnpMultiplyUpperTo(t,e,i){--e;var n=i.t=this.t+t.t-e;for(i.s=0;--n>=0;)i[n]=0;for(n=Math.max(e-this.t,0);n<t.t;++n)i[this.t+n-e]=this.am(e-n,t[n],i,0,0,this.t+n-e);i.clamp(),i.drShiftTo(1,i)}function Barrett(t){this.r2=nbi(),this.q3=nbi(),BigInteger.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function barrettConvert(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=nbi();return t.copyTo(e),this.reduce(e),e}function barrettRevert(t){return t}function barrettReduce(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}function barrettSqrTo(t,e){t.squareTo(e),this.reduce(e)}function barrettMulTo(t,e,i){t.multiplyTo(e,i),this.reduce(i)}function bnModPow(t,e){var i,n,r=t.bitLength(),s=nbv(1);if(r<=0)return s;i=r<18?1:r<48?3:r<144?4:r<768?5:6,n=r<8?new Classic(e):e.isEven()?new Barrett(e):new Montgomery(e);var o=new Array,a=3,h=i-1,c=(1<<i)-1;if(o[1]=n.convert(this),i>1){var u=nbi();for(n.sqrTo(o[1],u);a<=c;)o[a]=nbi(),n.mulTo(u,o[a-2],o[a]),a+=2}var l,f,p=t.t-1,g=!0,d=nbi();for(r=nbits(t[p])-1;p>=0;){for(r>=h?l=t[p]>>r-h&c:(l=(t[p]&(1<<r+1)-1)<<h-r,p>0&&(l|=t[p-1]>>this.DB+r-h)),a=i;0==(1&l);)l>>=1,--a;if((r-=a)<0&&(r+=this.DB,--p),g)o[l].copyTo(s),g=!1;else{for(;a>1;)n.sqrTo(s,d),n.sqrTo(d,s),a-=2;a>0?n.sqrTo(s,d):(f=s,s=d,d=f),n.mulTo(d,o[l],s)}for(;p>=0&&0==(t[p]&1<<r);)n.sqrTo(s,d),f=s,s=d,d=f,--r<0&&(r=this.DB-1,--p)}return n.revert(s)}function bnGCD(t){var e=this.s<0?this.negate():this.clone(),i=t.s<0?t.negate():t.clone();if(e.compareTo(i)<0){var n=e;e=i,i=n}var r=e.getLowestSetBit(),s=i.getLowestSetBit();if(s<0)return e;for(r<s&&(s=r),s>0&&(e.rShiftTo(s,e),i.rShiftTo(s,i));e.signum()>0;)(r=e.getLowestSetBit())>0&&e.rShiftTo(r,e),(r=i.getLowestSetBit())>0&&i.rShiftTo(r,i),e.compareTo(i)>=0?(e.subTo(i,e),e.rShiftTo(1,e)):(i.subTo(e,i),i.rShiftTo(1,i));return s>0&&i.lShiftTo(s,i),i}function bnpModInt(t){if(t<=0)return 0;var e=this.DV%t,i=this.s<0?t-1:0;if(this.t>0)if(0==e)i=this[0]%t;else for(var n=this.t-1;n>=0;--n)i=(e*i+this[n])%t;return i}function bnModInverse(t){var e=t.isEven();if(this.isEven()&&e||0==t.signum())return BigInteger.ZERO;for(var i=t.clone(),n=this.clone(),r=nbv(1),s=nbv(0),o=nbv(0),a=nbv(1);0!=i.signum();){for(;i.isEven();)i.rShiftTo(1,i),e?(r.isEven()&&s.isEven()||(r.addTo(this,r),s.subTo(t,s)),r.rShiftTo(1,r)):s.isEven()||s.subTo(t,s),s.rShiftTo(1,s);for(;n.isEven();)n.rShiftTo(1,n),e?(o.isEven()&&a.isEven()||(o.addTo(this,o),a.subTo(t,a)),o.rShiftTo(1,o)):a.isEven()||a.subTo(t,a),a.rShiftTo(1,a);i.compareTo(n)>=0?(i.subTo(n,i),e&&r.subTo(o,r),s.subTo(a,s)):(n.subTo(i,n),e&&o.subTo(r,o),a.subTo(s,a))}return 0!=n.compareTo(BigInteger.ONE)?BigInteger.ZERO:a.compareTo(t)>=0?a.subtract(t):a.signum()<0?(a.addTo(t,a),a.signum()<0?a.add(t):a):a}function bnIsProbablePrime(t){var e,i=this.abs();if(1==i.t&&i[0]<=lowprimes[lowprimes.length-1]){for(e=0;e<lowprimes.length;++e)if(i[0]==lowprimes[e])return!0;return!1}if(i.isEven())return!1;for(e=1;e<lowprimes.length;){for(var n=lowprimes[e],r=e+1;r<lowprimes.length&&n<lplim;)n*=lowprimes[r++];for(n=i.modInt(n);e<r;)if(n%lowprimes[e++]==0)return!1}return i.millerRabin(t)}function bnpMillerRabin(t){var e=this.subtract(BigInteger.ONE),i=e.getLowestSetBit();if(i<=0)return!1;var n=e.shiftRight(i);(t=t+1>>1)>lowprimes.length&&(t=lowprimes.length);for(var r=nbi(),s=0;s<t;++s){r.fromInt(lowprimes[Math.floor(Math.random()*lowprimes.length)]);var o=r.modPow(n,this);if(0!=o.compareTo(BigInteger.ONE)&&0!=o.compareTo(e)){for(var a=1;a++<i&&0!=o.compareTo(e);)if(o=o.modPowInt(2,this),0==o.compareTo(BigInteger.ONE))return!1;if(0!=o.compareTo(e))return!1}}return!0}function Arcfour(){this.i=0,this.j=0,this.S=new Array}function ARC4init(t){var e,i,n;for(e=0;e<256;++e)this.S[e]=e;for(i=0,e=0;e<256;++e)i=i+this.S[e]+t[e%t.length]&255,n=this.S[e],this.S[e]=this.S[i],this.S[i]=n;this.i=0,this.j=0}function ARC4next(){var t;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,t=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=t,this.S[t+this.S[this.i]&255]}function prng_newstate(){return new Arcfour}function rng_seed_int(t){rng_pool[rng_pptr++]^=255&t,rng_pool[rng_pptr++]^=t>>8&255,rng_pool[rng_pptr++]^=t>>16&255,rng_pool[rng_pptr++]^=t>>24&255,rng_pptr>=rng_psize&&(rng_pptr-=rng_psize)}function rng_seed_time(){rng_seed_int((new Date).getTime())}function rng_get_byte(){if(null==rng_state){for(rng_seed_time(),rng_state=prng_newstate(),rng_state.init(rng_pool),rng_pptr=0;rng_pptr<rng_pool.length;++rng_pptr)rng_pool[rng_pptr]=0;rng_pptr=0}return rng_state.next()}function rng_get_bytes(t){var e;for(e=0;e<t.length;++e)t[e]=rng_get_byte()}function SecureRandom(){}function hex2b64(t){var e,i,n="";for(e=0;e+3<=t.length;e+=3)i=parseInt(t.substring(e,e+3),16),n+=b64map.charAt(i>>6)+b64map.charAt(63&i);if(e+1==t.length?(i=parseInt(t.substring(e,e+1),16),n+=b64map.charAt(i<<2)):e+2==t.length&&(i=parseInt(t.substring(e,e+2),16),n+=b64map.charAt(i>>2)+b64map.charAt((3&i)<<4)),b64pad)for(;(3&n.length)>0;)n+=b64pad;return n}function b64tohex(t){var e,i,n,r="",s=0;for(e=0;e<t.length&&t.charAt(e)!=b64pad;++e)(n=b64map.indexOf(t.charAt(e)))<0||(0==s?(r+=int2char(n>>2),i=3&n,s=1):1==s?(r+=int2char(i<<2|n>>4),i=15&n,s=2):2==s?(r+=int2char(i),r+=int2char(n>>2),i=3&n,s=3):(r+=int2char(i<<2|n>>4),r+=int2char(15&n),s=0));return 1==s&&(r+=int2char(i<<2)),r}function b64toBA(t){var e,i=b64tohex(t),n=new Array;for(e=0;2*e<i.length;++e)n[e]=parseInt(i.substring(2*e,2*e+2),16);return n}function X509(){this.subjectPublicKeyRSA=null,this.subjectPublicKeyRSA_hN=null,this.subjectPublicKeyRSA_hE=null,this.hex=null,this.getSerialNumberHex=function(){return ASN1HEX.getDecendantHexVByNthList(this.hex,0,[0,1])},this.getIssuerHex=function(){return ASN1HEX.getDecendantHexTLVByNthList(this.hex,0,[0,3])},this.getIssuerString=function(){return X509.hex2dn(ASN1HEX.getDecendantHexTLVByNthList(this.hex,0,[0,3]))},this.getSubjectHex=function(){return ASN1HEX.getDecendantHexTLVByNthList(this.hex,0,[0,5])},this.getSubjectString=function(){return X509.hex2dn(ASN1HEX.getDecendantHexTLVByNthList(this.hex,0,[0,5]))},this.getNotBefore=function(){var t=ASN1HEX.getDecendantHexVByNthList(this.hex,0,[0,4,0]);return t=t.replace(/(..)/g,"%$1"),t=decodeURIComponent(t)},this.getNotAfter=function(){var t=ASN1HEX.getDecendantHexVByNthList(this.hex,0,[0,4,1]);return t=t.replace(/(..)/g,"%$1"),t=decodeURIComponent(t)},this.readCertPEM=function(t){var e=X509.pemToHex(t),i=X509.getPublicKeyHexArrayFromCertHex(e),n=new RSAKey;n.setPublic(i[0],i[1]),this.subjectPublicKeyRSA=n,this.subjectPublicKeyRSA_hN=i[0],this.subjectPublicKeyRSA_hE=i[1],this.hex=e},this.readCertPEMWithoutRSAInit=function(t){var e=X509.pemToHex(t),i=X509.getPublicKeyHexArrayFromCertHex(e);this.subjectPublicKeyRSA.setPublic(i[0],i[1]),this.subjectPublicKeyRSA_hN=i[0],this.subjectPublicKeyRSA_hE=i[1],this.hex=e}}function ECFieldElementFp(t,e){this.x=e,this.q=t}function feFpEquals(t){return t==this||this.q.equals(t.q)&&this.x.equals(t.x)}function feFpToBigInteger(){return this.x}function feFpNegate(){return new ECFieldElementFp(this.q,this.x.negate().mod(this.q))}function feFpAdd(t){return new ECFieldElementFp(this.q,this.x.add(t.toBigInteger()).mod(this.q))}function feFpSubtract(t){return new ECFieldElementFp(this.q,this.x.subtract(t.toBigInteger()).mod(this.q))}function feFpMultiply(t){return new ECFieldElementFp(this.q,this.x.multiply(t.toBigInteger()).mod(this.q))}function feFpSquare(){return new ECFieldElementFp(this.q,this.x.square().mod(this.q))}function feFpDivide(t){return new ECFieldElementFp(this.q,this.x.multiply(t.toBigInteger().modInverse(this.q)).mod(this.q))}function ECPointFp(t,e,i,n){this.curve=t,this.x=e,this.y=i,this.z=null==n?BigInteger.ONE:n,this.zinv=null}function pointFpGetX(){return null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.x.toBigInteger().multiply(this.zinv).mod(this.curve.q))}function pointFpGetY(){return null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.y.toBigInteger().multiply(this.zinv).mod(this.curve.q))}function pointFpEquals(t){if(t==this)return!0;if(this.isInfinity())return t.isInfinity();if(t.isInfinity())return this.isInfinity();var e,i;return e=t.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(t.z)).mod(this.curve.q),!!e.equals(BigInteger.ZERO)&&(i=t.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(t.z)).mod(this.curve.q),i.equals(BigInteger.ZERO))}function pointFpIsInfinity(){return null==this.x&&null==this.y||this.z.equals(BigInteger.ZERO)&&!this.y.toBigInteger().equals(BigInteger.ZERO)}function pointFpNegate(){return new ECPointFp(this.curve,this.x,this.y.negate(),this.z)}function pointFpAdd(t){if(this.isInfinity())return t;if(t.isInfinity())return this;var e=t.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(t.z)).mod(this.curve.q),i=t.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(t.z)).mod(this.curve.q);if(BigInteger.ZERO.equals(i))return BigInteger.ZERO.equals(e)?this.twice():this.curve.getInfinity();var n=new BigInteger("3"),r=this.x.toBigInteger(),s=this.y.toBigInteger(),o=(t.x.toBigInteger(),t.y.toBigInteger(),i.square()),a=o.multiply(i),h=r.multiply(o),c=e.square().multiply(this.z),u=c.subtract(h.shiftLeft(1)).multiply(t.z).subtract(a).multiply(i).mod(this.curve.q),l=h.multiply(n).multiply(e).subtract(s.multiply(a)).subtract(c.multiply(e)).multiply(t.z).add(e.multiply(a)).mod(this.curve.q),f=a.multiply(this.z).multiply(t.z).mod(this.curve.q);return new ECPointFp(this.curve,this.curve.fromBigInteger(u),this.curve.fromBigInteger(l),f)}function pointFpTwice(){if(this.isInfinity())return this;if(0==this.y.toBigInteger().signum())return this.curve.getInfinity();var t=new BigInteger("3"),e=this.x.toBigInteger(),i=this.y.toBigInteger(),n=i.multiply(this.z),r=n.multiply(i).mod(this.curve.q),s=this.curve.a.toBigInteger(),o=e.square().multiply(t);BigInteger.ZERO.equals(s)||(o=o.add(this.z.square().multiply(s))),o=o.mod(this.curve.q);var a=o.square().subtract(e.shiftLeft(3).multiply(r)).shiftLeft(1).multiply(n).mod(this.curve.q),h=o.multiply(t).multiply(e).subtract(r.shiftLeft(1)).shiftLeft(2).multiply(r).subtract(o.square().multiply(o)).mod(this.curve.q),c=n.square().multiply(n).shiftLeft(3).mod(this.curve.q);return new ECPointFp(this.curve,this.curve.fromBigInteger(a),this.curve.fromBigInteger(h),c)}function pointFpMultiply(t){if(this.isInfinity())return this;if(0==t.signum())return this.curve.getInfinity();var e,i=t,n=i.multiply(new BigInteger("3")),r=this.negate(),s=this;for(e=n.bitLength()-2;e>0;--e){s=s.twice();var o=n.testBit(e);o!=i.testBit(e)&&(s=s.add(o?this:r))}return s}function pointFpMultiplyTwo(t,e,i){var n;n=t.bitLength()>i.bitLength()?t.bitLength()-1:i.bitLength()-1;for(var r=this.curve.getInfinity(),s=this.add(e);n>=0;)r=r.twice(),t.testBit(n)?r=i.testBit(n)?r.add(s):r.add(this):i.testBit(n)&&(r=r.add(e)),--n;return r}function ECCurveFp(t,e,i){this.q=t,this.a=this.fromBigInteger(e),this.b=this.fromBigInteger(i),this.infinity=new ECPointFp(this,null,null)}function curveFpGetQ(){return this.q}function curveFpGetA(){return this.a}function curveFpGetB(){return this.b}function curveFpEquals(t){return t==this||this.q.equals(t.q)&&this.a.equals(t.a)&&this.b.equals(t.b)}function curveFpGetInfinity(){return this.infinity}function curveFpFromBigInteger(t){return new ECFieldElementFp(this.q,t)}function curveFpDecodePointHex(t){switch(parseInt(t.substr(0,2),16)){case 0:return this.infinity;case 2:case 3:return null;case 4:case 6:case 7:var e=(t.length-2)/2,i=t.substr(2,e),n=t.substr(e+2,e);return new ECPointFp(this,this.fromBigInteger(new BigInteger(i,16)),this.fromBigInteger(new BigInteger(n,16)));default:return null}}function SM3Digest(){this.BYTE_LENGTH=64,this.xBuf=new Array,this.xBufOff=0,this.byteCount=0,this.DIGEST_LENGTH=32,this.v0=[1937774191,1226093241,388252375,3666478592,2842636476,372324522,3817729613,2969243214],this.v0=[1937774191,1226093241,388252375,-628488704,-1452330820,372324522,-477237683,-1325724082],this.v=new Array(8),this.v_=new Array(8),this.X0=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.X=new Array(68),this.xOff=0,this.T_00_15=2043430169,this.T_16_63=2055708042,arguments.length>0?this.InitDigest(arguments[0]):this.Init()}function SM2Cipher(t){this.ct=1,this.p2=null,this.sm3keybase=null,this.sm3c3=null,this.key=new Array(32),this.keyOff=0,this.cipherMode=void 0!==t?t:SM2CipherMode.C1C3C2}Object.defineProperty(exports,"__esModule",{value:!0});var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_sjcl=__webpack_require__(2),_sjcl2=_interopRequireDefault(_sjcl),CryptoJS=CryptoJS||function(t,e){var i={},n=i.lib={},r=n.Base=function(){function t(){}return{extend:function(e){t.prototype=this;var i=new t;return e&&i.mixIn(e),i.hasOwnProperty("init")||(i.init=function(){i.$super.init.apply(this,arguments)}),i.init.prototype=i,i.$super=this,i},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),s=n.WordArray=r.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=void 0!=e?e:4*t.length},toString:function(t){return(t||a).stringify(this)},concat:function(t){var e=this.words,i=t.words,n=this.sigBytes,r=t.sigBytes;if(this.clamp(),n%4)for(var s=0;s<r;s++){var o=i[s>>>2]>>>24-s%4*8&255;e[n+s>>>2]|=o<<24-(n+s)%4*8}else if(i.length>65535)for(var s=0;s<r;s+=4)e[n+s>>>2]=i[s>>>2];else e.push.apply(e,i);return this.sigBytes+=r,this},clamp:function(){var e=this.words,i=this.sigBytes;e[i>>>2]&=4294967295<<32-i%4*8,e.length=t.ceil(i/4)},clone:function(){var t=r.clone.call(this);return t.words=this.words.slice(0),t},random:function(e){for(var i=[],n=0;n<e;n+=4)i.push(4294967296*t.random()|0);return new s.init(i,e)}}),o=i.enc={},a=o.Hex={stringify:function(t){for(var e=t.words,i=t.sigBytes,n=[],r=0;r<i;r++){var s=e[r>>>2]>>>24-r%4*8&255;n.push((s>>>4).toString(16)),n.push((15&s).toString(16))}return n.join("")},parse:function(t){for(var e=t.length,i=[],n=0;n<e;n+=2)i[n>>>3]|=parseInt(t.substr(n,2),16)<<24-n%8*4;return new s.init(i,e/2)}},h=o.Latin1={stringify:function(t){for(var e=t.words,i=t.sigBytes,n=[],r=0;r<i;r++){var s=e[r>>>2]>>>24-r%4*8&255;n.push(String.fromCharCode(s))}return n.join("")},parse:function(t){for(var e=t.length,i=[],n=0;n<e;n++)i[n>>>2]|=(255&t.charCodeAt(n))<<24-n%4*8;return new s.init(i,e)}},c=o.Utf8={stringify:function(t){try{return decodeURIComponent(escape(h.stringify(t)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(t){return h.parse(unescape(encodeURIComponent(t)))}},u=n.BufferedBlockAlgorithm=r.extend({reset:function(){this._data=new s.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=c.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(e){var i=this._data,n=i.words,r=i.sigBytes,o=this.blockSize,a=4*o,h=r/a;h=e?t.ceil(h):t.max((0|h)-this._minBufferSize,0);var c=h*o,u=t.min(4*c,r);if(c){for(var l=0;l<c;l+=o)this._doProcessBlock(n,l);var f=n.splice(0,c);i.sigBytes-=u}return new s.init(f,u)},clone:function(){var t=r.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0}),l=(n.Hasher=u.extend({cfg:r.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){u.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(t){return function(e,i){return new t.init(i).finalize(e)}},_createHmacHelper:function(t){return function(e,i){return new l.HMAC.init(t,i).finalize(e)}}}),i.algo={});return i}(Math);if(CryptoJS.lib.Cipher||function(t){var e=CryptoJS,i=e.lib,n=i.Base,r=i.WordArray,s=i.BufferedBlockAlgorithm,o=e.enc,a=(o.Utf8,o.Base64),h=e.algo,c=h.EvpKDF,u=i.Cipher=s.extend({cfg:n.extend(),createEncryptor:function(t,e){return this.create(this._ENC_XFORM_MODE,t,e)},createDecryptor:function(t,e){return this.create(this._DEC_XFORM_MODE,t,e)},init:function(t,e,i){this.cfg=this.cfg.extend(i),this._xformMode=t,this._key=e,this.reset()},reset:function(){s.reset.call(this),this._doReset()},process:function(t){return this._append(t),this._process()},finalize:function(t){return t&&this._append(t),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function t(t){return"string"==typeof t?S:F}return function(e){return{encrypt:function(i,n,r){return t(n).encrypt(e,i,n,r)},decrypt:function(i,n,r){return t(n).decrypt(e,i,n,r)}}}}()}),l=(i.StreamCipher=u.extend({_doFinalize:function(){return this._process(!0)},blockSize:1}),e.mode={}),f=i.BlockCipherMode=n.extend({createEncryptor:function(t,e){return this.Encryptor.create(t,e)},createDecryptor:function(t,e){return this.Decryptor.create(t,e)},init:function(t,e){this._cipher=t,this._iv=e}}),p=l.CBC=function(){function e(e,i,n){var r=this._iv;if(r){var s=r;this._iv=t}else var s=this._prevBlock;for(var o=0;o<n;o++)e[i+o]^=s[o]}var i=f.extend();return i.Encryptor=i.extend({processBlock:function(t,i){var n=this._cipher,r=n.blockSize;e.call(this,t,i,r),n.encryptBlock(t,i),this._prevBlock=t.slice(i,i+r)}}),i.Decryptor=i.extend({processBlock:function(t,i){var n=this._cipher,r=n.blockSize,s=t.slice(i,i+r);n.decryptBlock(t,i),e.call(this,t,i,r),this._prevBlock=s}}),i}(),g=e.pad={},d=g.Pkcs7={pad:function(t,e){for(var i=4*e,n=i-t.sigBytes%i,s=n<<24|n<<16|n<<8|n,o=[],a=0;a<n;a+=4)o.push(s);var h=r.create(o,n);t.concat(h)},unpad:function(t){var e=255&t.words[t.sigBytes-1>>>2];t.sigBytes-=e}},m=(i.BlockCipher=u.extend({cfg:u.cfg.extend({mode:p,padding:d}),reset:function(){u.reset.call(this);var t=this.cfg,e=t.iv,i=t.mode;if(this._xformMode==this._ENC_XFORM_MODE)var n=i.createEncryptor;else{var n=i.createDecryptor;this._minBufferSize=1}this._mode=n.call(i,this,e&&e.words)},_doProcessBlock:function(t,e){this._mode.processBlock(t,e)},_doFinalize:function(){var t=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){t.pad(this._data,this.blockSize);var e=this._process(!0)}else{var e=this._process(!0);t.unpad(e)}return e},blockSize:4}),i.CipherParams=n.extend({init:function(t){this.mixIn(t)},toString:function(t){return(t||this.formatter).stringify(this)}})),y=e.format={},v=y.OpenSSL={stringify:function(t){var e=t.ciphertext,i=t.salt;if(i)var n=r.create([1398893684,1701076831]).concat(i).concat(e);else var n=e;return n.toString(a)},parse:function(t){var e=a.parse(t),i=e.words;if(1398893684==i[0]&&1701076831==i[1]){var n=r.create(i.slice(2,4));i.splice(0,4),e.sigBytes-=16}return m.create({ciphertext:e,salt:n})}},F=i.SerializableCipher=n.extend({cfg:n.extend({format:v}),encrypt:function(t,e,i,n){n=this.cfg.extend(n);var r=t.createEncryptor(i,n),s=r.finalize(e),o=r.cfg;return m.create({ciphertext:s,key:i,iv:o.iv,algorithm:t,mode:o.mode,padding:o.padding,blockSize:t.blockSize,formatter:n.format})},decrypt:function(t,e,i,n){return n=this.cfg.extend(n),e=this._parse(e,n.format),t.createDecryptor(i,n).finalize(e.ciphertext)},_parse:function(t,e){return"string"==typeof t?e.parse(t,this):t}}),b=e.kdf={},A=b.OpenSSL={execute:function(t,e,i,n){n||(n=r.random(8));var s=c.create({keySize:e+i}).compute(t,n),o=r.create(s.words.slice(e),4*i);return s.sigBytes=4*e,m.create({key:s,iv:o,salt:n})}},S=i.PasswordBasedCipher=F.extend({cfg:F.cfg.extend({kdf:A}),encrypt:function(t,e,i,n){n=this.cfg.extend(n);var r=n.kdf.execute(i,t.keySize,t.ivSize);n.iv=r.iv;var s=F.encrypt.call(this,t,e,r.key,n);return s.mixIn(r),s},decrypt:function(t,e,i,n){n=this.cfg.extend(n),e=this._parse(e,n.format);var r=n.kdf.execute(i,t.keySize,t.ivSize,e.salt);return n.iv=r.iv,F.decrypt.call(this,t,e,r.key,n)}})}(),function(){var t=CryptoJS,e=t.lib,i=e.WordArray,n=t.enc;n.Base64={stringify:function(t){var e=t.words,i=t.sigBytes,n=this._map;t.clamp();for(var r=[],s=0;s<i;s+=3)for(var o=e[s>>>2]>>>24-s%4*8&255,a=e[s+1>>>2]>>>24-(s+1)%4*8&255,h=e[s+2>>>2]>>>24-(s+2)%4*8&255,c=o<<16|a<<8|h,u=0;u<4&&s+.75*u<i;u++)r.push(n.charAt(c>>>6*(3-u)&63));var l=n.charAt(64);if(l)for(;r.length%4;)r.push(l);return r.join("")},parse:function(t){var e=t.length,n=this._map,r=n.charAt(64);if(r){var s=t.indexOf(r);-1!=s&&(e=s)}for(var o=[],a=0,h=0;h<e;h++)if(h%4){var c=n.indexOf(t.charAt(h-1))<<h%4*2,u=n.indexOf(t.charAt(h))>>>6-h%4*2;o[a>>>2]|=(c|u)<<24-a%4*8,a++}return i.create(o,a)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(){var t=CryptoJS,e=t.lib,i=e.WordArray,n=e.Hasher,r=t.algo,s=[],o=r.SHA1=n.extend({_doReset:function(){this._hash=new i.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(t,e){for(var i=this._hash.words,n=i[0],r=i[1],o=i[2],a=i[3],h=i[4],c=0;c<80;c++){if(c<16)s[c]=0|t[e+c];else{var u=s[c-3]^s[c-8]^s[c-14]^s[c-16];s[c]=u<<1|u>>>31}var l=(n<<5|n>>>27)+h+s[c];l+=c<20?1518500249+(r&o|~r&a):c<40?1859775393+(r^o^a):c<60?(r&o|r&a|o&a)-1894007588:(r^o^a)-899497514,h=a,a=o,o=r<<30|r>>>2,r=n,n=l}i[0]=i[0]+n|0,i[1]=i[1]+r|0,i[2]=i[2]+o|0,i[3]=i[3]+a|0,i[4]=i[4]+h|0},_doFinalize:function(){var t=this._data,e=t.words,i=8*this._nDataBytes,n=8*t.sigBytes;return e[n>>>5]|=128<<24-n%32,e[14+(n+64>>>9<<4)]=Math.floor(i/4294967296),e[15+(n+64>>>9<<4)]=i,t.sigBytes=4*e.length,this._process(),this._hash},clone:function(){var t=n.clone.call(this);return t._hash=this._hash.clone(),t}});t.SHA1=n._createHelper(o),t.HmacSHA1=n._createHmacHelper(o)}(),function(t){var e=CryptoJS,i=e.lib,n=i.WordArray,r=i.Hasher,s=e.algo,o=[],a=[];!function(){function e(t){return 4294967296*(t-(0|t))|0}for(var i=2,n=0;n<64;)(function(e){for(var i=t.sqrt(e),n=2;n<=i;n++)if(!(e%n))return!1;return!0})(i)&&(n<8&&(o[n]=e(t.pow(i,.5))),a[n]=e(t.pow(i,1/3)),n++),i++}();var h=[],c=s.SHA256=r.extend({_doReset:function(){this._hash=new n.init(o.slice(0))},_doProcessBlock:function(t,e){for(var i=this._hash.words,n=i[0],r=i[1],s=i[2],o=i[3],c=i[4],u=i[5],l=i[6],f=i[7],p=0;p<64;p++){if(p<16)h[p]=0|t[e+p];else{var g=h[p-15],d=(g<<25|g>>>7)^(g<<14|g>>>18)^g>>>3,m=h[p-2],y=(m<<15|m>>>17)^(m<<13|m>>>19)^m>>>10;h[p]=d+h[p-7]+y+h[p-16]}var v=c&u^~c&l,F=n&r^n&s^r&s,b=(n<<30|n>>>2)^(n<<19|n>>>13)^(n<<10|n>>>22),A=(c<<26|c>>>6)^(c<<21|c>>>11)^(c<<7|c>>>25),S=f+A+v+a[p]+h[p],E=b+F;f=l,l=u,u=c,c=o+S|0,o=s,s=r,r=n,n=S+E|0}i[0]=i[0]+n|0,i[1]=i[1]+r|0,i[2]=i[2]+s|0,i[3]=i[3]+o|0,i[4]=i[4]+c|0,i[5]=i[5]+u|0,i[6]=i[6]+l|0,i[7]=i[7]+f|0},_doFinalize:function(){var e=this._data,i=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;return i[r>>>5]|=128<<24-r%32,i[14+(r+64>>>9<<4)]=t.floor(n/4294967296),i[15+(r+64>>>9<<4)]=n,e.sigBytes=4*i.length,this._process(),this._hash},clone:function(){var t=r.clone.call(this);return t._hash=this._hash.clone(),t}});e.SHA256=r._createHelper(c),e.HmacSHA256=r._createHmacHelper(c)}(Math),void 0===YAHOO||!YAHOO)var YAHOO={};YAHOO.namespace=function(){var t,e,i,n=arguments,r=null;for(t=0;t<n.length;t+=1)for(i=(""+n[t]).split("."),r=YAHOO,e="YAHOO"==i[0]?1:0;e<i.length;e+=1)r[i[e]]=r[i[e]]||{},r=r[i[e]];return r},YAHOO.log=function(t,e,i){var n=YAHOO.widget.Logger;return!(!n||!n.log)&&n.log(t,e,i)},YAHOO.register=function(t,e,i){var n,r,s,o,a,h=YAHOO.env.modules;for(h[t]||(h[t]={versions:[],builds:[]}),n=h[t],r=i.version,s=i.build,o=YAHOO.env.listeners,n.name=t,n.version=r,n.build=s,n.versions.push(r),n.builds.push(s),n.mainClass=e,a=0;a<o.length;a+=1)o[a](n);e?(e.VERSION=r,e.BUILD=s):YAHOO.log("mainClass is undefined for module "+t,"warn")},YAHOO.env=YAHOO.env||{modules:[],listeners:[]},YAHOO.env.getVersion=function(t){return YAHOO.env.modules[t]||null},YAHOO.env.parseUA=function(t){var e,i=function(t){var e=0;return parseFloat(t.replace(/\./g,function(){return 1==e++?"":"."}))},n=navigator,r={ie:0,opera:0,gecko:0,webkit:0,chrome:0,mobile:null,air:0,ipad:0,iphone:0,ipod:0,ios:null,android:0,webos:0,caja:n&&n.cajaVersion,secure:!1,os:null},s=t||navigator&&navigator.userAgent,o=window&&window.location,a=o&&o.href;return r.secure=a&&0===a.toLowerCase().indexOf("https"),s&&(/windows|win32/i.test(s)?r.os="windows":/macintosh/i.test(s)?r.os="macintosh":/rhino/i.test(s)&&(r.os="rhino"),/KHTML/.test(s)&&(r.webkit=1),e=s.match(/AppleWebKit\/([^\s]*)/),e&&e[1]&&(r.webkit=i(e[1]),/ Mobile\//.test(s)?(r.mobile="Apple",e=s.match(/OS ([^\s]*)/),e&&e[1]&&(e=i(e[1].replace("_","."))),r.ios=e,r.ipad=r.ipod=r.iphone=0,(e=s.match(/iPad|iPod|iPhone/))&&e[0]&&(r[e[0].toLowerCase()]=r.ios)):(e=s.match(/NokiaN[^\/]*|Android \d\.\d|webOS\/\d\.\d/),e&&(r.mobile=e[0]),/webOS/.test(s)&&(r.mobile="WebOS",(e=s.match(/webOS\/([^\s]*);/))&&e[1]&&(r.webos=i(e[1]))),/ Android/.test(s)&&(r.mobile="Android",(e=s.match(/Android ([^\s]*);/))&&e[1]&&(r.android=i(e[1])))),e=s.match(/Chrome\/([^\s]*)/),e&&e[1]?r.chrome=i(e[1]):(e=s.match(/AdobeAIR\/([^\s]*)/))&&(r.air=e[0])),r.webkit||(e=s.match(/Opera[\s\/]([^\s]*)/),e&&e[1]?(r.opera=i(e[1]),e=s.match(/Version\/([^\s]*)/),e&&e[1]&&(r.opera=i(e[1])),(e=s.match(/Opera Mini[^;]*/))&&(r.mobile=e[0])):(e=s.match(/MSIE\s([^;]*)/),e&&e[1]?r.ie=i(e[1]):(e=s.match(/Gecko\/([^\s]*)/))&&(r.gecko=1,(e=s.match(/rv:([^\s\)]*)/))&&e[1]&&(r.gecko=i(e[1])))))),r},YAHOO.env.ua=YAHOO.env.parseUA(),function(){if(YAHOO.namespace("util","widget","example"),"undefined"!=typeof YAHOO_config){var t,e=YAHOO_config.listener,i=YAHOO.env.listeners,n=!0;if(e){for(t=0;t<i.length;t++)if(i[t]==e){n=!1;break}n&&i.push(e)}}}(),YAHOO.lang=YAHOO.lang||{},function(){var t=YAHOO.lang,e=Object.prototype,i=[],n={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;","`":"&#x60;"},r=["toString","valueOf"],s={isArray:function(t){return"[object Array]"===e.toString.apply(t)},isBoolean:function(t){return"boolean"==typeof t},isFunction:function(t){return"function"==typeof t||"[object Function]"===e.toString.apply(t)},isNull:function(t){return null===t},isNumber:function(t){return"number"==typeof t&&isFinite(t)},isObject:function(e){return e&&("object"===(void 0===e?"undefined":_typeof(e))||t.isFunction(e))||!1},isString:function(t){return"string"==typeof t},isUndefined:function(t){return void 0===t},_IEEnumFix:YAHOO.env.ua.ie?function(i,n){var s,o,a;for(s=0;s<r.length;s+=1)o=r[s],a=n[o],t.isFunction(a)&&a!=e[o]&&(i[o]=a)}:function(){},escapeHTML:function(t){return t.replace(/[&<>"'\/`]/g,function(t){return n[t]})},extend:function(i,n,r){if(!n||!i)throw new Error("extend failed, please check that all dependencies are included.");var s,o=function(){};if(o.prototype=n.prototype,i.prototype=new o,i.prototype.constructor=i,i.superclass=n.prototype,n.prototype.constructor==e.constructor&&(n.prototype.constructor=n),r){for(s in r)t.hasOwnProperty(r,s)&&(i.prototype[s]=r[s]);t._IEEnumFix(i.prototype,r)}},augmentObject:function(e,i){if(!i||!e)throw new Error("Absorb failed, verify dependencies.");var n,r,s=arguments,o=s[2];if(o&&!0!==o)for(n=2;n<s.length;n+=1)e[s[n]]=i[s[n]];else{for(r in i)!o&&r in e||(e[r]=i[r]);t._IEEnumFix(e,i)}return e},augmentProto:function(e,i){if(!i||!e)throw new Error("Augment failed, verify dependencies.");var n,r=[e.prototype,i.prototype];for(n=2;n<arguments.length;n+=1)r.push(arguments[n]);return t.augmentObject.apply(this,r),e},dump:function(e,i){var n,r,s=[],o="{...}";if(!t.isObject(e))return e+"";if(e instanceof Date||"nodeType"in e&&"tagName"in e)return e;if(t.isFunction(e))return"f(){...}";if(i=t.isNumber(i)?i:3,t.isArray(e)){for(s.push("["),n=0,r=e.length;n<r;n+=1)t.isObject(e[n])?s.push(i>0?t.dump(e[n],i-1):o):s.push(e[n]),s.push(", ");s.length>1&&s.pop(),s.push("]")}else{s.push("{");for(n in e)t.hasOwnProperty(e,n)&&(s.push(n+" => "),t.isObject(e[n])?s.push(i>0?t.dump(e[n],i-1):o):s.push(e[n]),s.push(", "));s.length>1&&s.pop(),s.push("}")}return s.join("")},substitute:function(e,i,n,r){for(var s,o,a,h,c,u,l,f,p,g=[],d=e.length;!((s=e.lastIndexOf("{",d))<0)&&(o=e.indexOf("}",s),!(s+1>o));)l=e.substring(s+1,o),h=l,u=null,a=h.indexOf(" "),a>-1&&(u=h.substring(a+1),h=h.substring(0,a)),c=i[h],n&&(c=n(h,c,u)),t.isObject(c)?t.isArray(c)?c=t.dump(c,parseInt(u,10)):(u=u||"",f=u.indexOf("dump"),f>-1&&(u=u.substring(4)),p=c.toString(),c="[object Object]"===p||f>-1?t.dump(c,parseInt(u,10)):p):t.isString(c)||t.isNumber(c)||(c="~-"+g.length+"-~",g[g.length]=l),e=e.substring(0,s)+c+e.substring(o+1),!1===r&&(d=s-1);for(s=g.length-1;s>=0;s-=1)e=e.replace(new RegExp("~-"+s+"-~"),"{"+g[s]+"}","g");return e},trim:function(t){try{return t.replace(/^\s+|\s+$/g,"")}catch(e){return t}},merge:function(){var e,i={},n=arguments,r=n.length;for(e=0;e<r;e+=1)t.augmentObject(i,n[e],!0);return i},later:function(e,n,r,s,o){e=e||0,n=n||{};var a,h,c=r,u=s;if(t.isString(r)&&(c=n[r]),!c)throw new TypeError("method undefined");return t.isUndefined(s)||t.isArray(u)||(u=[s]),a=function(){c.apply(n,u||i)},h=o?setInterval(a,e):setTimeout(a,e),{interval:o,cancel:function(){this.interval?clearInterval(h):clearTimeout(h)}}},isValue:function(e){return t.isObject(e)||t.isString(e)||t.isNumber(e)||t.isBoolean(e)}};t.hasOwnProperty=e.hasOwnProperty?function(t,e){return t&&t.hasOwnProperty&&t.hasOwnProperty(e)}:function(e,i){return!t.isUndefined(e[i])&&e.constructor.prototype[i]!==e[i]},s.augmentObject(t,s,!0),YAHOO.util.Lang=t,t.augment=t.augmentProto,YAHOO.augment=t.augmentProto,YAHOO.extend=t.extend}(),YAHOO.register("yahoo",YAHOO,{version:"2.9.0",build:"2800"});var dbits,canary=0xdeadbeefcafe,j_lm=15715070==(16777215&canary);j_lm&&"Microsoft Internet Explorer"==navigator.appName?(BigInteger.prototype.am=am2,dbits=30):j_lm&&"Netscape"!=navigator.appName?(BigInteger.prototype.am=am1,dbits=26):(BigInteger.prototype.am=am3,dbits=28),BigInteger.prototype.DB=dbits,BigInteger.prototype.DM=(1<<dbits)-1,BigInteger.prototype.DV=1<<dbits;var BI_FP=52;BigInteger.prototype.FV=Math.pow(2,BI_FP),BigInteger.prototype.F1=BI_FP-dbits,BigInteger.prototype.F2=2*dbits-BI_FP;var BI_RM="0123456789abcdefghijklmnopqrstuvwxyz",BI_RC=new Array,rr,vv;for(rr="0".charCodeAt(0),vv=0;vv<=9;++vv)BI_RC[rr++]=vv;for(rr="a".charCodeAt(0),vv=10;vv<36;++vv)BI_RC[rr++]=vv;for(rr="A".charCodeAt(0),vv=10;vv<36;++vv)BI_RC[rr++]=vv;Classic.prototype.convert=cConvert,Classic.prototype.revert=cRevert,Classic.prototype.reduce=cReduce,Classic.prototype.mulTo=cMulTo,Classic.prototype.sqrTo=cSqrTo,Montgomery.prototype.convert=montConvert,Montgomery.prototype.revert=montRevert,Montgomery.prototype.reduce=montReduce,Montgomery.prototype.mulTo=montMulTo,Montgomery.prototype.sqrTo=montSqrTo,BigInteger.prototype.copyTo=bnpCopyTo,BigInteger.prototype.fromInt=bnpFromInt,BigInteger.prototype.fromString=bnpFromString,BigInteger.prototype.clamp=bnpClamp,BigInteger.prototype.dlShiftTo=bnpDLShiftTo,BigInteger.prototype.drShiftTo=bnpDRShiftTo,BigInteger.prototype.lShiftTo=bnpLShiftTo,BigInteger.prototype.rShiftTo=bnpRShiftTo,BigInteger.prototype.subTo=bnpSubTo,BigInteger.prototype.multiplyTo=bnpMultiplyTo,BigInteger.prototype.squareTo=bnpSquareTo,BigInteger.prototype.divRemTo=bnpDivRemTo,BigInteger.prototype.invDigit=bnpInvDigit,BigInteger.prototype.isEven=bnpIsEven,BigInteger.prototype.exp=bnpExp,BigInteger.prototype.toString=bnToString,BigInteger.prototype.negate=bnNegate,BigInteger.prototype.abs=bnAbs,BigInteger.prototype.compareTo=bnCompareTo,BigInteger.prototype.bitLength=bnBitLength,BigInteger.prototype.mod=bnMod,BigInteger.prototype.modPowInt=bnModPowInt,BigInteger.ZERO=nbv(0),BigInteger.ONE=nbv(1),NullExp.prototype.convert=nNop,NullExp.prototype.revert=nNop,NullExp.prototype.mulTo=nMulTo,NullExp.prototype.sqrTo=nSqrTo,Barrett.prototype.convert=barrettConvert,Barrett.prototype.revert=barrettRevert,Barrett.prototype.reduce=barrettReduce,Barrett.prototype.mulTo=barrettMulTo,Barrett.prototype.sqrTo=barrettSqrTo;var lowprimes=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],lplim=(1<<26)/lowprimes[lowprimes.length-1];BigInteger.prototype.chunkSize=bnpChunkSize,BigInteger.prototype.toRadix=bnpToRadix,BigInteger.prototype.fromRadix=bnpFromRadix,BigInteger.prototype.fromNumber=bnpFromNumber,BigInteger.prototype.bitwiseTo=bnpBitwiseTo,BigInteger.prototype.changeBit=bnpChangeBit,BigInteger.prototype.addTo=bnpAddTo,BigInteger.prototype.dMultiply=bnpDMultiply,BigInteger.prototype.dAddOffset=bnpDAddOffset,BigInteger.prototype.multiplyLowerTo=bnpMultiplyLowerTo,BigInteger.prototype.multiplyUpperTo=bnpMultiplyUpperTo,BigInteger.prototype.modInt=bnpModInt,BigInteger.prototype.millerRabin=bnpMillerRabin,BigInteger.prototype.clone=bnClone,BigInteger.prototype.intValue=bnIntValue,BigInteger.prototype.byteValue=bnByteValue,BigInteger.prototype.shortValue=bnShortValue,BigInteger.prototype.signum=bnSigNum,BigInteger.prototype.toByteArray=bnToByteArray,BigInteger.prototype.equals=bnEquals,BigInteger.prototype.min=bnMin,BigInteger.prototype.max=bnMax,BigInteger.prototype.and=bnAnd,BigInteger.prototype.or=bnOr,BigInteger.prototype.xor=bnXor,BigInteger.prototype.andNot=bnAndNot,BigInteger.prototype.not=bnNot,BigInteger.prototype.shiftLeft=bnShiftLeft,BigInteger.prototype.shiftRight=bnShiftRight,BigInteger.prototype.getLowestSetBit=bnGetLowestSetBit,BigInteger.prototype.bitCount=bnBitCount,BigInteger.prototype.testBit=bnTestBit,BigInteger.prototype.setBit=bnSetBit,BigInteger.prototype.clearBit=bnClearBit,BigInteger.prototype.flipBit=bnFlipBit,BigInteger.prototype.add=bnAdd,BigInteger.prototype.subtract=bnSubtract,BigInteger.prototype.multiply=bnMultiply,BigInteger.prototype.divide=bnDivide,BigInteger.prototype.remainder=bnRemainder,BigInteger.prototype.divideAndRemainder=bnDivideAndRemainder,BigInteger.prototype.modPow=bnModPow,BigInteger.prototype.modInverse=bnModInverse,BigInteger.prototype.pow=bnPow,BigInteger.prototype.gcd=bnGCD,BigInteger.prototype.isProbablePrime=bnIsProbablePrime,BigInteger.prototype.square=bnSquare,Arcfour.prototype.init=ARC4init,Arcfour.prototype.next=ARC4next;var rng_psize=256,rng_state,rng_pool,rng_pptr;if(null==rng_pool){rng_pool=new Array,rng_pptr=0;var t;if("Netscape"==navigator.appName&&navigator.appVersion<"5"&&window.crypto){var z=window.crypto.random(32);for(t=0;t<z.length;++t)rng_pool[rng_pptr++]=255&z.charCodeAt(t)}for(;rng_pptr<rng_psize;)t=Math.floor(65536*Math.random()),rng_pool[rng_pptr++]=t>>>8,rng_pool[rng_pptr++]=255&t;rng_pptr=0,rng_seed_time()}SecureRandom.prototype.nextBytes=rng_get_bytes;var b64map="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",b64pad="=",ASN1HEX=new function(){this.getByteLengthOfL_AtObj=function(t,e){if("8"!=t.substring(e+2,e+3))return 1;var i=parseInt(t.substring(e+3,e+4));return 0==i?-1:0<i&&i<10?i+1:-2},this.getHexOfL_AtObj=function(t,e){var i=this.getByteLengthOfL_AtObj(t,e);return i<1?"":t.substring(e+2,e+2+2*i)},this.getIntOfL_AtObj=function(t,e){var i=this.getHexOfL_AtObj(t,e);if(""==i)return-1;var n;return n=parseInt(i.substring(0,1))<8?new BigInteger(i,16):new BigInteger(i.substring(2),16),n.intValue()},this.getStartPosOfV_AtObj=function(t,e){var i=this.getByteLengthOfL_AtObj(t,e);return i<0?i:e+2*(i+1)},this.getHexOfV_AtObj=function(t,e){var i=this.getStartPosOfV_AtObj(t,e),n=this.getIntOfL_AtObj(t,e);return t.substring(i,i+2*n)},this.getHexOfTLV_AtObj=function(t,e){return t.substr(e,2)+this.getHexOfL_AtObj(t,e)+this.getHexOfV_AtObj(t,e)},this.getPosOfNextSibling_AtObj=function(t,e){return this.getStartPosOfV_AtObj(t,e)+2*this.getIntOfL_AtObj(t,e)},this.getPosArrayOfChildren_AtObj=function(t,e){var i=new Array,n=this.getStartPosOfV_AtObj(t,e);i.push(n);for(var r=this.getIntOfL_AtObj(t,e),s=n,o=0;;){var a=this.getPosOfNextSibling_AtObj(t,s);if(null==a||a-n>=2*r)break;if(o>=200)break;i.push(a),s=a,o++}return i},this.getNthChildIndex_AtObj=function(t,e,i){return this.getPosArrayOfChildren_AtObj(t,e)[i]},this.getDecendantIndexByNthList=function(t,e,i){if(0==i.length)return e;var n=i.shift(),r=this.getPosArrayOfChildren_AtObj(t,e);return this.getDecendantIndexByNthList(t,r[n],i)},this.getDecendantHexTLVByNthList=function(t,e,i){var n=this.getDecendantIndexByNthList(t,e,i);return this.getHexOfTLV_AtObj(t,n)},this.getDecendantHexVByNthList=function(t,e,i){var n=this.getDecendantIndexByNthList(t,e,i);return this.getHexOfV_AtObj(t,n)}};ASN1HEX.getVbyList=function(t,e,i,n){var r=this.getDecendantIndexByNthList(t,e,i);if(void 0===r)throw"can't find nthList object";if(void 0!==n&&t.substr(r,2)!=n)throw"checking tag doesn't match: "+t.substr(r,2)+"!="+n;return this.getHexOfV_AtObj(t,r)},X509.pemToBase64=function(t){var e=t;return e=e.replace("-----BEGIN CERTIFICATE-----",""),e=e.replace("-----END CERTIFICATE-----",""),e=e.replace(/[ \n]+/g,"")},X509.pemToHex=function(t){return b64tohex(X509.pemToBase64(t))},X509.getSubjectPublicKeyPosFromCertHex=function(t){var e=X509.getSubjectPublicKeyInfoPosFromCertHex(t);if(-1==e)return-1;var i=ASN1HEX.getPosArrayOfChildren_AtObj(t,e);if(2!=i.length)return-1;var n=i[1];if("03"!=t.substring(n,n+2))return-1;var r=ASN1HEX.getStartPosOfV_AtObj(t,n);return"00"!=t.substring(r,r+2)?-1:r+2},X509.getSubjectPublicKeyInfoPosFromCertHex=function(t){var e=ASN1HEX.getStartPosOfV_AtObj(t,0),i=ASN1HEX.getPosArrayOfChildren_AtObj(t,e);return i.length<1?-1:"a003020102"==t.substring(i[0],i[0]+10)?i.length<6?-1:i[6]:i.length<5?-1:i[5]},X509.getPublicKeyHexArrayFromCertHex=function(t){var e=X509.getSubjectPublicKeyPosFromCertHex(t),i=ASN1HEX.getPosArrayOfChildren_AtObj(t,e);if(2!=i.length)return[];var n=ASN1HEX.getHexOfV_AtObj(t,i[0]),r=ASN1HEX.getHexOfV_AtObj(t,i[1]);return null!=n&&null!=r?[n,r]:[]},X509.getHexTbsCertificateFromCert=function(t){return ASN1HEX.getStartPosOfV_AtObj(t,0)},X509.getPublicKeyHexArrayFromCertPEM=function(t){var e=X509.pemToHex(t);return X509.getPublicKeyHexArrayFromCertHex(e)},X509.hex2dn=function(t){for(var e="",i=ASN1HEX.getPosArrayOfChildren_AtObj(t,0),n=0;n<i.length;n++){var r=ASN1HEX.getHexOfTLV_AtObj(t,i[n]);e=e+"/"+X509.hex2rdn(r)}return e},X509.hex2rdn=function(t){var e=ASN1HEX.getDecendantHexTLVByNthList(t,0,[0,0]),i=ASN1HEX.getDecendantHexVByNthList(t,0,[0,1]),n="";try{n=X509.DN_ATTRHEX[e]}catch(t){n=e}i=i.replace(/(..)/g,"%$1");var r=decodeURIComponent(i);return n+"="+r},X509.DN_ATTRHEX={"0603550406":"C","060355040a":"O","060355040b":"OU","0603550403":"CN","0603550405":"SN","0603550408":"ST","0603550407":"L"},X509.getPublicKeyFromCertPEM=function(t){var e=X509.getPublicKeyInfoPropOfCertPEM(t);if("2a864886f70d010101"==e.algoid){var i=KEYUTIL.parsePublicRawRSAKeyHex(e.keyhex),n=new RSAKey;return n.setPublic(i.n,i.e),n}if("2a8648ce3d0201"==e.algoid){var r=KJUR.crypto.OID.oidhex2name[e.algparam],n=new KJUR.crypto.ECDSA({curve:r,info:e.keyhex});return n.setPublicKeyHex(e.keyhex),n}if("2a8648ce380401"==e.algoid){var s=ASN1HEX.getVbyList(e.algparam,0,[0],"02"),o=ASN1HEX.getVbyList(e.algparam,0,[1],"02"),a=ASN1HEX.getVbyList(e.algparam,0,[2],"02"),h=ASN1HEX.getHexOfV_AtObj(e.keyhex,0);h=h.substr(2);var n=new KJUR.crypto.DSA;return n.setPublic(new BigInteger(s,16),new BigInteger(o,16),new BigInteger(a,16),new BigInteger(h,16)),n}throw"unsupported key"},X509.getPublicKeyInfoPropOfCertPEM=function(t){var e={};e.algparam=null;var i=X509.pemToHex(t),n=ASN1HEX.getPosArrayOfChildren_AtObj(i,0);if(3!=n.length)throw"malformed X.509 certificate PEM (code:001)";if("30"!=i.substr(n[0],2))throw"malformed X.509 certificate PEM (code:002)";var r=ASN1HEX.getPosArrayOfChildren_AtObj(i,n[0]);if(r.length<7)throw"malformed X.509 certificate PEM (code:003)";var s=ASN1HEX.getPosArrayOfChildren_AtObj(i,r[6]);if(2!=s.length)throw"malformed X.509 certificate PEM (code:004)";var o=ASN1HEX.getPosArrayOfChildren_AtObj(i,s[0]);if(2!=o.length)throw"malformed X.509 certificate PEM (code:005)";if(e.algoid=ASN1HEX.getHexOfV_AtObj(i,o[0]),"06"==i.substr(o[1],2)?e.algparam=ASN1HEX.getHexOfV_AtObj(i,o[1]):"30"==i.substr(o[1],2)&&(e.algparam=ASN1HEX.getHexOfTLV_AtObj(i,o[1])),"03"!=i.substr(s[1],2))throw"malformed X.509 certificate PEM (code:006)";var a=ASN1HEX.getHexOfV_AtObj(i,s[1]);return e.keyhex=a.substr(2),e};var PKCS5PKEY=function(){var t=function(t,e,n){return i(CryptoJS.AES,t,e,n)},e=function(t,e,n){return i(CryptoJS.TripleDES,t,e,n)},i=function(t,e,i,n){var r=CryptoJS.enc.Hex.parse(e),s=CryptoJS.enc.Hex.parse(i),o=CryptoJS.enc.Hex.parse(n),a={};a.key=s,a.iv=o,a.ciphertext=r;var h=t.decrypt(a,s,{iv:o});return CryptoJS.enc.Hex.stringify(h)},n=function(t,e,i){return s(CryptoJS.AES,t,e,i)},r=function(t,e,i){return s(CryptoJS.TripleDES,t,e,i)},s=function(t,e,i,n){var r=CryptoJS.enc.Hex.parse(e),s=CryptoJS.enc.Hex.parse(i),o=CryptoJS.enc.Hex.parse(n),a=t.encrypt(r,s,{iv:o}),h=CryptoJS.enc.Hex.parse(a.toString());return CryptoJS.enc.Base64.stringify(h)},o={"AES-256-CBC":{proc:t,eproc:n,keylen:32,ivlen:16},"AES-192-CBC":{proc:t,eproc:n,keylen:24,ivlen:16},"AES-128-CBC":{proc:t,eproc:n,keylen:16,ivlen:16},"DES-EDE3-CBC":{proc:e,eproc:r,keylen:24,ivlen:8}},a=function(t){return o[t].proc},h=function(t){var e=CryptoJS.lib.WordArray.random(t);return CryptoJS.enc.Hex.stringify(e)},c=function(t){var e={};t.match(new RegExp("DEK-Info: ([^,]+),([0-9A-Fa-f]+)","m"))&&(e.cipher=RegExp.$1,e.ivsalt=RegExp.$2),t.match(new RegExp("-----BEGIN ([A-Z]+) PRIVATE KEY-----"))&&(e.type=RegExp.$1);var i=-1,n=0;-1!=t.indexOf("\r\n\r\n")&&(i=t.indexOf("\r\n\r\n"),n=2),-1!=t.indexOf("\n\n")&&(i=t.indexOf("\n\n"),n=1);var r=t.indexOf("-----END");if(-1!=i&&-1!=r){var s=t.substring(i+2*n,r-n);s=s.replace(/\s+/g,""),e.data=s}return e},u=function(t,e,i){for(var n=i.substring(0,16),r=CryptoJS.enc.Hex.parse(n),s=CryptoJS.enc.Utf8.parse(e),a=o[t].keylen+o[t].ivlen,h="",c=null;;){var u=CryptoJS.algo.MD5.create();if(null!=c&&u.update(c),u.update(s),u.update(r),c=u.finalize(),h+=CryptoJS.enc.Hex.stringify(c),h.length>=2*a)break}var l={};return l.keyhex=h.substr(0,2*o[t].keylen),l.ivhex=h.substr(2*o[t].keylen,2*o[t].ivlen),l},l=function(t,e,i,n){var r=CryptoJS.enc.Base64.parse(t),s=CryptoJS.enc.Hex.stringify(r);return(0,o[e].proc)(s,i,n)},f=function(t,e,i,n){return(0,o[e].eproc)(t,i,n)};return{version:"1.0.5",getHexFromPEM:function(t,e){var i=t;if(-1==i.indexOf("BEGIN "+e))throw"can't find PEM header: "+e;return i=i.replace("-----BEGIN "+e+"-----",""),i=i.replace("-----END "+e+"-----",""),b64tohex(i.replace(/\s+/g,""))},getDecryptedKeyHexByKeyIV:function(t,e,i,n){return a(e)(t,i,n)},parsePKCS5PEM:function(t){return c(t)},getKeyAndUnusedIvByPasscodeAndIvsalt:function(t,e,i){return u(t,e,i)},decryptKeyB64:function(t,e,i,n){return l(t,e,i,n)},getDecryptedKeyHex:function(t,e){var i=c(t),n=(i.type,i.cipher),r=i.ivsalt,s=i.data,o=u(n,e,r),a=o.keyhex;return l(s,n,a,r)},getRSAKeyFromEncryptedPKCS5PEM:function(t,e){var i=this.getDecryptedKeyHex(t,e),n=new RSAKey;return n.readPrivateKeyFromASN1HexString(i),n},getEryptedPKCS5PEMFromPrvKeyHex:function(t,e,i,n){var r="";if(void 0!==i&&null!=i||(i="AES-256-CBC"),void 0===o[i])throw"PKCS5PKEY unsupported algorithm: "+i;if(void 0===n||null==n){var s=o[i].ivlen;n=h(s).toUpperCase()}var a=u(i,e,n),c=a.keyhex,l=f(t,i,c,n),p=l.replace(/(.{64})/g,"$1\r\n"),r="-----BEGIN RSA PRIVATE KEY-----\r\n";return r+="Proc-Type: 4,ENCRYPTED\r\n",r+="DEK-Info: "+i+","+n+"\r\n",r+="\r\n",r+=p,r+="\r\n-----END RSA PRIVATE KEY-----\r\n"},getEryptedPKCS5PEMFromRSAKey:function(t,e,i,n){var r=new KJUR.asn1.DERInteger({int:0}),s=new KJUR.asn1.DERInteger({bigint:t.n}),o=new KJUR.asn1.DERInteger({int:t.e}),a=new KJUR.asn1.DERInteger({bigint:t.d}),h=new KJUR.asn1.DERInteger({bigint:t.p}),c=new KJUR.asn1.DERInteger({bigint:t.q}),u=new KJUR.asn1.DERInteger({bigint:t.dmp1}),l=new KJUR.asn1.DERInteger({bigint:t.dmq1}),f=new KJUR.asn1.DERInteger({bigint:t.coeff}),p=new KJUR.asn1.DERSequence({array:[r,s,o,a,h,c,u,l,f]}),g=p.getEncodedHex();return this.getEryptedPKCS5PEMFromPrvKeyHex(g,e,i,n)},newEncryptedPKCS5PEM:function(t,e,i,n){void 0!==e&&null!=e||(e=1024),void 0!==i&&null!=i||(i="10001"),(new RSAKey).generate(e,i);return void 0===n||null==n?this.getEncryptedPKCS5PEMFromRSAKey(pkey,t):this.getEncryptedPKCS5PEMFromRSAKey(pkey,t,n)},getRSAKeyFromPlainPKCS8PEM:function(t){if(t.match(/ENCRYPTED/))throw"pem shall be not ENCRYPTED";var e=this.getHexFromPEM(t,"PRIVATE KEY");return this.getRSAKeyFromPlainPKCS8Hex(e)},getRSAKeyFromPlainPKCS8Hex:function(t){var e=ASN1HEX.getPosArrayOfChildren_AtObj(t,0);if(3!=e.length)throw"outer DERSequence shall have 3 elements: "+e.length;var i=ASN1HEX.getHexOfTLV_AtObj(t,e[1]);if("300d06092a864886f70d0101010500"!=i)throw"PKCS8 AlgorithmIdentifier is not rsaEnc: "+i;var i=ASN1HEX.getHexOfTLV_AtObj(t,e[1]),n=ASN1HEX.getHexOfTLV_AtObj(t,e[2]),r=ASN1HEX.getHexOfV_AtObj(n,0),s=new RSAKey;return s.readPrivateKeyFromASN1HexString(r),s},parseHexOfEncryptedPKCS8:function(t){var e={},i=ASN1HEX.getPosArrayOfChildren_AtObj(t,0);if(2!=i.length)throw"malformed format: SEQUENCE(0).items != 2: "+i.length;e.ciphertext=ASN1HEX.getHexOfV_AtObj(t,i[1]);var n=ASN1HEX.getPosArrayOfChildren_AtObj(t,i[0]);if(2!=n.length)throw"malformed format: SEQUENCE(0.0).items != 2: "+n.length;if("2a864886f70d01050d"!=ASN1HEX.getHexOfV_AtObj(t,n[0]))throw"this only supports pkcs5PBES2";var r=ASN1HEX.getPosArrayOfChildren_AtObj(t,n[1]);if(2!=n.length)throw"malformed format: SEQUENCE(0.0.1).items != 2: "+r.length;var s=ASN1HEX.getPosArrayOfChildren_AtObj(t,r[1]);if(2!=s.length)throw"malformed format: SEQUENCE(0.0.1.1).items != 2: "+s.length;if("2a864886f70d0307"!=ASN1HEX.getHexOfV_AtObj(t,s[0]))throw"this only supports TripleDES";e.encryptionSchemeAlg="TripleDES",e.encryptionSchemeIV=ASN1HEX.getHexOfV_AtObj(t,s[1]);var o=ASN1HEX.getPosArrayOfChildren_AtObj(t,r[0]);if(2!=o.length)throw"malformed format: SEQUENCE(0.0.1.0).items != 2: "+o.length;if("2a864886f70d01050c"!=ASN1HEX.getHexOfV_AtObj(t,o[0]))throw"this only supports pkcs5PBKDF2";var a=ASN1HEX.getPosArrayOfChildren_AtObj(t,o[1]);if(a.length<2)throw"malformed format: SEQUENCE(0.0.1.0.1).items < 2: "+a.length;e.pbkdf2Salt=ASN1HEX.getHexOfV_AtObj(t,a[0]);var h=ASN1HEX.getHexOfV_AtObj(t,a[1]);try{e.pbkdf2Iter=parseInt(h,16)}catch(t){throw"malformed format pbkdf2Iter: "+h}return e},getPBKDF2KeyHexFromParam:function(t,e){var i=CryptoJS.enc.Hex.parse(t.pbkdf2Salt),n=t.pbkdf2Iter,r=CryptoJS.PBKDF2(e,i,{keySize:6,iterations:n});return CryptoJS.enc.Hex.stringify(r)},getPlainPKCS8HexFromEncryptedPKCS8PEM:function(t,e){var i=this.getHexFromPEM(t,"ENCRYPTED PRIVATE KEY"),n=this.parseHexOfEncryptedPKCS8(i),r=PKCS5PKEY.getPBKDF2KeyHexFromParam(n,e),s={};s.ciphertext=CryptoJS.enc.Hex.parse(n.ciphertext);var o=CryptoJS.enc.Hex.parse(r),a=CryptoJS.enc.Hex.parse(n.encryptionSchemeIV),h=CryptoJS.TripleDES.decrypt(s,o,{iv:a});return CryptoJS.enc.Hex.stringify(h)},getRSAKeyFromEncryptedPKCS8PEM:function(t,e){var i=this.getPlainPKCS8HexFromEncryptedPKCS8PEM(t,e);return this.getRSAKeyFromPlainPKCS8Hex(i)},getKeyFromEncryptedPKCS8PEM:function(t,e){var i=this.getPlainPKCS8HexFromEncryptedPKCS8PEM(t,e);return this.getKeyFromPlainPrivatePKCS8Hex(i)},parsePlainPrivatePKCS8Hex:function(t){var e={};if(e.algparam=null,"30"!=t.substr(0,2))throw"malformed plain PKCS8 private key(code:001)";var i=ASN1HEX.getPosArrayOfChildren_AtObj(t,0);if(3!=i.length)throw"malformed plain PKCS8 private key(code:002)";if("30"!=t.substr(i[1],2))throw"malformed PKCS8 private key(code:003)";var n=ASN1HEX.getPosArrayOfChildren_AtObj(t,i[1]);if(2!=n.length)throw"malformed PKCS8 private key(code:004)";if("06"!=t.substr(n[0],2))throw"malformed PKCS8 private key(code:005)";if(e.algoid=ASN1HEX.getHexOfV_AtObj(t,n[0]),"06"==t.substr(n[1],2)&&(e.algparam=ASN1HEX.getHexOfV_AtObj(t,n[1])),"04"!=t.substr(i[2],2))throw"malformed PKCS8 private key(code:006)";return e.keyidx=ASN1HEX.getStartPosOfV_AtObj(t,i[2]),e},getKeyFromPlainPrivatePKCS8PEM:function(t){var e=this.getHexFromPEM(t,"PRIVATE KEY");return this.getKeyFromPlainPrivatePKCS8Hex(e)},getKeyFromPlainPrivatePKCS8Hex:function(t){var e=this.parsePlainPrivatePKCS8Hex(t);if("2a864886f70d010101"==e.algoid){this.parsePrivateRawRSAKeyHexAtObj(t,e);var i=e.key,n=new RSAKey;return n.setPrivateEx(i.n,i.e,i.d,i.p,i.q,i.dp,i.dq,i.co),n}if("2a8648ce3d0201"==e.algoid){if(this.parsePrivateRawECKeyHexAtObj(t,e),void 0===KJUR.crypto.OID.oidhex2name[e.algparam])throw"KJUR.crypto.OID.oidhex2name undefined: "+e.algparam;var r=KJUR.crypto.OID.oidhex2name[e.algparam],n=new KJUR.crypto.ECDSA({curve:r,prv:e.key});return n}throw"unsupported private key algorithm"},getRSAKeyFromPublicPKCS8PEM:function(t){var e=this.getHexFromPEM(t,"PUBLIC KEY");return this.getRSAKeyFromPublicPKCS8Hex(e)},getKeyFromPublicPKCS8PEM:function(t){var e=this.getHexFromPEM(t,"PUBLIC KEY");return this.getKeyFromPublicPKCS8Hex(e)},getKeyFromPublicPKCS8Hex:function(t){var e=this.parsePublicPKCS8Hex(t);if("2a864886f70d010101"==e.algoid){var i=this.parsePublicRawRSAKeyHex(e.key),n=new RSAKey;return n.setPublic(i.n,i.e),n}if("2a8648ce3d0201"==e.algoid){if(void 0===KJUR.crypto.OID.oidhex2name[e.algparam])throw"KJUR.crypto.OID.oidhex2name undefined: "+e.algparam;var r=KJUR.crypto.OID.oidhex2name[e.algparam],n=new KJUR.crypto.ECDSA({curve:r,pub:e.key});return n}throw"unsupported public key algorithm"},parsePublicRawRSAKeyHex:function(t){var e={};if("30"!=t.substr(0,2))throw"malformed RSA key(code:001)";var i=ASN1HEX.getPosArrayOfChildren_AtObj(t,0);if(2!=i.length)throw"malformed RSA key(code:002)";if("02"!=t.substr(i[0],2))throw"malformed RSA key(code:003)";if(e.n=ASN1HEX.getHexOfV_AtObj(t,i[0]),"02"!=t.substr(i[1],2))throw"malformed RSA key(code:004)";return e.e=ASN1HEX.getHexOfV_AtObj(t,i[1]),e},parsePrivateRawRSAKeyHexAtObj:function(t,e){var i=e.keyidx;if("30"!=t.substr(i,2))throw"malformed RSA private key(code:001)";var n=ASN1HEX.getPosArrayOfChildren_AtObj(t,i);if(9!=n.length)throw"malformed RSA private key(code:002)";e.key={},e.key.n=ASN1HEX.getHexOfV_AtObj(t,n[1]),e.key.e=ASN1HEX.getHexOfV_AtObj(t,n[2]),e.key.d=ASN1HEX.getHexOfV_AtObj(t,n[3]),e.key.p=ASN1HEX.getHexOfV_AtObj(t,n[4]),e.key.q=ASN1HEX.getHexOfV_AtObj(t,n[5]),e.key.dp=ASN1HEX.getHexOfV_AtObj(t,n[6]),e.key.dq=ASN1HEX.getHexOfV_AtObj(t,n[7]),e.key.co=ASN1HEX.getHexOfV_AtObj(t,n[8])},parsePrivateRawECKeyHexAtObj:function(t,e){var i=e.keyidx;if("30"!=t.substr(i,2))throw"malformed ECC private key(code:001)";var n=ASN1HEX.getPosArrayOfChildren_AtObj(t,i);if(3!=n.length)throw"malformed ECC private key(code:002)";if("04"!=t.substr(n[1],2))throw"malformed ECC private key(code:003)";e.key=ASN1HEX.getHexOfV_AtObj(t,n[1])},parsePublicPKCS8Hex:function(t){var e={};e.algparam=null;var i=ASN1HEX.getPosArrayOfChildren_AtObj(t,0);if(2!=i.length)throw"outer DERSequence shall have 2 elements: "+i.length;var n=i[0];if("30"!=t.substr(n,2))throw"malformed PKCS8 public key(code:001)";var r=ASN1HEX.getPosArrayOfChildren_AtObj(t,n);if(2!=r.length)throw"malformed PKCS8 public key(code:002)";if("06"!=t.substr(r[0],2))throw"malformed PKCS8 public key(code:003)";if(e.algoid=ASN1HEX.getHexOfV_AtObj(t,r[0]),"06"==t.substr(r[1],2)&&(e.algparam=ASN1HEX.getHexOfV_AtObj(t,r[1])),"03"!=t.substr(i[1],2))throw"malformed PKCS8 public key(code:004)";return e.key=ASN1HEX.getHexOfV_AtObj(t,i[1]).substr(2),e},getRSAKeyFromPublicPKCS8Hex:function(t){var e=ASN1HEX.getPosArrayOfChildren_AtObj(t,0);if(2!=e.length)throw"outer DERSequence shall have 2 elements: "+e.length;if("300d06092a864886f70d0101010500"!=ASN1HEX.getHexOfTLV_AtObj(t,e[0]))throw"PKCS8 AlgorithmId is not rsaEncryption";if("03"!=t.substr(e[1],2))throw"PKCS8 Public Key is not BITSTRING encapslated.";var i=ASN1HEX.getStartPosOfV_AtObj(t,e[1])+2;if("30"!=t.substr(i,2))throw"PKCS8 Public Key is not SEQUENCE.";var n=ASN1HEX.getPosArrayOfChildren_AtObj(t,i);if(2!=n.length)throw"inner DERSequence shall have 2 elements: "+n.length;if("02"!=t.substr(n[0],2))throw"N is not ASN.1 INTEGER";if("02"!=t.substr(n[1],2))throw"E is not ASN.1 INTEGER";var r=ASN1HEX.getHexOfV_AtObj(t,n[0]),s=ASN1HEX.getHexOfV_AtObj(t,n[1]),o=new RSAKey;return o.setPublic(r,s),o}}}(),KJUR;void 0!==KJUR&&KJUR||(KJUR={}),void 0!==KJUR.asn1&&KJUR.asn1||(KJUR.asn1={}),KJUR.asn1.ASN1Util=new function(){this.integerToByteHex=function(t){var e=t.toString(16);return e.length%2==1&&(e="0"+e),e},this.bigIntToMinTwosComplementsHex=function(t){var e=t.toString(16);if("-"!=e.substr(0,1))e.length%2==1?e="0"+e:e.match(/^[0-7]/)||(e="00"+e);else{var i=e.substr(1),n=i.length;n%2==1?n+=1:e.match(/^[0-7]/)||(n+=2);for(var r="",s=0;s<n;s++)r+="f";e=new BigInteger(r,16).xor(t).add(BigInteger.ONE).toString(16).replace(/^-/,"")}return e},this.getPEMStringFromHex=function(t,e){var i=(KJUR.asn1,CryptoJS.enc.Hex.parse(t)),n=CryptoJS.enc.Base64.stringify(i),r=n.replace(/(.{64})/g,"$1\r\n");return r=r.replace(/\r\n$/,""),"-----BEGIN "+e+"-----\r\n"+r+"\r\n-----END "+e+"-----\r\n"},this.newObject=function(t){var e=KJUR.asn1,i=Object.keys(t);if(1!=i.length)throw"key of param shall be only one.";var n=i[0];if(-1==":bool:int:bitstr:octstr:null:oid:utf8str:numstr:prnstr:telstr:ia5str:utctime:gentime:seq:set:tag:".indexOf(":"+n+":"))throw"undefined key: "+n;if("bool"==n)return new e.DERBoolean(t[n]);if("int"==n)return new e.DERInteger(t[n]);if("bitstr"==n)return new e.DERBitString(t[n]);if("octstr"==n)return new e.DEROctetString(t[n]);if("null"==n)return new e.DERNull(t[n]);if("oid"==n)return new e.DERObjectIdentifier(t[n]);if("utf8str"==n)return new e.DERUTF8String(t[n]);if("numstr"==n)return new e.DERNumericString(t[n]);if("prnstr"==n)return new e.DERPrintableString(t[n]);if("telstr"==n)return new e.DERTeletexString(t[n]);if("ia5str"==n)return new e.DERIA5String(t[n]);if("utctime"==n)return new e.DERUTCTime(t[n]);if("gentime"==n)return new e.DERGeneralizedTime(t[n]);if("seq"==n){for(var r=t[n],s=[],o=0;o<r.length;o++){var a=e.ASN1Util.newObject(r[o]);s.push(a)}return new e.DERSequence({array:s})}if("set"==n){for(var r=t[n],s=[],o=0;o<r.length;o++){var a=e.ASN1Util.newObject(r[o]);s.push(a)}return new e.DERSet({array:s})}if("tag"==n){var h=t[n];if("[object Array]"===Object.prototype.toString.call(h)&&3==h.length){var c=e.ASN1Util.newObject(h[2]);return new e.DERTaggedObject({tag:h[0],explicit:h[1],obj:c})}var u={};if(void 0!==h.explicit&&(u.explicit=h.explicit),void 0!==h.tag&&(u.tag=h.tag),void 0===h.obj)throw"obj shall be specified for 'tag'.";return u.obj=e.ASN1Util.newObject(h.obj),new e.DERTaggedObject(u)}},this.jsonToASN1HEX=function(t){return this.newObject(t).getEncodedHex()}},KJUR.asn1.ASN1Object=function(){this.getLengthHexFromValue=function(){if(void 0===this.hV||null==this.hV)throw"this.hV is null or undefined.";if(this.hV.length%2==1)throw"value hex must be even length: n="+"".length+",v="+this.hV;var t=this.hV.length/2,e=t.toString(16);if(e.length%2==1&&(e="0"+e),t<128)return e;var i=e.length/2;if(i>15)throw"ASN.1 length too long to represent by 8x: n = "+t.toString(16);return(128+i).toString(16)+e},this.getEncodedHex=function(){return(null==this.hTLV||this.isModified)&&(this.hV=this.getFreshValueHex(),this.hL=this.getLengthHexFromValue(),this.hTLV=this.hT+this.hL+this.hV,this.isModified=!1),this.hTLV},this.getValueHex=function(){return this.getEncodedHex(),this.hV},this.getFreshValueHex=function(){return""}},KJUR.asn1.DERAbstractString=function(t){KJUR.asn1.DERAbstractString.superclass.constructor.call(this);this.getString=function(){return this.s},this.setString=function(t){this.hTLV=null,this.isModified=!0,this.s=t,this.hV=stohex(this.s)},this.setStringHex=function(t){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=t},this.getFreshValueHex=function(){return this.hV},void 0!==t&&("string"==typeof t?this.setString(t):void 0!==t.str?this.setString(t.str):void 0!==t.hex&&this.setStringHex(t.hex))},YAHOO.lang.extend(KJUR.asn1.DERAbstractString,KJUR.asn1.ASN1Object),KJUR.asn1.DERAbstractTime=function(t){KJUR.asn1.DERAbstractTime.superclass.constructor.call(this);this.localDateToUTC=function(t){return utc=t.getTime()+6e4*t.getTimezoneOffset(),new Date(utc)},this.formatDate=function(t,e){var i=this.zeroPadding,n=this.localDateToUTC(t),r=String(n.getFullYear());return"utc"==e&&(r=r.substr(2,2)),r+i(String(n.getMonth()+1),2)+i(String(n.getDate()),2)+i(String(n.getHours()),2)+i(String(n.getMinutes()),2)+i(String(n.getSeconds()),2)+"Z"},this.zeroPadding=function(t,e){return t.length>=e?t:new Array(e-t.length+1).join("0")+t},this.getString=function(){return this.s},this.setString=function(t){this.hTLV=null,this.isModified=!0,this.s=t,this.hV=stohex(t)},this.setByDateValue=function(t,e,i,n,r,s){var o=new Date(Date.UTC(t,e-1,i,n,r,s,0));this.setByDate(o)},this.getFreshValueHex=function(){return this.hV}},YAHOO.lang.extend(KJUR.asn1.DERAbstractTime,KJUR.asn1.ASN1Object),KJUR.asn1.DERAbstractStructured=function(t){KJUR.asn1.DERAbstractString.superclass.constructor.call(this);this.setByASN1ObjectArray=function(t){this.hTLV=null,this.isModified=!0,this.asn1Array=t},this.appendASN1Object=function(t){this.hTLV=null,this.isModified=!0,this.asn1Array.push(t)},this.asn1Array=new Array,void 0!==t&&void 0!==t.array&&(this.asn1Array=t.array)},YAHOO.lang.extend(KJUR.asn1.DERAbstractStructured,KJUR.asn1.ASN1Object),KJUR.asn1.DERBoolean=function(){KJUR.asn1.DERBoolean.superclass.constructor.call(this),this.hT="01",this.hTLV="0101ff"},YAHOO.lang.extend(KJUR.asn1.DERBoolean,KJUR.asn1.ASN1Object),KJUR.asn1.DERInteger=function(t){KJUR.asn1.DERInteger.superclass.constructor.call(this),this.hT="02",this.setByBigInteger=function(t){this.hTLV=null,this.isModified=!0,this.hV=KJUR.asn1.ASN1Util.bigIntToMinTwosComplementsHex(t)},this.setByInteger=function(t){var e=new BigInteger(String(t),10);this.setByBigInteger(e)},this.setValueHex=function(t){this.hV=t},this.getFreshValueHex=function(){return this.hV},void 0!==t&&(void 0!==t.bigint?this.setByBigInteger(t.bigint):void 0!==t.int?this.setByInteger(t.int):"number"==typeof t?this.setByInteger(t):void 0!==t.hex&&this.setValueHex(t.hex))},YAHOO.lang.extend(KJUR.asn1.DERInteger,KJUR.asn1.ASN1Object),KJUR.asn1.DERBitString=function(t){KJUR.asn1.DERBitString.superclass.constructor.call(this),this.hT="03",this.setHexValueIncludingUnusedBits=function(t){this.hTLV=null,this.isModified=!0,this.hV=t},this.setUnusedBitsAndHexValue=function(t,e){if(t<0||7<t)throw"unused bits shall be from 0 to 7: u = "+t;var i="0"+t;this.hTLV=null,this.isModified=!0,this.hV=i+e},this.setByBinaryString=function(t){t=t.replace(/0+$/,"");var e=8-t.length%8;8==e&&(e=0);for(var i=0;i<=e;i++)t+="0";for(var n="",i=0;i<t.length-1;i+=8){var r=t.substr(i,8),s=parseInt(r,2).toString(16);1==s.length&&(s="0"+s),n+=s}this.hTLV=null,this.isModified=!0,this.hV="0"+e+n},this.setByBooleanArray=function(t){for(var e="",i=0;i<t.length;i++)1==t[i]?e+="1":e+="0";this.setByBinaryString(e)},this.newFalseArray=function(t){for(var e=new Array(t),i=0;i<t;i++)e[i]=!1;return e},this.getFreshValueHex=function(){return this.hV},void 0!==t&&("string"==typeof t&&t.toLowerCase().match(/^[0-9a-f]+$/)?this.setHexValueIncludingUnusedBits(t):void 0!==t.hex?this.setHexValueIncludingUnusedBits(t.hex):void 0!==t.bin?this.setByBinaryString(t.bin):void 0!==t.array&&this.setByBooleanArray(t.array))},YAHOO.lang.extend(KJUR.asn1.DERBitString,KJUR.asn1.ASN1Object),KJUR.asn1.DEROctetString=function(t){KJUR.asn1.DEROctetString.superclass.constructor.call(this,t),this.hT="04"},YAHOO.lang.extend(KJUR.asn1.DEROctetString,KJUR.asn1.DERAbstractString),KJUR.asn1.DERNull=function(){KJUR.asn1.DERNull.superclass.constructor.call(this),this.hT="05",this.hTLV="0500"},YAHOO.lang.extend(KJUR.asn1.DERNull,KJUR.asn1.ASN1Object),KJUR.asn1.DERObjectIdentifier=function(t){var e=function(t){var e=t.toString(16);return 1==e.length&&(e="0"+e),e},i=function(t){var i="",n=new BigInteger(t,10),r=n.toString(2),s=7-r.length%7;7==s&&(s=0);for(var o="",a=0;a<s;a++)o+="0";r=o+r;for(var a=0;a<r.length-1;a+=7){var h=r.substr(a,7);a!=r.length-7&&(h="1"+h),i+=e(parseInt(h,2))}return i};KJUR.asn1.DERObjectIdentifier.superclass.constructor.call(this),this.hT="06",this.setValueHex=function(t){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=t},this.setValueOidString=function(t){if(!t.match(/^[0-9.]+$/))throw"malformed oid string: "+t;var n="",r=t.split("."),s=40*parseInt(r[0])+parseInt(r[1]);n+=e(s),r.splice(0,2);for(var o=0;o<r.length;o++)n+=i(r[o]);this.hTLV=null,this.isModified=!0,this.s=null,this.hV=n},this.setValueName=function(t){if(void 0===KJUR.asn1.x509.OID.name2oidList[t])throw"DERObjectIdentifier oidName undefined: "+t;var e=KJUR.asn1.x509.OID.name2oidList[t];this.setValueOidString(e)},this.getFreshValueHex=function(){return this.hV},void 0!==t&&("string"==typeof t&&t.match(/^[0-2].[0-9.]+$/)?this.setValueOidString(t):void 0!==KJUR.asn1.x509.OID.name2oidList[t]?this.setValueOidString(KJUR.asn1.x509.OID.name2oidList[t]):void 0!==t.oid?this.setValueOidString(t.oid):void 0!==t.hex?this.setValueHex(t.hex):void 0!==t.name&&this.setValueName(t.name))},YAHOO.lang.extend(KJUR.asn1.DERObjectIdentifier,KJUR.asn1.ASN1Object),KJUR.asn1.DERUTF8String=function(t){KJUR.asn1.DERUTF8String.superclass.constructor.call(this,t),this.hT="0c"},YAHOO.lang.extend(KJUR.asn1.DERUTF8String,KJUR.asn1.DERAbstractString),KJUR.asn1.DERNumericString=function(t){KJUR.asn1.DERNumericString.superclass.constructor.call(this,t),this.hT="12"},YAHOO.lang.extend(KJUR.asn1.DERNumericString,KJUR.asn1.DERAbstractString),KJUR.asn1.DERPrintableString=function(t){KJUR.asn1.DERPrintableString.superclass.constructor.call(this,t),this.hT="13"},YAHOO.lang.extend(KJUR.asn1.DERPrintableString,KJUR.asn1.DERAbstractString),KJUR.asn1.DERTeletexString=function(t){KJUR.asn1.DERTeletexString.superclass.constructor.call(this,t),this.hT="14"},YAHOO.lang.extend(KJUR.asn1.DERTeletexString,KJUR.asn1.DERAbstractString),KJUR.asn1.DERIA5String=function(t){KJUR.asn1.DERIA5String.superclass.constructor.call(this,t),this.hT="16"},YAHOO.lang.extend(KJUR.asn1.DERIA5String,KJUR.asn1.DERAbstractString),KJUR.asn1.DERUTCTime=function(t){KJUR.asn1.DERUTCTime.superclass.constructor.call(this,t),this.hT="17",this.setByDate=function(t){this.hTLV=null,this.isModified=!0,this.date=t,this.s=this.formatDate(this.date,"utc"),this.hV=stohex(this.s)},void 0!==t&&(void 0!==t.str?this.setString(t.str):"string"==typeof t&&t.match(/^[0-9]{12}Z$/)?this.setString(t):void 0!==t.hex?this.setStringHex(t.hex):void 0!==t.date&&this.setByDate(t.date))},YAHOO.lang.extend(KJUR.asn1.DERUTCTime,KJUR.asn1.DERAbstractTime),KJUR.asn1.DERGeneralizedTime=function(t){KJUR.asn1.DERGeneralizedTime.superclass.constructor.call(this,t),this.hT="18",this.setByDate=function(t){this.hTLV=null,this.isModified=!0,this.date=t,this.s=this.formatDate(this.date,"gen"),this.hV=stohex(this.s)},void 0!==t&&(void 0!==t.str?this.setString(t.str):"string"==typeof t&&t.match(/^[0-9]{14}Z$/)?this.setString(t):void 0!==t.hex?this.setStringHex(t.hex):void 0!==t.date&&this.setByDate(t.date))},YAHOO.lang.extend(KJUR.asn1.DERGeneralizedTime,KJUR.asn1.DERAbstractTime),KJUR.asn1.DERSequence=function(t){KJUR.asn1.DERSequence.superclass.constructor.call(this,t),this.hT="30",this.getFreshValueHex=function(){for(var t="",e=0;e<this.asn1Array.length;e++){t+=this.asn1Array[e].getEncodedHex()}return this.hV=t,this.hV}},YAHOO.lang.extend(KJUR.asn1.DERSequence,KJUR.asn1.DERAbstractStructured),KJUR.asn1.DERSet=function(t){KJUR.asn1.DERSet.superclass.constructor.call(this,t),this.hT="31",this.getFreshValueHex=function(){for(var t=new Array,e=0;e<this.asn1Array.length;e++){var i=this.asn1Array[e];t.push(i.getEncodedHex())}return t.sort(),this.hV=t.join(""),this.hV}},YAHOO.lang.extend(KJUR.asn1.DERSet,KJUR.asn1.DERAbstractStructured),KJUR.asn1.DERTaggedObject=function(t){KJUR.asn1.DERTaggedObject.superclass.constructor.call(this),this.hT="a0",this.hV="",this.isExplicit=!0,this.asn1Object=null,this.setASN1Object=function(t,e,i){this.hT=e,this.isExplicit=t,this.asn1Object=i,this.isExplicit?(this.hV=this.asn1Object.getEncodedHex(),this.hTLV=null,this.isModified=!0):(this.hV=null,this.hTLV=i.getEncodedHex(),this.hTLV=this.hTLV.replace(/^../,e),this.isModified=!1)},this.getFreshValueHex=function(){return this.hV},void 0!==t&&(void 0!==t.tag&&(this.hT=t.tag),void 0!==t.explicit&&(this.isExplicit=t.explicit),void 0!==t.obj&&(this.asn1Object=t.obj,this.setASN1Object(this.isExplicit,this.hT,this.asn1Object)))},YAHOO.lang.extend(KJUR.asn1.DERTaggedObject,KJUR.asn1.ASN1Object),void 0!==KJUR&&KJUR||(KJUR={}),void 0!==KJUR.asn1&&KJUR.asn1||(KJUR.asn1={}),void 0!==KJUR.asn1.x509&&KJUR.asn1.x509||(KJUR.asn1.x509={}),KJUR.asn1.x509.Certificate=function(t){KJUR.asn1.x509.Certificate.superclass.constructor.call(this);this.setRsaPrvKeyByPEMandPass=function(t,e){var i=PKCS5PKEY.getDecryptedKeyHex(t,e),n=new RSAKey;n.readPrivateKeyFromASN1HexString(i),this.prvKey=n},this.sign=function(){this.asn1SignatureAlg=this.asn1TBSCert.asn1SignatureAlg,sig=new KJUR.crypto.Signature({alg:"SHA1withRSA"}),sig.init(this.prvKey),sig.updateHex(this.asn1TBSCert.getEncodedHex()),this.hexSig=sig.sign(),this.asn1Sig=new KJUR.asn1.DERBitString({hex:"00"+this.hexSig});var t=new KJUR.asn1.DERSequence({array:[this.asn1TBSCert,this.asn1SignatureAlg,this.asn1Sig]});this.hTLV=t.getEncodedHex(),this.isModified=!1},this.getEncodedHex=function(){if(0==this.isModified&&null!=this.hTLV)return this.hTLV;throw"not signed yet"},this.getPEMString=function(){var t=this.getEncodedHex(),e=CryptoJS.enc.Hex.parse(t);return"-----BEGIN CERTIFICATE-----\r\n"+CryptoJS.enc.Base64.stringify(e).replace(/(.{64})/g,"$1\r\n")+"\r\n-----END CERTIFICATE-----\r\n"},void 0!==t&&(void 0!==t.tbscertobj&&(this.asn1TBSCert=t.tbscertobj),void 0!==t.prvkeyobj?this.prvKey=t.prvkeyobj:void 0!==t.rsaprvkey?this.prvKey=t.rsaprvkey:void 0!==t.rsaprvpem&&void 0!==t.rsaprvpas&&this.setRsaPrvKeyByPEMandPass(t.rsaprvpem,t.rsaprvpas))},YAHOO.lang.extend(KJUR.asn1.x509.Certificate,KJUR.asn1.ASN1Object),KJUR.asn1.x509.TBSCertificate=function(t){KJUR.asn1.x509.TBSCertificate.superclass.constructor.call(this),this._initialize=function(){this.asn1Array=new Array,this.asn1Version=new KJUR.asn1.DERTaggedObject({obj:new KJUR.asn1.DERInteger({int:2})}),this.asn1SerialNumber=null,this.asn1SignatureAlg=null,this.asn1Issuer=null,this.asn1NotBefore=null,this.asn1NotAfter=null,this.asn1Subject=null,this.asn1SubjPKey=null,this.extensionsArray=new Array},this.setSerialNumberByParam=function(t){this.asn1SerialNumber=new KJUR.asn1.DERInteger(t)},this.setSignatureAlgByParam=function(t){this.asn1SignatureAlg=new KJUR.asn1.x509.AlgorithmIdentifier(t)},this.setIssuerByParam=function(t){this.asn1Issuer=new KJUR.asn1.x509.X500Name(t)},this.setNotBeforeByParam=function(t){this.asn1NotBefore=new KJUR.asn1.x509.Time(t)},this.setNotAfterByParam=function(t){this.asn1NotAfter=new KJUR.asn1.x509.Time(t)},this.setSubjectByParam=function(t){this.asn1Subject=new KJUR.asn1.x509.X500Name(t)},this.setSubjectPublicKeyByParam=function(t){this.asn1SubjPKey=new KJUR.asn1.x509.SubjectPublicKeyInfo(t)},this.setSubjectPublicKeyByGetKey=function(t){var e=KEYUTIL.getKey(t);this.asn1SubjPKey=new KJUR.asn1.x509.SubjectPublicKeyInfo(e)},this.appendExtension=function(t){this.extensionsArray.push(t)},this.appendExtensionByName=function(t,e){if("basicconstraints"==t.toLowerCase()){var i=new KJUR.asn1.x509.BasicConstraints(e);this.appendExtension(i)}else if("keyusage"==t.toLowerCase()){var i=new KJUR.asn1.x509.KeyUsage(e);this.appendExtension(i)}else if("crldistributionpoints"==t.toLowerCase()){var i=new KJUR.asn1.x509.CRLDistributionPoints(e);this.appendExtension(i)}else{if("extkeyusage"!=t.toLowerCase())throw"unsupported extension name: "+t;var i=new KJUR.asn1.x509.ExtKeyUsage(e);this.appendExtension(i)}},this.getEncodedHex=function(){if(null==this.asn1NotBefore||null==this.asn1NotAfter)throw"notBefore and/or notAfter not set";var t=new KJUR.asn1.DERSequence({array:[this.asn1NotBefore,this.asn1NotAfter]});if(this.asn1Array=new Array,this.asn1Array.push(this.asn1Version),this.asn1Array.push(this.asn1SerialNumber),this.asn1Array.push(this.asn1SignatureAlg),this.asn1Array.push(this.asn1Issuer),this.asn1Array.push(t),this.asn1Array.push(this.asn1Subject),this.asn1Array.push(this.asn1SubjPKey),this.extensionsArray.length>0){var e=new KJUR.asn1.DERSequence({array:this.extensionsArray}),i=new KJUR.asn1.DERTaggedObject({explicit:!0,tag:"a3",obj:e});this.asn1Array.push(i)}var n=new KJUR.asn1.DERSequence({array:this.asn1Array});return this.hTLV=n.getEncodedHex(),this.isModified=!1,this.hTLV},this._initialize()},YAHOO.lang.extend(KJUR.asn1.x509.TBSCertificate,KJUR.asn1.ASN1Object),KJUR.asn1.x509.Extension=function(t){KJUR.asn1.x509.Extension.superclass.constructor.call(this);this.getEncodedHex=function(){var t=new KJUR.asn1.DERObjectIdentifier({oid:this.oid}),e=new KJUR.asn1.DEROctetString({hex:this.getExtnValueHex()}),i=new Array;return i.push(t),this.critical&&i.push(new KJUR.asn1.DERBoolean),i.push(e),new KJUR.asn1.DERSequence({array:i}).getEncodedHex()},this.critical=!1,void 0!==t&&void 0!==t.critical&&(this.critical=t.critical)},YAHOO.lang.extend(KJUR.asn1.x509.Extension,KJUR.asn1.ASN1Object),KJUR.asn1.x509.KeyUsage=function(t){KJUR.asn1.x509.KeyUsage.superclass.constructor.call(this,t),this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()},this.oid="2.5.29.15",void 0!==t&&void 0!==t.bin&&(this.asn1ExtnValue=new KJUR.asn1.DERBitString(t))},YAHOO.lang.extend(KJUR.asn1.x509.KeyUsage,KJUR.asn1.x509.Extension),KJUR.asn1.x509.BasicConstraints=function(t){KJUR.asn1.x509.BasicConstraints.superclass.constructor.call(this,t);this.getExtnValueHex=function(){var t=new Array;this.cA&&t.push(new KJUR.asn1.DERBoolean),this.pathLen>-1&&t.push(new KJUR.asn1.DERInteger({int:this.pathLen}));var e=new KJUR.asn1.DERSequence({array:t});return this.asn1ExtnValue=e,this.asn1ExtnValue.getEncodedHex()},this.oid="2.5.29.19",this.cA=!1,this.pathLen=-1,void 0!==t&&(void 0!==t.cA&&(this.cA=t.cA),void 0!==t.pathLen&&(this.pathLen=t.pathLen))},YAHOO.lang.extend(KJUR.asn1.x509.BasicConstraints,KJUR.asn1.x509.Extension),KJUR.asn1.x509.CRLDistributionPoints=function(t){KJUR.asn1.x509.CRLDistributionPoints.superclass.constructor.call(this,t),this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()},this.setByDPArray=function(t){this.asn1ExtnValue=new KJUR.asn1.DERSequence({array:t})},this.setByOneURI=function(t){var e=new KJUR.asn1.x509.GeneralNames([{uri:t}]),i=new KJUR.asn1.x509.DistributionPointName(e),n=new KJUR.asn1.x509.DistributionPoint({dpobj:i});this.setByDPArray([n])},this.oid="2.5.29.31",void 0!==t&&(void 0!==t.array?this.setByDPArray(t.array):void 0!==t.uri&&this.setByOneURI(t.uri))},YAHOO.lang.extend(KJUR.asn1.x509.CRLDistributionPoints,KJUR.asn1.x509.Extension),KJUR.asn1.x509.ExtKeyUsage=function(t){KJUR.asn1.x509.ExtKeyUsage.superclass.constructor.call(this,t),this.setPurposeArray=function(t){this.asn1ExtnValue=new KJUR.asn1.DERSequence;for(var e=0;e<t.length;e++){var i=new KJUR.asn1.DERObjectIdentifier(t[e]);this.asn1ExtnValue.appendASN1Object(i)}},this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()},this.oid="2.5.29.37",void 0!==t&&void 0!==t.array&&this.setPurposeArray(t.array)},YAHOO.lang.extend(KJUR.asn1.x509.ExtKeyUsage,KJUR.asn1.x509.Extension),KJUR.asn1.x509.CRL=function(t){KJUR.asn1.x509.CRL.superclass.constructor.call(this);this.setRsaPrvKeyByPEMandPass=function(t,e){var i=PKCS5PKEY.getDecryptedKeyHex(t,e),n=new RSAKey;n.readPrivateKeyFromASN1HexString(i),this.rsaPrvKey=n},this.sign=function(){this.asn1SignatureAlg=this.asn1TBSCertList.asn1SignatureAlg,sig=new KJUR.crypto.Signature({alg:"SHA1withRSA",prov:"cryptojs/jsrsa"}),sig.initSign(this.rsaPrvKey),sig.updateHex(this.asn1TBSCertList.getEncodedHex()),this.hexSig=sig.sign(),this.asn1Sig=new KJUR.asn1.DERBitString({hex:"00"+this.hexSig});var t=new KJUR.asn1.DERSequence({array:[this.asn1TBSCertList,this.asn1SignatureAlg,this.asn1Sig]});this.hTLV=t.getEncodedHex(),this.isModified=!1},this.getEncodedHex=function(){if(0==this.isModified&&null!=this.hTLV)return this.hTLV;throw"not signed yet"},this.getPEMString=function(){var t=this.getEncodedHex(),e=CryptoJS.enc.Hex.parse(t);return"-----BEGIN X509 CRL-----\r\n"+CryptoJS.enc.Base64.stringify(e).replace(/(.{64})/g,"$1\r\n")+"\r\n-----END X509 CRL-----\r\n"},void 0!==t&&(void 0!==t.tbsobj&&(this.asn1TBSCertList=t.tbsobj),void 0!==t.rsaprvkey&&(this.rsaPrvKey=t.rsaprvkey),void 0!==t.rsaprvpem&&void 0!==t.rsaprvpas&&this.setRsaPrvKeyByPEMandPass(t.rsaprvpem,t.rsaprvpas))},YAHOO.lang.extend(KJUR.asn1.x509.CRL,KJUR.asn1.ASN1Object),KJUR.asn1.x509.TBSCertList=function(t){KJUR.asn1.x509.TBSCertList.superclass.constructor.call(this);this.setSignatureAlgByParam=function(t){this.asn1SignatureAlg=new KJUR.asn1.x509.AlgorithmIdentifier(t)},this.setIssuerByParam=function(t){this.asn1Issuer=new KJUR.asn1.x509.X500Name(t)},this.setThisUpdateByParam=function(t){this.asn1ThisUpdate=new KJUR.asn1.x509.Time(t)},this.setNextUpdateByParam=function(t){this.asn1NextUpdate=new KJUR.asn1.x509.Time(t)},this.addRevokedCert=function(t,e){var i={};void 0!=t&&null!=t&&(i.sn=t),void 0!=e&&null!=e&&(i.time=e);var n=new KJUR.asn1.x509.CRLEntry(i);this.aRevokedCert.push(n)},this.getEncodedHex=function(){if(this.asn1Array=new Array,null!=this.asn1Version&&this.asn1Array.push(this.asn1Version),this.asn1Array.push(this.asn1SignatureAlg),this.asn1Array.push(this.asn1Issuer),this.asn1Array.push(this.asn1ThisUpdate),null!=this.asn1NextUpdate&&this.asn1Array.push(this.asn1NextUpdate),this.aRevokedCert.length>0){var t=new KJUR.asn1.DERSequence({array:this.aRevokedCert});this.asn1Array.push(t)}var e=new KJUR.asn1.DERSequence({array:this.asn1Array});return this.hTLV=e.getEncodedHex(),this.isModified=!1,this.hTLV},this._initialize=function(){this.asn1Version=null,this.asn1SignatureAlg=null,this.asn1Issuer=null,this.asn1ThisUpdate=null,this.asn1NextUpdate=null,this.aRevokedCert=new Array},this._initialize()},YAHOO.lang.extend(KJUR.asn1.x509.TBSCertList,KJUR.asn1.ASN1Object),KJUR.asn1.x509.CRLEntry=function(t){KJUR.asn1.x509.CRLEntry.superclass.constructor.call(this);this.setCertSerial=function(t){this.sn=new KJUR.asn1.DERInteger(t)},this.setRevocationDate=function(t){this.time=new KJUR.asn1.x509.Time(t)},this.getEncodedHex=function(){var t=new KJUR.asn1.DERSequence({array:[this.sn,this.time]});return this.TLV=t.getEncodedHex(),this.TLV},void 0!==t&&(void 0!==t.time&&this.setRevocationDate(t.time),void 0!==t.sn&&this.setCertSerial(t.sn))},YAHOO.lang.extend(KJUR.asn1.x509.CRLEntry,KJUR.asn1.ASN1Object),KJUR.asn1.x509.X500Name=function(t){KJUR.asn1.x509.X500Name.superclass.constructor.call(this),this.asn1Array=new Array,this.setByString=function(t){var e=t.split("/");e.shift();for(var i=0;i<e.length;i++)this.asn1Array.push(new KJUR.asn1.x509.RDN({str:e[i]}))},this.getEncodedHex=function(){var t=new KJUR.asn1.DERSequence({array:this.asn1Array});return this.TLV=t.getEncodedHex(),this.TLV},void 0!==t&&void 0!==t.str&&this.setByString(t.str)},YAHOO.lang.extend(KJUR.asn1.x509.X500Name,KJUR.asn1.ASN1Object),KJUR.asn1.x509.RDN=function(t){KJUR.asn1.x509.RDN.superclass.constructor.call(this),this.asn1Array=new Array,this.addByString=function(t){this.asn1Array.push(new KJUR.asn1.x509.AttributeTypeAndValue({str:t}))},this.getEncodedHex=function(){var t=new KJUR.asn1.DERSet({array:this.asn1Array});return this.TLV=t.getEncodedHex(),this.TLV},void 0!==t&&void 0!==t.str&&this.addByString(t.str)},YAHOO.lang.extend(KJUR.asn1.x509.RDN,KJUR.asn1.ASN1Object),KJUR.asn1.x509.AttributeTypeAndValue=function(t){KJUR.asn1.x509.AttributeTypeAndValue.superclass.constructor.call(this);this.setByString=function(t){if(!t.match(/^([^=]+)=(.+)$/))throw"malformed attrTypeAndValueStr: "+t;this.setByAttrTypeAndValueStr(RegExp.$1,RegExp.$2)},this.setByAttrTypeAndValueStr=function(t,e){this.typeObj=KJUR.asn1.x509.OID.atype2obj(t);var i="utf8";"C"==t&&(i="prn"),this.valueObj=this.getValueObj(i,e)},this.getValueObj=function(t,e){if("utf8"==t)return new KJUR.asn1.DERUTF8String({str:e});if("prn"==t)return new KJUR.asn1.DERPrintableString({str:e});if("tel"==t)return new KJUR.asn1.DERTeletexString({str:e});if("ia5"==t)return new KJUR.asn1.DERIA5String({str:e});throw"unsupported directory string type: type="+t+" value="+e},this.getEncodedHex=function(){var t=new KJUR.asn1.DERSequence({array:[this.typeObj,this.valueObj]});return this.TLV=t.getEncodedHex(),this.TLV},void 0!==t&&void 0!==t.str&&this.setByString(t.str)},YAHOO.lang.extend(KJUR.asn1.x509.AttributeTypeAndValue,KJUR.asn1.ASN1Object),KJUR.asn1.x509.SubjectPublicKeyInfo=function(t){KJUR.asn1.x509.SubjectPublicKeyInfo.superclass.constructor.call(this);this.setRSAKey=function(t){if(!RSAKey.prototype.isPrototypeOf(t))throw"argument is not RSAKey instance";this.rsaKey=t;var e=new KJUR.asn1.DERInteger({bigint:t.n}),i=new KJUR.asn1.DERInteger({int:t.e}),n=new KJUR.asn1.DERSequence({array:[e,i]}),r=n.getEncodedHex();this.asn1AlgId=new KJUR.asn1.x509.AlgorithmIdentifier({name:"rsaEncryption"}),this.asn1SubjPKey=new KJUR.asn1.DERBitString({hex:"00"+r})},this.setRSAPEM=function(t){if(!t.match(/-----BEGIN PUBLIC KEY-----/))throw"key not supported";var e=t;e=e.replace(/^-----[^-]+-----/,""),e=e.replace(/-----[^-]+-----\s*$/,"");var i=e.replace(/\s+/g,""),n=CryptoJS.enc.Base64.parse(i),r=CryptoJS.enc.Hex.stringify(n),s=_rsapem_getHexValueArrayOfChildrenFromHex(r),o=s[1],a=o.substr(2),h=_rsapem_getHexValueArrayOfChildrenFromHex(a),c=new RSAKey;c.setPublic(h[0],h[1]),this.setRSAKey(c)},this.getASN1Object=function(){if(null==this.asn1AlgId||null==this.asn1SubjPKey)throw"algId and/or subjPubKey not set";return new KJUR.asn1.DERSequence({array:[this.asn1AlgId,this.asn1SubjPKey]})},this.getEncodedHex=function(){var t=this.getASN1Object();return this.hTLV=t.getEncodedHex(),this.hTLV},this._setRSAKey=function(t){var e=KJUR.asn1.ASN1Util.newObject({seq:[{int:{bigint:t.n}},{int:{int:t.e}}]}),i=e.getEncodedHex();this.asn1AlgId=new KJUR.asn1.x509.AlgorithmIdentifier({name:"rsaEncryption"}),this.asn1SubjPKey=new KJUR.asn1.DERBitString({hex:"00"+i})},this._setEC=function(t){var e=new KJUR.asn1.DERObjectIdentifier({name:t.curveName});this.asn1AlgId=new KJUR.asn1.x509.AlgorithmIdentifier({name:"ecPublicKey",asn1params:e}),this.asn1SubjPKey=new KJUR.asn1.DERBitString({hex:"00"+t.pubKeyHex})},this._setDSA=function(t){var e=new KJUR.asn1.ASN1Util.newObject({seq:[{int:{bigint:t.p}},{int:{bigint:t.q}},{int:{bigint:t.g}}]});this.asn1AlgId=new KJUR.asn1.x509.AlgorithmIdentifier({name:"dsa",asn1params:e});var i=new KJUR.asn1.DERInteger({bigint:t.y});this.asn1SubjPKey=new KJUR.asn1.DERBitString({hex:"00"+i.getEncodedHex()})},void 0!==t&&("undefined"!=typeof RSAKey&&t instanceof RSAKey?this._setRSAKey(t):void 0!==KJUR.crypto.ECDSA&&t instanceof KJUR.crypto.ECDSA?this._setEC(t):void 0!==KJUR.crypto.DSA&&t instanceof KJUR.crypto.DSA?this._setDSA(t):void 0!==t.rsakey?this.setRSAKey(t.rsakey):void 0!==t.rsapem&&this.setRSAPEM(t.rsapem))},YAHOO.lang.extend(KJUR.asn1.x509.SubjectPublicKeyInfo,KJUR.asn1.ASN1Object),KJUR.asn1.x509.Time=function(t){KJUR.asn1.x509.Time.superclass.constructor.call(this);this.setTimeParams=function(t){this.timeParams=t},this.getEncodedHex=function(){if(null==this.timeParams)throw"timeParams shall be specified. ({'str':'130403235959Z'}}";var t=null;return t="utc"==this.type?new KJUR.asn1.DERUTCTime(this.timeParams):new KJUR.asn1.DERGeneralizedTime(this.timeParams),this.TLV=t.getEncodedHex(),this.TLV},this.type="utc",void 0!==t&&(void 0!==t.type&&(this.type=t.type),this.timeParams=t)},YAHOO.lang.extend(KJUR.asn1.x509.Time,KJUR.asn1.ASN1Object),KJUR.asn1.x509.AlgorithmIdentifier=function(t){KJUR.asn1.x509.AlgorithmIdentifier.superclass.constructor.call(this);this.getEncodedHex=function(){if(null==this.nameAlg&&null==this.asn1Alg)throw"algorithm not specified";null!=this.nameAlg&&null==this.asn1Alg&&(this.asn1Alg=KJUR.asn1.x509.OID.name2obj(this.nameAlg));var t=[this.asn1Alg];this.paramEmpty||t.push(this.asn1Params);var e=new KJUR.asn1.DERSequence({array:t});return this.hTLV=e.getEncodedHex(),this.hTLV},void 0!==t&&(void 0!==t.name&&(this.nameAlg=t.name),void 0!==t.asn1params&&(this.asn1Params=t.asn1params),void 0!==t.paramempty&&(this.paramEmpty=t.paramempty)),null==this.asn1Params&&(this.asn1Params=new KJUR.asn1.DERNull)},YAHOO.lang.extend(KJUR.asn1.x509.AlgorithmIdentifier,KJUR.asn1.ASN1Object),KJUR.asn1.x509.GeneralName=function(t){KJUR.asn1.x509.GeneralName.superclass.constructor.call(this);var e={rfc822:"81",dns:"82",uri:"86"};this.setByParam=function(t){var i=null;if(void 0!==t.rfc822&&(this.type="rfc822",i=new KJUR.asn1.DERIA5String({str:t[this.type]})),void 0!==t.dns&&(this.type="dns",i=new KJUR.asn1.DERIA5String({str:t[this.type]})),void 0!==t.uri&&(this.type="uri",i=new KJUR.asn1.DERIA5String({str:t[this.type]})),null==this.type)throw"unsupported type in params="+t;this.asn1Obj=new KJUR.asn1.DERTaggedObject({explicit:!1,tag:e[this.type],obj:i})},this.getEncodedHex=function(){return this.asn1Obj.getEncodedHex()},void 0!==t&&this.setByParam(t)},YAHOO.lang.extend(KJUR.asn1.x509.GeneralName,KJUR.asn1.ASN1Object),KJUR.asn1.x509.GeneralNames=function(t){KJUR.asn1.x509.GeneralNames.superclass.constructor.call(this);this.setByParamArray=function(t){for(var e=0;e<t.length;e++){var i=new KJUR.asn1.x509.GeneralName(t[e]);this.asn1Array.push(i)}},this.getEncodedHex=function(){return new KJUR.asn1.DERSequence({array:this.asn1Array}).getEncodedHex()},this.asn1Array=new Array,void 0!==t&&this.setByParamArray(t)},YAHOO.lang.extend(KJUR.asn1.x509.GeneralNames,KJUR.asn1.ASN1Object),KJUR.asn1.x509.DistributionPointName=function(t){KJUR.asn1.x509.DistributionPointName.superclass.constructor.call(this);if(this.getEncodedHex=function(){if("full"!=this.type)throw"currently type shall be 'full': "+this.type;return this.asn1Obj=new KJUR.asn1.DERTaggedObject({explicit:!1,tag:this.tag,obj:this.asn1V}),this.hTLV=this.asn1Obj.getEncodedHex(),this.hTLV},void 0!==t){if(!KJUR.asn1.x509.GeneralNames.prototype.isPrototypeOf(t))throw"This class supports GeneralNames only as argument";this.type="full",this.tag="a0",this.asn1V=t}},YAHOO.lang.extend(KJUR.asn1.x509.DistributionPointName,KJUR.asn1.ASN1Object),KJUR.asn1.x509.DistributionPoint=function(t){KJUR.asn1.x509.DistributionPoint.superclass.constructor.call(this);this.getEncodedHex=function(){var t=new KJUR.asn1.DERSequence;if(null!=this.asn1DP){var e=new KJUR.asn1.DERTaggedObject({explicit:!0,tag:"a0",obj:this.asn1DP});t.appendASN1Object(e)}return this.hTLV=t.getEncodedHex(),this.hTLV},void 0!==t&&void 0!==t.dpobj&&(this.asn1DP=t.dpobj)},YAHOO.lang.extend(KJUR.asn1.x509.DistributionPoint,KJUR.asn1.ASN1Object),KJUR.asn1.x509.OID=new function(t){this.atype2oidList={C:"2.5.4.6",O:"2.5.4.10",OU:"2.5.4.11",ST:"2.5.4.8",L:"2.5.4.7",CN:"2.5.4.3"},this.name2oidList={sha384:"2.16.840.1.101.3.4.2.2",sha224:"2.16.840.1.101.3.4.2.4",MD2withRSA:"1.2.840.113549.1.1.2",MD4withRSA:"1.2.840.113549.1.1.3",MD5withRSA:"1.2.840.113549.1.1.4",SHA1withRSA:"1.2.840.113549.1.1.5",SHA224withRSA:"1.2.840.113549.1.1.14",SHA256withRSA:"1.2.840.113549.1.1.11",SHA384withRSA:"1.2.840.113549.1.1.12",SHA512withRSA:"1.2.840.113549.1.1.13",SHA1withECDSA:"1.2.840.10045.4.1",SHA224withECDSA:"1.2.840.10045.4.3.1",SHA256withECDSA:"1.2.840.10045.4.3.2",SHA384withECDSA:"1.2.840.10045.4.3.3",SHA512withECDSA:"1.2.840.10045.4.3.4",dsa:"1.2.840.10040.4.1",SHA1withDSA:"1.2.840.10040.4.3",SHA224withDSA:"2.16.840.1.101.3.4.3.1",SHA256withDSA:"2.16.840.1.101.3.4.3.2",rsaEncryption:"1.2.840.113549.1.1.1",subjectKeyIdentifier:"2.5.29.14",countryName:"2.5.4.6",organization:"2.5.4.10",organizationalUnit:"2.5.4.11",stateOrProvinceName:"2.5.4.8",locality:"2.5.4.7",commonName:"2.5.4.3",keyUsage:"2.5.29.15",basicConstraints:"2.5.29.19",cRLDistributionPoints:"2.5.29.31",certificatePolicies:"2.5.29.32",authorityKeyIdentifier:"2.5.29.35",extKeyUsage:"2.5.29.37",anyExtendedKeyUsage:"2.5.29.37.0",serverAuth:"1.3.6.1.5.5.7.3.1",clientAuth:"1.3.6.1.5.5.7.3.2",codeSigning:"1.3.6.1.5.5.7.3.3",emailProtection:"1.3.6.1.5.5.7.3.4",timeStamping:"1.3.6.1.5.5.7.3.8",ocspSigning:"1.3.6.1.5.5.7.3.9",ecPublicKey:"1.2.840.10045.2.1",secp256r1:"1.2.840.10045.3.1.7",secp256k1:"1.3.132.0.10",secp384r1:"1.3.132.0.34",pkcs5PBES2:"1.2.840.113549.1.5.13",pkcs5PBKDF2:"1.2.840.113549.1.5.12","des-EDE3-CBC":"1.2.840.113549.3.7"},this.objCache={},this.name2obj=function(t){if(void 0!==this.objCache[t])return this.objCache[t];if(void 0===this.name2oidList[t])throw"Name of ObjectIdentifier not defined: "+t;var e=this.name2oidList[t],i=new KJUR.asn1.DERObjectIdentifier({oid:e});return this.objCache[t]=i,i},this.atype2obj=function(t){if(void 0!==this.objCache[t])return this.objCache[t];if(void 0===this.atype2oidList[t])throw"AttributeType name undefined: "+t;var e=this.atype2oidList[t],i=new KJUR.asn1.DERObjectIdentifier({oid:e});return this.objCache[t]=i,i}},KJUR.asn1.x509.X509Util=new function(){this.getPKCS8PubKeyPEMfromRSAKey=function(t){var e=KJUR.asn1.ASN1Util.bigIntToMinTwosComplementsHex(t.n),i=KJUR.asn1.ASN1Util.integerToByteHex(t.e),n=new KJUR.asn1.DERInteger({hex:e}),r=new KJUR.asn1.DERInteger({hex:i}),s=new KJUR.asn1.DERSequence({array:[n,r]}),o=s.getEncodedHex(),a=new KJUR.asn1.x509.AlgorithmIdentifier({name:"rsaEncryption"}),h=new KJUR.asn1.DERBitString({hex:"00"+o}),c=new KJUR.asn1.DERSequence({array:[a,h]}),u=c.getEncodedHex();return KJUR.asn1.ASN1Util.getPEMStringFromHex(u,"PUBLIC KEY")}},KJUR.asn1.x509.X509Util.newCertPEM=function(t){var e=KJUR.asn1.x509,i=new e.TBSCertificate;if(void 0===t.serial)throw"serial number undefined.";if(i.setSerialNumberByParam(t.serial),"string"!=typeof t.sigalg.name)throw"unproper signature algorithm name";if(i.setSignatureAlgByParam(t.sigalg),void 0===t.issuer)throw"issuer name undefined.";if(i.setIssuerByParam(t.issuer),void 0===t.notbefore)throw"notbefore undefined.";if(i.setNotBeforeByParam(t.notbefore),void 0===t.notafter)throw"notafter undefined.";if(i.setNotAfterByParam(t.notafter),void 0===t.subject)throw"subject name undefined.";if(i.setSubjectByParam(t.subject),void 0===t.sbjpubkey)throw"subject public key undefined.";if(i.setSubjectPublicKeyByGetKey(t.sbjpubkey),void 0!==t.ext.length)for(var n=0;n<t.ext.length;n++)for(key in t.ext[n])i.appendExtensionByName(key,t.ext[n][key]);var r=null;if(!t.cakey)throw"ca key undefined";r=KEYUTIL.getKey.apply(null,t.cakey);var s=new e.Certificate({tbscertobj:i,prvkeyobj:r});return s.sign(),s.getPEMString()},void 0!==KJUR&&KJUR||(KJUR={}),void 0!==KJUR.crypto&&KJUR.crypto||(KJUR.crypto={}),KJUR.crypto.Util=new function(){this.DIGESTINFOHEAD={sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",ripemd160:"3021300906052b2403020105000414"},this.DEFAULTPROVIDER={md5:"cryptojs",sha1:"cryptojs",sha224:"cryptojs",sha256:"cryptojs",sha384:"cryptojs",sha512:"cryptojs",ripemd160:"cryptojs",hmacmd5:"cryptojs",hmacsha1:"cryptojs",hmacsha224:"cryptojs",hmacsha256:"cryptojs",hmacsha384:"cryptojs",hmacsha512:"cryptojs",hmacripemd160:"cryptojs",sm3:"cryptojs",MD5withRSA:"cryptojs/jsrsa",SHA1withRSA:"cryptojs/jsrsa",SHA224withRSA:"cryptojs/jsrsa",SHA256withRSA:"cryptojs/jsrsa",SHA384withRSA:"cryptojs/jsrsa",SHA512withRSA:"cryptojs/jsrsa",RIPEMD160withRSA:"cryptojs/jsrsa",MD5withECDSA:"cryptojs/jsrsa",SHA1withECDSA:"cryptojs/jsrsa",SHA224withECDSA:"cryptojs/jsrsa",SHA256withECDSA:"cryptojs/jsrsa",SHA384withECDSA:"cryptojs/jsrsa",SHA512withECDSA:"cryptojs/jsrsa",RIPEMD160withECDSA:"cryptojs/jsrsa",SHA1withDSA:"cryptojs/jsrsa",SHA224withDSA:"cryptojs/jsrsa",SHA256withDSA:"cryptojs/jsrsa",MD5withRSAandMGF1:"cryptojs/jsrsa",SHA1withRSAandMGF1:"cryptojs/jsrsa",SHA224withRSAandMGF1:"cryptojs/jsrsa",SHA256withRSAandMGF1:"cryptojs/jsrsa",SHA384withRSAandMGF1:"cryptojs/jsrsa",SHA512withRSAandMGF1:"cryptojs/jsrsa",RIPEMD160withRSAandMGF1:"cryptojs/jsrsa"},this.CRYPTOJSMESSAGEDIGESTNAME={md5:"CryptoJS.algo.MD5",sha1:"CryptoJS.algo.SHA1",sha224:"CryptoJS.algo.SHA224",sha256:"CryptoJS.algo.SHA256",sha384:"CryptoJS.algo.SHA384",sha512:"CryptoJS.algo.SHA512",ripemd160:"CryptoJS.algo.RIPEMD160",sm3:"CryptoJS.algo.SM3"},this.getDigestInfoHex=function(t,e){if(void 0===this.DIGESTINFOHEAD[e])throw"alg not supported in Util.DIGESTINFOHEAD: "+e;return this.DIGESTINFOHEAD[e]+t},this.getPaddedDigestInfoHex=function(t,e,i){var n=this.getDigestInfoHex(t,e),r=i/4;if(n.length+22>r)throw"key is too short for SigAlg: keylen="+i+","+e;for(var s="00"+n,o="",a=r-"0001".length-s.length,h=0;h<a;h+=2)o+="ff";return"0001"+o+s},this.hashString=function(t,e){return new KJUR.crypto.MessageDigest({alg:e}).digestString(t)},this.hashHex=function(t,e){return new KJUR.crypto.MessageDigest({alg:e}).digestHex(t)},this.sha1=function(t){return new KJUR.crypto.MessageDigest({alg:"sha1",prov:"cryptojs"}).digestString(t)},this.sha256=function(t){return new KJUR.crypto.MessageDigest({alg:"sha256",prov:"cryptojs"}).digestString(t)},this.sha256Hex=function(t){return new KJUR.crypto.MessageDigest({alg:"sha256",prov:"cryptojs"}).digestHex(t)},this.sha512=function(t){return new KJUR.crypto.MessageDigest({alg:"sha512",prov:"cryptojs"}).digestString(t)},this.sha512Hex=function(t){return new KJUR.crypto.MessageDigest({alg:"sha512",prov:"cryptojs"}).digestHex(t)},this.md5=function(t){return new KJUR.crypto.MessageDigest({alg:"md5",prov:"cryptojs"}).digestString(t)},this.ripemd160=function(t){return new KJUR.crypto.MessageDigest({alg:"ripemd160",prov:"cryptojs"}).digestString(t)},this.getCryptoJSMDByName=function(t){}},KJUR.crypto.MessageDigest=function(params){var md=null,algName=null,provName=null;this.setAlgAndProvider=function(alg,prov){if(null!=alg&&void 0===prov&&(prov=KJUR.crypto.Util.DEFAULTPROVIDER[alg]),-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:sm3:".indexOf(alg)&&"cryptojs"==prov){try{this.md=eval(KJUR.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[alg]).create()}catch(t){throw"setAlgAndProvider hash alg set fail alg="+alg+"/"+t}this.updateString=function(t){this.md.update(t)},this.updateHex=function(t){var e=CryptoJS.enc.Hex.parse(t);this.md.update(e)},this.digest=function(){return this.md.finalize().toString(CryptoJS.enc.Hex)},this.digestString=function(t){return this.updateString(t),this.digest()},this.digestHex=function(t){return this.updateHex(t),this.digest()}}if(-1!=":sha256:".indexOf(alg)&&"sjcl"==prov){try{this.md=new _sjcl2.default.hash.sha256}catch(t){throw"setAlgAndProvider hash alg set fail alg="+alg+"/"+t}this.updateString=function(t){this.md.update(t)},this.updateHex=function(t){var e=_sjcl2.default.codec.hex.toBits(t);this.md.update(e)},this.digest=function(){var t=this.md.finalize();return _sjcl2.default.codec.hex.fromBits(t)},this.digestString=function(t){return this.updateString(t),this.digest()},this.digestHex=function(t){return this.updateHex(t),this.digest()}}},this.updateString=function(t){throw"updateString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.updateHex=function(t){throw"updateHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digest=function(){throw"digest() not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestString=function(t){throw"digestString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestHex=function(t){throw"digestHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},void 0!==params&&void 0!==params.alg&&(this.algName=params.alg,void 0===params.prov&&(this.provName=KJUR.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName))},KJUR.crypto.Mac=function(params){var mac=null,pass=null,algName=null,provName=null,algProv=null;this.setAlgAndProvider=function(alg,prov){if(null==alg&&(alg="hmacsha1"),alg=alg.toLowerCase(),"hmac"!=alg.substr(0,4))throw"setAlgAndProvider unsupported HMAC alg: "+alg;void 0===prov&&(prov=KJUR.crypto.Util.DEFAULTPROVIDER[alg]),this.algProv=alg+"/"+prov;var hashAlg=alg.substr(4);if(-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(hashAlg)&&"cryptojs"==prov){try{var mdObj=eval(KJUR.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[hashAlg]);this.mac=CryptoJS.algo.HMAC.create(mdObj,this.pass)}catch(t){throw"setAlgAndProvider hash alg set fail hashAlg="+hashAlg+"/"+t}this.updateString=function(t){this.mac.update(t)},this.updateHex=function(t){var e=CryptoJS.enc.Hex.parse(t);this.mac.update(e)},this.doFinal=function(){return this.mac.finalize().toString(CryptoJS.enc.Hex)},this.doFinalString=function(t){return this.updateString(t),this.doFinal()},this.doFinalHex=function(t){return this.updateHex(t),this.doFinal()}}},this.updateString=function(t){throw"updateString(str) not supported for this alg/prov: "+this.algProv},this.updateHex=function(t){throw"updateHex(hex) not supported for this alg/prov: "+this.algProv},this.doFinal=function(){throw"digest() not supported for this alg/prov: "+this.algProv},this.doFinalString=function(t){throw"digestString(str) not supported for this alg/prov: "+this.algProv},this.doFinalHex=function(t){throw"digestHex(hex) not supported for this alg/prov: "+this.algProv},void 0!==params&&(void 0!==params.pass&&(this.pass=params.pass),void 0!==params.alg&&(this.algName=params.alg,void 0===params.prov&&(this.provName=KJUR.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName)))},KJUR.crypto.Signature=function(t){var e=null;if(this._setAlgNames=function(){this.algName.match(/^(.+)with(.+)$/)&&(this.mdAlgName=RegExp.$1.toLowerCase(),this.pubkeyAlgName=RegExp.$2.toLowerCase())},this._zeroPaddingOfSignature=function(t,e){for(var i="",n=e/4-t.length,r=0;r<n;r++)i+="0";return i+t},this.setAlgAndProvider=function(t,e){if(this._setAlgNames(),"cryptojs/jsrsa"!=e)throw"provider not supported: "+e;if(-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:sm3:".indexOf(this.mdAlgName)){try{this.md=new KJUR.crypto.MessageDigest({alg:this.mdAlgName})}catch(t){throw"setAlgAndProvider hash alg set fail alg="+this.mdAlgName+"/"+t}this.init=function(t,e){var i=null;try{i=void 0===e?KEYUTIL.getKey(t):KEYUTIL.getKey(t,e)}catch(t){throw"init failed:"+t}if(!0===i.isPrivate)this.prvKey=i,this.state="SIGN";else{if(!0!==i.isPublic)throw"init failed.:"+i;this.pubKey=i,this.state="VERIFY"}},this.initSign=function(t){"string"==typeof t.ecprvhex&&"string"==typeof t.eccurvename?(this.ecprvhex=t.ecprvhex,this.eccurvename=t.eccurvename):this.prvKey=t,this.state="SIGN"},this.initVerifyByPublicKey=function(t){"string"==typeof t.ecpubhex&&"string"==typeof t.eccurvename?(this.ecpubhex=t.ecpubhex,this.eccurvename=t.eccurvename):t instanceof KJUR.crypto.ECDSA?this.pubKey=t:t instanceof RSAKey&&(this.pubKey=t),this.state="VERIFY"},this.initVerifyByCertificatePEM=function(t){var e=new X509;e.readCertPEM(t),this.pubKey=e.subjectPublicKeyRSA,this.state="VERIFY"},this.updateString=function(t){this.md.updateString(t)},this.updateHex=function(t){this.md.updateHex(t)},this.sign=function(){if("sm2"!=this.eccurvename&&(this.sHashHex=this.md.digest()),void 0!==this.ecprvhex&&void 0!==this.eccurvename)if("sm2"==this.eccurvename){for(var t=new KJUR.crypto.SM3withSM2({curve:this.eccurvename}),e=t.ecparams.G,i=e.multiply(new BigInteger(this.ecprvhex,16)),n=i.getX().toBigInteger().toRadix(16);64!==n.length;)n="0"+n;for(var r=i.getY().toBigInteger().toRadix(16);64!==r.length;)r="0"+r;var s=n+r,o=new SM3Digest,a=(new SM3Digest).GetZ(e,s),h=o.GetWords(o.GetHex(a).toString()),c=CryptoJS.enc.Utf8.stringify(this.md.md._data);c=CryptoJS.enc.Utf8.parse(c).toString(),c=o.GetWords(c);var u=new Array(o.GetDigestSize());o.BlockUpdate(h,0,h.length),o.BlockUpdate(c,0,c.length),o.DoFinal(u,0);var l=o.GetHex(u).toString();this.sHashHex=l,this.hSign=t.signHex(this.sHashHex,this.ecprvhex)}else{var t=new KJUR.crypto.ECDSA({curve:this.eccurvename});this.hSign=t.signHex(this.sHashHex,this.ecprvhex)}else if("rsaandmgf1"==this.pubkeyAlgName)this.hSign=this.prvKey.signWithMessageHashPSS(this.sHashHex,this.mdAlgName,this.pssSaltLen);else if("rsa"==this.pubkeyAlgName)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex,this.mdAlgName);else if(this.prvKey instanceof KJUR.crypto.ECDSA)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex);else{if(!(this.prvKey instanceof KJUR.crypto.DSA))throw"Signature: unsupported public key alg: "+this.pubkeyAlgName;this.hSign=this.prvKey.signWithMessageHash(this.sHashHex)}return this.hSign},this.nakedsign=function(){if("sm2"!=this.eccurvename&&(this.sHashHex=this.md.digest()),void 0!==this.ecprvhex&&void 0!==this.eccurvename)if("sm2"==this.eccurvename){var t=new KJUR.crypto.SM3withSM2({curve:this.eccurvename}),e=new SM3Digest,i=CryptoJS.enc.Utf8.stringify(this.md.md._data);i=CryptoJS.enc.Utf8.parse(i).toString(),i=e.GetWords(i);var n=new Array(e.GetDigestSize());e.BlockUpdate(i,0,i.length),e.DoFinal(n,0);var r=e.GetHex(n).toString();this.sHashHex=r,this.hSign=t.signHex(this.sHashHex,this.ecprvhex)}else{var t=new KJUR.crypto.ECDSA({curve:this.eccurvename});this.hSign=t.signHex(this.sHashHex,this.ecprvhex)}else if("rsaandmgf1"==this.pubkeyAlgName)this.hSign=this.prvKey.signWithMessageHashPSS(this.sHashHex,this.mdAlgName,this.pssSaltLen);else if("rsa"==this.pubkeyAlgName)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex,this.mdAlgName);else if(this.prvKey instanceof KJUR.crypto.ECDSA)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex);else{if(!(this.prvKey instanceof KJUR.crypto.DSA))throw"Signature: unsupported public key alg: "+this.pubkeyAlgName;this.hSign=this.prvKey.signWithMessageHash(this.sHashHex)}return this.hSign},this.signString=function(t){this.updateString(t),this.sign()},this.signHex=function(t){this.updateHex(t),this.sign()},this.verify=function(t){if("sm2"!=this.eccurvename&&(this.sHashHex=this.md.digest()),void 0!==this.ecpubhex&&void 0!==this.eccurvename){if("sm2"==this.eccurvename){var e=new KJUR.crypto.SM3withSM2({curve:this.eccurvename}),i=e.ecparams.G,n=this.ecpubhex.substr(2,128),r=new SM3Digest,s=(new SM3Digest).GetZ(i,n),o=r.GetWords(r.GetHex(s).toString()),a=CryptoJS.enc.Utf8.stringify(this.md.md._data);a=CryptoJS.enc.Utf8.parse(a).toString(),a=r.GetWords(a);var h=new Array(r.GetDigestSize());r.BlockUpdate(o,0,o.length),r.BlockUpdate(a,0,a.length),r.DoFinal(h,0);var c=r.GetHex(h).toString();return this.sHashHex=c,e.verifyHex(this.sHashHex,t,this.ecpubhex)}var e=new KJUR.crypto.ECDSA({curve:this.eccurvename});return e.verifyHex(this.sHashHex,t,this.ecpubhex)}if("rsaandmgf1"==this.pubkeyAlgName)return this.pubKey.verifyWithMessageHashPSS(this.sHashHex,t,this.mdAlgName,this.pssSaltLen);if("rsa"==this.pubkeyAlgName)return this.pubKey.verifyWithMessageHash(this.sHashHex,t);if(this.pubKey instanceof KJUR.crypto.ECDSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,t);if(this.pubKey instanceof KJUR.crypto.DSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,t);throw"Signature: unsupported public key alg: "+this.pubkeyAlgName},this.nakedverify=function(t){if("sm2"!=this.eccurvename&&(this.sHashHex=this.md.digest()),void 0!==this.ecpubhex&&void 0!==this.eccurvename){if("sm2"==this.eccurvename){var e=new KJUR.crypto.SM3withSM2({curve:this.eccurvename}),i=new SM3Digest,n=CryptoJS.enc.Utf8.stringify(this.md.md._data);n=CryptoJS.enc.Utf8.parse(n).toString(),n=i.GetWords(n);var r=new Array(i.GetDigestSize());i.BlockUpdate(n,0,n.length),i.DoFinal(r,0);var s=i.GetHex(r).toString();return this.sHashHex=s,e.verifyHex(this.sHashHex,t,this.ecpubhex)}var e=new KJUR.crypto.ECDSA({curve:this.eccurvename});return e.verifyHex(this.sHashHex,t,this.ecpubhex)}if("rsaandmgf1"==this.pubkeyAlgName)return this.pubKey.verifyWithMessageHashPSS(this.sHashHex,t,this.mdAlgName,this.pssSaltLen);if("rsa"==this.pubkeyAlgName)return this.pubKey.verifyWithMessageHash(this.sHashHex,t);if(this.pubKey instanceof KJUR.crypto.ECDSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,t);if(this.pubKey instanceof KJUR.crypto.DSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,t);throw"Signature: unsupported public key alg: "+this.pubkeyAlgName}}},this.init=function(t,e){throw"init(key, pass) not supported for this alg:prov="+this.algProvName},this.initVerifyByPublicKey=function(t){throw"initVerifyByPublicKey(rsaPubKeyy) not supported for this alg:prov="+this.algProvName},this.initVerifyByCertificatePEM=function(t){throw"initVerifyByCertificatePEM(certPEM) not supported for this alg:prov="+this.algProvName},this.initSign=function(t){throw"initSign(prvKey) not supported for this alg:prov="+this.algProvName},this.updateString=function(t){throw"updateString(str) not supported for this alg:prov="+this.algProvName},this.updateHex=function(t){throw"updateHex(hex) not supported for this alg:prov="+this.algProvName},this.sign=function(){throw"sign() not supported for this alg:prov="+this.algProvName},this.signString=function(t){throw"digestString(str) not supported for this alg:prov="+this.algProvName},this.signHex=function(t){throw"digestHex(hex) not supported for this alg:prov="+this.algProvName},this.verify=function(t){throw"verify(hSigVal) not supported for this alg:prov="+this.algProvName},this.initParams=t,void 0!==t&&(void 0!==t.alg&&(this.algName=t.alg,void 0===t.prov?this.provName=KJUR.crypto.Util.DEFAULTPROVIDER[this.algName]:this.provName=t.prov,this.algProvName=this.algName+":"+this.provName,this.setAlgAndProvider(this.algName,this.provName),this._setAlgNames()),void 0!==t.psssaltlen&&(this.pssSaltLen=t.psssaltlen),void 0!==t.prvkeypem)){if(void 0!==t.prvkeypas)throw"both prvkeypem and prvkeypas parameters not supported";try{var e=new RSAKey;e.readPrivateKeyFromPEMString(t.prvkeypem),this.initSign(e)}catch(t){throw"fatal error to load pem private key: "+t}}},KJUR.crypto.OID=new function(){this.oidhex2name={"2a864886f70d010101":"rsaEncryption","2a8648ce3d0201":"ecPublicKey","2a8648ce380401":"dsa","2a8648ce3d030107":"secp256r1","2b8104001f":"secp192k1","2b81040021":"secp224r1","2b8104000a":"secp256k1","2b81040023":"secp521r1","2b81040022":"secp384r1","2a8648ce380403":"SHA1withDSA","608648016503040301":"SHA224withDSA","608648016503040302":"SHA256withDSA"}},ECFieldElementFp.prototype.equals=feFpEquals,ECFieldElementFp.prototype.toBigInteger=feFpToBigInteger,ECFieldElementFp.prototype.negate=feFpNegate,ECFieldElementFp.prototype.add=feFpAdd,ECFieldElementFp.prototype.subtract=feFpSubtract,ECFieldElementFp.prototype.multiply=feFpMultiply,ECFieldElementFp.prototype.square=feFpSquare,ECFieldElementFp.prototype.divide=feFpDivide,ECPointFp.prototype.getX=pointFpGetX,ECPointFp.prototype.getY=pointFpGetY,ECPointFp.prototype.equals=pointFpEquals,ECPointFp.prototype.isInfinity=pointFpIsInfinity,ECPointFp.prototype.negate=pointFpNegate,ECPointFp.prototype.add=pointFpAdd,ECPointFp.prototype.twice=pointFpTwice,ECPointFp.prototype.multiply=pointFpMultiply,ECPointFp.prototype.multiplyTwo=pointFpMultiplyTwo,ECCurveFp.prototype.getQ=curveFpGetQ,ECCurveFp.prototype.getA=curveFpGetA,ECCurveFp.prototype.getB=curveFpGetB,ECCurveFp.prototype.equals=curveFpEquals,ECCurveFp.prototype.getInfinity=curveFpGetInfinity,ECCurveFp.prototype.fromBigInteger=curveFpFromBigInteger,ECCurveFp.prototype.decodePointHex=curveFpDecodePointHex,ECFieldElementFp.prototype.getByteLength=function(){return Math.floor((this.toBigInteger().bitLength()+7)/8)},ECPointFp.prototype.getEncoded=function(t){var e=function(t,e){var i=t.toByteArrayUnsigned();if(e<i.length)i=i.slice(i.length-e);else for(;e>i.length;)i.unshift(0);return i},i=this.getX().toBigInteger(),n=this.getY().toBigInteger(),r=e(i,32);return t?n.isEven()?r.unshift(2):r.unshift(3):(r.unshift(4),r=r.concat(e(n,32))),r},ECPointFp.decodeFrom=function(t,e){var i=(e[0],e.length-1),n=e.slice(1,1+i/2),r=e.slice(1+i/2,1+i);n.unshift(0),r.unshift(0);var s=new BigInteger(n),o=new BigInteger(r);return new ECPointFp(t,t.fromBigInteger(s),t.fromBigInteger(o))},ECPointFp.decodeFromHex=function(t,e){var i=(e.substr(0,2),e.length-2),n=e.substr(2,i/2),r=e.substr(2+i/2,i/2),s=new BigInteger(n,16),o=new BigInteger(r,16);return new ECPointFp(t,t.fromBigInteger(s),t.fromBigInteger(o))},ECPointFp.prototype.add2D=function(t){if(this.isInfinity())return t;if(t.isInfinity())return this;if(this.x.equals(t.x))return this.y.equals(t.y)?this.twice():this.curve.getInfinity();var e=t.x.subtract(this.x),i=t.y.subtract(this.y),n=i.divide(e),r=n.square().subtract(this.x).subtract(t.x),s=n.multiply(this.x.subtract(r)).subtract(this.y);return new ECPointFp(this.curve,r,s)},ECPointFp.prototype.twice2D=function(){if(this.isInfinity())return this;if(0==this.y.toBigInteger().signum())return this.curve.getInfinity();var t=this.curve.fromBigInteger(BigInteger.valueOf(2)),e=this.curve.fromBigInteger(BigInteger.valueOf(3)),i=this.x.square().multiply(e).add(this.curve.a).divide(this.y.multiply(t)),n=i.square().subtract(this.x.multiply(t)),r=i.multiply(this.x.subtract(n)).subtract(this.y);return new ECPointFp(this.curve,n,r)},ECPointFp.prototype.multiply2D=function(t){if(this.isInfinity())return this;if(0==t.signum())return this.curve.getInfinity();var e,i=t,n=i.multiply(new BigInteger("3")),r=this.negate(),s=this;for(e=n.bitLength()-2;e>0;--e){s=s.twice();var o=n.testBit(e);o!=i.testBit(e)&&(s=s.add2D(o?this:r))}return s},ECPointFp.prototype.isOnCurve=function(){var t=this.getX().toBigInteger(),e=this.getY().toBigInteger(),i=this.curve.getA().toBigInteger(),n=this.curve.getB().toBigInteger(),r=this.curve.getQ(),s=e.multiply(e).mod(r),o=t.multiply(t).multiply(t).add(i.multiply(t)).add(n).mod(r);return s.equals(o)},ECPointFp.prototype.toString=function(){return"("+this.getX().toBigInteger().toString()+","+this.getY().toBigInteger().toString()+")"},ECPointFp.prototype.validate=function(){var t=this.curve.getQ();if(this.isInfinity())throw new Error("Point is at infinity.");var e=this.getX().toBigInteger(),i=this.getY().toBigInteger();if(e.compareTo(BigInteger.ONE)<0||e.compareTo(t.subtract(BigInteger.ONE))>0)throw new Error("x coordinate out of bounds");if(i.compareTo(BigInteger.ONE)<0||i.compareTo(t.subtract(BigInteger.ONE))>0)throw new Error("y coordinate out of bounds");if(!this.isOnCurve())throw new Error("Point is not on the curve.");if(this.multiply(t).isInfinity())throw new Error("Point is not a scalar multiple of G.");return!0},void 0!==KJUR&&KJUR||(KJUR={}),void 0!==KJUR.crypto&&KJUR.crypto||(KJUR.crypto={}),KJUR.crypto.ECDSA=function(t){var e=new SecureRandom;this.type="EC",this.getBigRandom=function(t){return new BigInteger(t.bitLength(),e).mod(t.subtract(BigInteger.ONE)).add(BigInteger.ONE)},this.setNamedCurve=function(t){this.ecparams=KJUR.crypto.ECParameterDB.getByName(t),this.prvKeyHex=null,this.pubKeyHex=null,this.curveName=t},this.setPrivateKeyHex=function(t){this.isPrivate=!0,this.prvKeyHex=t},this.setPublicKeyHex=function(t){this.isPublic=!0,this.pubKeyHex=t},this.generateKeyPairHex=function(){for(var t=this.ecparams.n,e=this.getBigRandom(t),i=this.ecparams.G.multiply(e),n=i.getX().toBigInteger(),r=i.getY().toBigInteger(),s=this.ecparams.keylen/4,o=("0000000000"+e.toString(16)).slice(-s),a=("0000000000"+n.toString(16)).slice(-s),h=("0000000000"+r.toString(16)).slice(-s);64!==o.length&&(o="0"+o,!(o.length>64)););for(;64!==a.length&&(a="0"+a,!(a.length>64)););for(;64!==h.length&&(h="0"+h,!(h.length>64)););var c="04"+a+h;return this.setPrivateKeyHex(o),this.setPublicKeyHex(c),{ecprvhex:o,ecpubhex:c}},this.signWithMessageHash=function(t){return this.signHex(t,this.prvKeyHex)},this.signHex=function(t,e){var i=new BigInteger(e,16),n=this.ecparams.n,r=new BigInteger(t,16);do{var s=this.getBigRandom(n),o=this.ecparams.G,a=o.multiply(s),h=a.getX().toBigInteger().mod(n)}while(h.compareTo(BigInteger.ZERO)<=0);var c=s.modInverse(n).multiply(r.add(i.multiply(h))).mod(n);return KJUR.crypto.ECDSA.biRSSigToASN1Sig(h,c)},this.sign=function(t,e){var i=e,n=this.ecparams.n,r=BigInteger.fromByteArrayUnsigned(t);do{var s=this.getBigRandom(n),o=this.ecparams.G,a=o.multiply(s),h=a.getX().toBigInteger().mod(n)}while(h.compareTo(BigInteger.ZERO)<=0);var c=s.modInverse(n).multiply(r.add(i.multiply(h))).mod(n);return this.serializeSig(h,c)},this.verifyWithMessageHash=function(t,e){return this.verifyHex(t,e,this.pubKeyHex)},this.verifyHex=function(t,e,i){var n,r,s=KJUR.crypto.ECDSA.parseSigHex(e);n=s.r,r=s.s;var o;o=ECPointFp.decodeFromHex(this.ecparams.curve,i);var a=new BigInteger(t,16);return this.verifyRaw(a,n,r,o)},this.verify=function(t,e,i){var n,r;if(Bitcoin.Util.isArray(e)){var s=this.parseSig(e);n=s.r,r=s.s}else{if("object"!==(void 0===e?"undefined":_typeof(e))||!e.r||!e.s)throw"Invalid value for signature";n=e.r,r=e.s}var o;if(i instanceof ECPointFp)o=i;else{if(!Bitcoin.Util.isArray(i))throw"Invalid format for pubkey value, must be byte array or ECPointFp";o=ECPointFp.decodeFrom(this.ecparams.curve,i)}var a=BigInteger.fromByteArrayUnsigned(t);return this.verifyRaw(a,n,r,o)},this.verifyRaw=function(t,e,i,n){var r=this.ecparams.n,s=this.ecparams.G;if(e.compareTo(BigInteger.ONE)<0||e.compareTo(r)>=0)return!1;if(i.compareTo(BigInteger.ONE)<0||i.compareTo(r)>=0)return!1;var o=i.modInverse(r),a=t.multiply(o).mod(r),h=e.multiply(o).mod(r);return s.multiply(a).add(n.multiply(h)).getX().toBigInteger().mod(r).equals(e)},this.serializeSig=function(t,e){var i=t.toByteArraySigned(),n=e.toByteArraySigned(),r=[];return r.push(2),r.push(i.length),r=r.concat(i),r.push(2),r.push(n.length),r=r.concat(n),r.unshift(r.length),r.unshift(48),r},this.parseSig=function(t){var e;if(48!=t[0])throw new Error("Signature not a valid DERSequence");if(e=2,2!=t[e])throw new Error("First element in signature must be a DERInteger");var i=t.slice(e+2,e+2+t[e+1]);if(e+=2+t[e+1],2!=t[e])throw new Error("Second element in signature must be a DERInteger");var n=t.slice(e+2,e+2+t[e+1]);return e+=2+t[e+1],{r:BigInteger.fromByteArrayUnsigned(i),s:BigInteger.fromByteArrayUnsigned(n)}},this.parseSigCompact=function(t){if(65!==t.length)throw"Signature has the wrong length";var e=t[0]-27;if(e<0||e>7)throw"Invalid signature type";var i=this.ecparams.n;return{r:BigInteger.fromByteArrayUnsigned(t.slice(1,33)).mod(i),s:BigInteger.fromByteArrayUnsigned(t.slice(33,65)).mod(i),i:e}},void 0!==t&&void 0!==t.curve&&(this.curveName=t.curve),void 0===this.curveName&&(this.curveName="secp256r1"),this.setNamedCurve(this.curveName),void 0!==t&&(void 0!==t.prv&&this.setPrivateKeyHex(t.prv),void 0!==t.pub&&this.setPublicKeyHex(t.pub))},KJUR.crypto.ECDSA.parseSigHex=function(t){var e=KJUR.crypto.ECDSA.parseSigHexInHexRS(t);return{r:new BigInteger(e.r,16),s:new BigInteger(e.s,16)}},KJUR.crypto.ECDSA.parseSigHexInHexRS=function(t){if("30"!=t.substr(0,2))throw"signature is not a ASN.1 sequence";var e=ASN1HEX.getPosArrayOfChildren_AtObj(t,0);if(2!=e.length)throw"number of signature ASN.1 sequence elements seem wrong";var i=e[0],n=e[1];if("02"!=t.substr(i,2))throw"1st item of sequene of signature is not ASN.1 integer";if("02"!=t.substr(n,2))throw"2nd item of sequene of signature is not ASN.1 integer";return{r:ASN1HEX.getHexOfV_AtObj(t,i),s:ASN1HEX.getHexOfV_AtObj(t,n)}},KJUR.crypto.ECDSA.asn1SigToConcatSig=function(t){var e=KJUR.crypto.ECDSA.parseSigHexInHexRS(t),i=e.r,n=e.s;if("00"==i.substr(0,2)&&i.length/2*8%128==8&&(i=i.substr(2)),"00"==n.substr(0,2)&&n.length/2*8%128==8&&(n=n.substr(2)),i.length/2*8%128!=0)throw"unknown ECDSA sig r length error";if(n.length/2*8%128!=0)throw"unknown ECDSA sig s length error";return i+n},KJUR.crypto.ECDSA.concatSigToASN1Sig=function(t){if(t.length/2*8%128!=0)throw"unknown ECDSA concatinated r-s sig  length error";var e=t.substr(0,t.length/2),i=t.substr(t.length/2);return KJUR.crypto.ECDSA.hexRSSigToASN1Sig(e,i)},KJUR.crypto.ECDSA.hexRSSigToASN1Sig=function(t,e){var i=new BigInteger(t,16),n=new BigInteger(e,16);return KJUR.crypto.ECDSA.biRSSigToASN1Sig(i,n)},KJUR.crypto.ECDSA.biRSSigToASN1Sig=function(t,e){var i=new KJUR.asn1.DERInteger({bigint:t}),n=new KJUR.asn1.DERInteger({bigint:e});return new KJUR.asn1.DERSequence({array:[i,n]}).getEncodedHex()},function(){var t=CryptoJS,e=t.lib,i=e.WordArray,n=e.Hasher,r=t.algo,s=[],o=r.SM3=n.extend({_doReset:function(){this._hash=new i.init([1937774191,1226093241,388252375,3666478592,2842636476,372324522,3817729613,2969243214])},_doProcessBlock:function(t,e){for(var i=this._hash.words,n=i[0],r=i[1],o=i[2],a=i[3],h=i[4],c=0;c<80;c++){if(c<16)s[c]=0|t[e+c];else{var u=s[c-3]^s[c-8]^s[c-14]^s[c-16];s[c]=u<<1|u>>>31}var l=(n<<5|n>>>27)+h+s[c];l+=c<20?1518500249+(r&o|~r&a):c<40?1859775393+(r^o^a):c<60?(r&o|r&a|o&a)-1894007588:(r^o^a)-899497514,h=a,a=o,o=r<<30|r>>>2,r=n,n=l}i[0]=i[0]+n|0,i[1]=i[1]+r|0,i[2]=i[2]+o|0,i[3]=i[3]+a|0,i[4]=i[4]+h|0},_doFinalize:function(){var t=this._data,e=t.words,i=8*this._nDataBytes,n=8*t.sigBytes;return e[n>>>5]|=128<<24-n%32,e[14+(n+64>>>9<<4)]=Math.floor(i/4294967296),e[15+(n+64>>>9<<4)]=i,t.sigBytes=4*e.length,this._process(),this._hash},clone:function(){var t=n.clone.call(this);return t._hash=this._hash.clone(),t}});t.SM3=n._createHelper(o),t.HmacSM3=n._createHmacHelper(o)}(),SM3Digest.prototype={Init:function(){this.xBuf=new Array(4),this.Reset()},InitDigest:function(t){this.xBuf=new Array(t.xBuf.length),Array.Copy(t.xBuf,0,this.xBuf,0,t.xBuf.length),this.xBufOff=t.xBufOff,this.byteCount=t.byteCount,Array.Copy(t.X,0,this.X,0,t.X.length),this.xOff=t.xOff,Array.Copy(t.v,0,this.v,0,t.v.length)},GetDigestSize:function(){return this.DIGEST_LENGTH},Reset:function(){this.byteCount=0,this.xBufOff=0,Array.Clear(this.xBuf,0,this.xBuf.length),Array.Copy(this.v0,0,this.v,0,this.v0.length),this.xOff=0,Array.Copy(this.X0,0,this.X,0,this.X0.length)},GetByteLength:function(){return this.BYTE_LENGTH},ProcessBlock:function(){var t,e=this.X,i=new Array(64);for(t=16;t<68;t++)e[t]=this.P1(e[t-16]^e[t-9]^this.ROTATE(e[t-3],15))^this.ROTATE(e[t-13],7)^e[t-6];for(t=0;t<64;t++)i[t]=e[t]^e[t+4];var n=this.v,r=this.v_;Array.Copy(n,0,r,0,this.v0.length);var s,o,a,h,c;for(t=0;t<16;t++)c=this.ROTATE(r[0],12),s=Int32.parse(Int32.parse(c+r[4])+this.ROTATE(this.T_00_15,t)),s=this.ROTATE(s,7),o=s^c,a=Int32.parse(Int32.parse(this.FF_00_15(r[0],r[1],r[2])+r[3])+o)+i[t],h=Int32.parse(Int32.parse(this.GG_00_15(r[4],r[5],r[6])+r[7])+s)+e[t],r[3]=r[2],r[2]=this.ROTATE(r[1],9),r[1]=r[0],r[0]=a,r[7]=r[6],r[6]=this.ROTATE(r[5],19),r[5]=r[4],r[4]=this.P0(h);for(t=16;t<64;t++)c=this.ROTATE(r[0],12),s=Int32.parse(Int32.parse(c+r[4])+this.ROTATE(this.T_16_63,t)),s=this.ROTATE(s,7),o=s^c,a=Int32.parse(Int32.parse(this.FF_16_63(r[0],r[1],r[2])+r[3])+o)+i[t],h=Int32.parse(Int32.parse(this.GG_16_63(r[4],r[5],r[6])+r[7])+s)+e[t],r[3]=r[2],r[2]=this.ROTATE(r[1],9),r[1]=r[0],r[0]=a,r[7]=r[6],r[6]=this.ROTATE(r[5],19),r[5]=r[4],r[4]=this.P0(h);for(t=0;t<8;t++)n[t]^=Int32.parse(r[t]);this.xOff=0,Array.Copy(this.X0,0,this.X,0,this.X0.length)},ProcessWord:function(t,e){var i=t[e]<<24;i|=(255&t[++e])<<16,i|=(255&t[++e])<<8,i|=255&t[++e],this.X[this.xOff]=i,16==++this.xOff&&this.ProcessBlock()},ProcessLength:function(t){this.xOff>14&&this.ProcessBlock(),this.X[14]=this.URShiftLong(t,32),this.X[15]=4294967295&t},IntToBigEndian:function(t,e,i){e[i]=Int32.parseByte(this.URShift(t,24)),e[++i]=Int32.parseByte(this.URShift(t,16)),e[++i]=Int32.parseByte(this.URShift(t,8)),e[++i]=Int32.parseByte(t)},DoFinal:function(t,e){this.Finish();for(var i=0;i<8;i++)this.IntToBigEndian(this.v[i],t,e+4*i);return this.Reset(),this.DIGEST_LENGTH},Update:function(t){this.xBuf[this.xBufOff++]=t,this.xBufOff==this.xBuf.length&&(this.ProcessWord(this.xBuf,0),this.xBufOff=0),this.byteCount++},BlockUpdate:function(t,e,i){for(;0!=this.xBufOff&&i>0;)this.Update(t[e]),e++,i--;for(;i>this.xBuf.length;)this.ProcessWord(t,e),e+=this.xBuf.length,i-=this.xBuf.length,this.byteCount+=this.xBuf.length;for(;i>0;)this.Update(t[e]),e++,i--},Finish:function(){var t=this.byteCount<<3;for(this.Update(128);0!=this.xBufOff;)this.Update(0);this.ProcessLength(t),this.ProcessBlock()},ROTATE:function(t,e){return t<<e|this.URShift(t,32-e)},P0:function(t){return t^this.ROTATE(t,9)^this.ROTATE(t,17)},P1:function(t){return t^this.ROTATE(t,15)^this.ROTATE(t,23)},FF_00_15:function(t,e,i){return t^e^i},FF_16_63:function(t,e,i){return t&e|t&i|e&i},GG_00_15:function(t,e,i){return t^e^i},GG_16_63:function(t,e,i){return t&e|~t&i},URShift:function(t,e){return(t>Int32.maxValue||t<Int32.minValue)&&(t=Int32.parse(t)),t>=0?t>>e:(t>>e)+(2<<~e)},URShiftLong:function(t,e){var i,n=new BigInteger;if(n.fromInt(t),n.signum()>=0)i=n.shiftRight(e).intValue();else{var r=new BigInteger;r.fromInt(2);var s=~e,o="";if(s<0){for(var a=64+s,h=0;h<a;h++)o+="0";var c=new BigInteger;c.fromInt(t>>e);var u=new BigInteger("10"+o,2);o=u.toRadix(10);i=u.add(c).toRadix(10)}else o=r.shiftLeft(~e).intValue(),i=(t>>e)+o}return i},GetZ:function(t,e){var i=CryptoJS.enc.Utf8.parse("1234567812345678"),n=4*i.words.length*8;this.Update(n>>8&255),this.Update(255&n);var r=this.GetWords(i.toString());this.BlockUpdate(r,0,r.length);var s=this.GetWords(t.curve.a.toBigInteger().toRadix(16)),o=this.GetWords(t.curve.b.toBigInteger().toRadix(16)),a=this.GetWords(t.getX().toBigInteger().toRadix(16)),h=this.GetWords(t.getY().toBigInteger().toRadix(16)),c=this.GetWords(e.substr(0,64)),u=this.GetWords(e.substr(64,64));this.BlockUpdate(s,0,s.length),this.BlockUpdate(o,0,o.length),this.BlockUpdate(a,0,a.length),this.BlockUpdate(h,0,h.length),this.BlockUpdate(c,0,c.length),this.BlockUpdate(u,0,u.length);var l=new Array(this.GetDigestSize());return this.DoFinal(l,0),l},GetWords:function(t){for(var e=[],i=t.length,n=0;n<i;n+=2)e[e.length]=parseInt(t.substr(n,2),16);return e},GetHex:function(t){for(var e=[],i=0,n=0;n<2*t.length;n+=2)e[n>>>3]|=parseInt(t[i])<<24-n%8*4,i++;return new CryptoJS.lib.WordArray.init(e,t.length)}},Array.Clear=function(t,e,i){for(var n in t)t[n]=null},Array.Copy=function(t,e,i,n,r){for(var s=t.slice(e,e+r),o=0;o<s.length;o++)i[n]=s[o],n++},window.Int32={minValue:-parseInt("10000000000000000000000000000000",2),maxValue:parseInt("1111111111111111111111111111111",2),parse:function(t){if(t<this.minValue){for(var e=new Number(-t),i=e.toString(2),n=i.substr(i.length-31,31),r="",s=0;s<n.length;s++){var o=n.substr(s,1);r+="0"==o?"1":"0"}var a=parseInt(r,2);return a+1}if(t>this.maxValue){for(var e=Number(t),i=e.toString(2),n=i.substr(i.length-31,31),r="",s=0;s<n.length;s++){var o=n.substr(s,1);r+="0"==o?"1":"0"}var a=parseInt(r,2);return-(a+1)}return t},parseByte:function(t){if(t<0){for(var e=new Number(-t),i=e.toString(2),n=i.substr(i.length-8,8),r="",s=0;s<n.length;s++){r+="0"==n.substr(s,1)?"1":"0"}var o=parseInt(r,2);return 255==o?0:o+1}if(t>255){var e=Number(t),i=e.toString(2),o=parseInt(i.substr(i.length-8,8),2);return o}return t}},void 0!==KJUR&&KJUR||(KJUR={}),void 0!==KJUR.crypto&&KJUR.crypto||(KJUR.crypto={}),KJUR.crypto.SM3withSM2=function(t){var e=new SecureRandom;this.type="SM2",this.getBigRandom=function(t){return new BigInteger(t.bitLength(),e).mod(t.subtract(BigInteger.ONE)).add(BigInteger.ONE)},this.setNamedCurve=function(t){this.ecparams=KJUR.crypto.ECParameterDB.getByName(t),this.prvKeyHex=null,this.pubKeyHex=null,this.curveName=t},this.setPrivateKeyHex=function(t){this.isPrivate=!0,this.prvKeyHex=t},this.setPublicKeyHex=function(t){this.isPublic=!0,this.pubKeyHex=t},this.generateKeyPairHex=function(){var t=this.ecparams.n,e=this.getBigRandom(t),i=this.ecparams.G.multiply(e),n=i.getX().toBigInteger(),r=i.getY().toBigInteger(),s=this.ecparams.keylen/4,o=("0000000000"+e.toString(16)).slice(-s),a=("0000000000"+n.toString(16)).slice(-s),h=("0000000000"+r.toString(16)).slice(-s),c="04"+a+h;return this.setPrivateKeyHex(o),this.setPublicKeyHex(c),{ecprvhex:o,ecpubhex:c}},this.signWithMessageHash=function(t){return this.signHex(t,this.prvKeyHex)},this.signHex=function(t,e){var i=new BigInteger(e,16),n=this.ecparams.n,r=new BigInteger(t,16),s=null,o=null,a=null,h=null,c=i;do{do{var u=this.generateKeyPairHex();s=new BigInteger(u.ecprvhex,16);var l=u.ecpubhex;o=ECPointFp.decodeFromHex(this.ecparams.curve,l),a=r.add(o.getX().toBigInteger()),a=a.mod(n)}while(a.equals(BigInteger.ZERO)||a.add(s).equals(n));var f=c.add(BigInteger.ONE);f=f.modInverse(n),h=a.multiply(c),h=s.subtract(h).mod(n),h=f.multiply(h).mod(n)}while(h.equals(BigInteger.ZERO));return KJUR.crypto.ECDSA.biRSSigToASN1Sig(a,h)},this.sign=function(t,e){var i=e,n=this.ecparams.n,r=BigInteger.fromByteArrayUnsigned(t);do{var s=this.getBigRandom(n),o=this.ecparams.G,a=o.multiply(s),h=a.getX().toBigInteger().mod(n)}while(h.compareTo(BigInteger.ZERO)<=0);var c=s.modInverse(n).multiply(r.add(i.multiply(h))).mod(n);return this.serializeSig(h,c)},this.verifyWithMessageHash=function(t,e){return this.verifyHex(t,e,this.pubKeyHex)},this.verifyHex=function(t,e,i){var n,r,s=KJUR.crypto.ECDSA.parseSigHex(e);n=s.r,r=s.s;var o;o=ECPointFp.decodeFromHex(this.ecparams.curve,i);var a=new BigInteger(t,16);return this.verifyRaw(a,n,r,o)},this.verify=function(t,e,i){var n,r;if(Bitcoin.Util.isArray(e)){var s=this.parseSig(e);n=s.r,r=s.s}else{if("object"!==(void 0===e?"undefined":_typeof(e))||!e.r||!e.s)throw"Invalid value for signature";n=e.r,r=e.s}var o;if(i instanceof ECPointFp)o=i;else{if(!Bitcoin.Util.isArray(i))throw"Invalid format for pubkey value, must be byte array or ECPointFp";o=ECPointFp.decodeFrom(this.ecparams.curve,i)}var a=BigInteger.fromByteArrayUnsigned(t);return this.verifyRaw(a,n,r,o)},this.verifyRaw=function(t,e,i,n){var r=this.ecparams.n,s=this.ecparams.G,o=e.add(i).mod(r);if(o.equals(BigInteger.ZERO))return!1;var a=s.multiply(i);a=a.add(n.multiply(o));var h=t.add(a.getX().toBigInteger()).mod(r);return e.equals(h)},this.serializeSig=function(t,e){var i=t.toByteArraySigned(),n=e.toByteArraySigned(),r=[];return r.push(2),r.push(i.length),r=r.concat(i),r.push(2),r.push(n.length),r=r.concat(n),r.unshift(r.length),r.unshift(48),r},this.parseSig=function(t){var e;if(48!=t[0])throw new Error("Signature not a valid DERSequence");if(e=2,2!=t[e])throw new Error("First element in signature must be a DERInteger");var i=t.slice(e+2,e+2+t[e+1]);if(e+=2+t[e+1],2!=t[e])throw new Error("Second element in signature must be a DERInteger");var n=t.slice(e+2,e+2+t[e+1]);return e+=2+t[e+1],{r:BigInteger.fromByteArrayUnsigned(i),s:BigInteger.fromByteArrayUnsigned(n)}},this.parseSigCompact=function(t){if(65!==t.length)throw"Signature has the wrong length";var e=t[0]-27;if(e<0||e>7)throw"Invalid signature type";var i=this.ecparams.n;return{r:BigInteger.fromByteArrayUnsigned(t.slice(1,33)).mod(i),s:BigInteger.fromByteArrayUnsigned(t.slice(33,65)).mod(i),i:e}},void 0!==t&&void 0!==t.curve&&(this.curveName=t.curve),void 0===this.curveName&&(this.curveName="sm2"),this.setNamedCurve(this.curveName),void 0!==t&&(void 0!==t.prv&&this.setPrivateKeyHex(t.prv),void 0!==t.pub&&this.setPublicKeyHex(t.pub))},void 0!==KJUR&&KJUR||(KJUR={}),void 0!==KJUR.crypto&&KJUR.crypto||(KJUR.crypto={}),KJUR.crypto.ECParameterDB=new function(){function t(t){return new BigInteger(t,16)}var e={},i={};this.getByName=function(t){var n=t;if(void 0!==i[n]&&(n=i[t]),void 0!==e[n])return e[n];throw"unregistered EC curve name: "+n},this.regist=function(n,r,s,o,a,h,c,u,l,f,p,g){e[n]={};var d=t(s),m=t(o),y=t(a),v=t(h),F=t(c),b=new ECCurveFp(d,m,y),A=b.decodePointHex("04"+u+l);e[n].name=n,e[n].keylen=r,e[n].curve=b,e[n].G=A,e[n].n=v,e[n].h=F,e[n].oid=p,e[n].info=g;for(var S=0;S<f.length;S++)i[f[S]]=n}},KJUR.crypto.ECParameterDB.regist("secp128r1",128,"FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFC","E87579C11079F43DD824993C2CEE5ED3","FFFFFFFE0000000075A30D1B9038A115","1","161FF7528B899B2D0C28607CA52C5B86","CF5AC8395BAFEB13C02DA292DDED7A83",[],"","secp128r1 : SECG curve over a 128 bit prime field"),KJUR.crypto.ECParameterDB.regist("secp160k1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFAC73","0","7","0100000000000000000001B8FA16DFAB9ACA16B6B3","1","3B4C382CE37AA192A4019E763036F4F5DD4D7EBB","938CF935318FDCED6BC28286531733C3F03C4FEE",[],"","secp160k1 : SECG curve over a 160 bit prime field"),KJUR.crypto.ECParameterDB.regist("secp160r1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFC","1C97BEFC54BD7A8B65ACF89F81D4D4ADC565FA45","0100000000000000000001F4C8F927AED3CA752257","1","4A96B5688EF573284664698968C38BB913CBFC82","23A628553168947D59DCC912042351377AC5FB32",[],"","secp160r1 : SECG curve over a 160 bit prime field"),KJUR.crypto.ECParameterDB.regist("secp192k1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFEE37","0","3","FFFFFFFFFFFFFFFFFFFFFFFE26F2FC170F69466A74DEFD8D","1","DB4FF10EC057E9AE26B07D0280B7F4341DA5D1B1EAE06C7D","9B2F2F6D9C5628A7844163D015BE86344082AA88D95E2F9D",[]),KJUR.crypto.ECParameterDB.regist("secp192r1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFC","64210519E59C80E70FA7E9AB72243049FEB8DEECC146B9B1","FFFFFFFFFFFFFFFFFFFFFFFF99DEF836146BC9B1B4D22831","1","188DA80EB03090F67CBF20EB43A18800F4FF0AFD82FF1012","07192B95FFC8DA78631011ED6B24CDD573F977A11E794811",[]),KJUR.crypto.ECParameterDB.regist("secp224r1",224,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000001","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFE","B4050A850C04B3ABF54132565044B0B7D7BFD8BA270B39432355FFB4","FFFFFFFFFFFFFFFFFFFFFFFFFFFF16A2E0B8F03E13DD29455C5C2A3D","1","B70E0CBD6BB4BF7F321390B94A03C1D356C21122343280D6115C1D21","BD376388B5F723FB4C22DFE6CD4375A05A07476444D5819985007E34",[]),KJUR.crypto.ECParameterDB.regist("secp256k1",256,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F","0","7","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141","1","79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798","483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8",[]),KJUR.crypto.ECParameterDB.regist("secp256r1",256,"FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC","5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B","FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551","1","6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296","4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5",["NIST P-256","P-256","prime256v1"]),KJUR.crypto.ECParameterDB.regist("secp384r1",384,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFC","B3312FA7E23EE7E4988E056BE3F82D19181D9C6EFE8141120314088F5013875AC656398D8A2ED19D2A85C8EDD3EC2AEF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC7634D81F4372DDF581A0DB248B0A77AECEC196ACCC52973","1","AA87CA22BE8B05378EB1C71EF320AD746E1D3B628BA79B9859F741E082542A385502F25DBF55296C3A545E3872760AB7","3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f",["NIST P-384","P-384"]),KJUR.crypto.ECParameterDB.regist("secp521r1",521,"1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC","051953EB9618E1C9A1F929A21A0B68540EEA2DA725B99B315F3B8B489918EF109E156193951EC7E937B1652C0BD3BB1BF073573DF883D2C34F1EF451FD46B503F00","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA51868783BF2F966B7FCC0148F709A5D03BB5C9B8899C47AEBB6FB71E91386409","1","C6858E06B70404E9CD9E3ECB662395B4429C648139053FB521F828AF606B4D3DBAA14B5E77EFE75928FE1DC127A2FFA8DE3348B3C1856A429BF97E7E31C2E5BD66","011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650",["NIST P-521","P-521"]),KJUR.crypto.ECParameterDB.regist("sm2",256,"FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF00000000FFFFFFFFFFFFFFFF","FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF00000000FFFFFFFFFFFFFFFC","28E9FA9E9D9F5E344D5A9E4BCF6509A7F39789F515AB8F92DDBCBD414D940E93","FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFF7203DF6B21C6052B53BBF40939D54123","1","32C4AE2C1F1981195F9904466A39C9948FE30BBFF2660BE1715A4589334C74C7","BC3736A2F4F6779C59BDCEE36B692153D0A9877CC62A474002DF32E52139F0A0",["sm2","SM2"]),SM2Cipher.prototype={Reset:function(){this.sm3keybase=new SM3Digest,this.sm3c3=new SM3Digest;for(var t=this.p2.getX().toBigInteger().toRadix(16);64!==t.length;)t="0"+t;var e=this.GetWords(t);for(t=this.p2.getY().toBigInteger().toRadix(16);64!==t.length;)t="0"+t;var i=this.GetWords(t);this.sm3keybase.BlockUpdate(e,0,e.length),this.sm3c3.BlockUpdate(e,0,e.length),this.sm3keybase.BlockUpdate(i,0,i.length),this.ct=1,this.NextKey()},NextKey:function(){var t=new SM3Digest(this.sm3keybase);t.Update(this.ct>>24&255),t.Update(this.ct>>16&255),t.Update(this.ct>>8&255),t.Update(255&this.ct),t.DoFinal(this.key,0),this.keyOff=0,this.ct++},InitEncipher:function(t){for(var e=null,i=null,n=new KJUR.crypto.ECDSA({curve:"sm2"}),r=n.generateKeyPairHex();64!==r.ecprvhex.length&&(r.ecprvhex="0"+r.ecprvhex,!(r.ecprvhex.length>64)););e=new BigInteger(r.ecprvhex,16);var s=r.ecpubhex;return i=ECPointFp.decodeFromHex(n.ecparams.curve,s),this.p2=t.multiply(e),this.Reset(),i},EncryptBlock:function(t){this.sm3c3.BlockUpdate(t,0,t.length);for(var e=0;e<t.length;e++)this.keyOff==this.key.length&&this.NextKey(),t[e]^=this.key[this.keyOff++]},InitDecipher:function(t,e){this.p2=e.multiply(t),this.Reset()},DecryptBlock:function(t){for(var e=0;e<t.length;e++)this.keyOff==this.key.length&&this.NextKey(),t[e]^=this.key[this.keyOff++];this.sm3c3.BlockUpdate(t,0,t.length)},Dofinal:function(t){for(var e=this.p2.getY().toBigInteger().toRadix(16);64!==e.length&&(e="0"+e,!(e.length>64)););var i=this.GetWords(e);this.sm3c3.BlockUpdate(i,0,i.length),this.sm3c3.DoFinal(t,0),this.Reset()},Encrypt:function(t,e){var i=new Array(e.length);Array.Copy(e,0,i,0,e.length);var n=this.InitEncipher(t);this.EncryptBlock(i);var r=new Array(32);this.Dofinal(r);for(var s=n.getX().toBigInteger().toRadix(16),o=n.getY().toBigInteger().toRadix(16);s.length<64;)64!==s.length&&(s="0"+s);for(;o.length<64;)64!==o.length&&(o="0"+o);var a=s+o+this.GetHex(i).toString()+this.GetHex(r).toString();return this.cipherMode==SM2CipherMode.C1C3C2&&(a=s+o+this.GetHex(r).toString()+this.GetHex(i).toString()),a},GetWords:function(t){for(var e=[],i=t.length,n=0;n<i;n+=2)e[e.length]=parseInt(t.substr(n,2),16);return e},GetHex:function(t){for(var e=[],i=0,n=0;n<2*t.length;n+=2)e[n>>>3]|=parseInt(t[i])<<24-n%8*4,i++;return new CryptoJS.lib.WordArray.init(e,t.length)},Decrypt:function(t,e){var i=e,n=i.substr(0,64),r=i.substr(0+n.length,64),s=i.substr(n.length+r.length,i.length-n.length-r.length-64),o=i.substr(i.length-64);this.cipherMode==SM2CipherMode.C1C3C2&&(o=i.substr(n.length+r.length,64),s=i.substr(n.length+r.length+64));var a=this.GetWords(s),h=this.CreatePoint(n,r);this.InitDecipher(t,h),this.DecryptBlock(a);var c=new Array(32);if(this.Dofinal(c),this.GetHex(c).toString()==o){var u=this.GetHex(a);return CryptoJS.enc.Utf8.stringify(u)}return""},CreatePoint:function(t,e){var i=new KJUR.crypto.ECDSA({curve:"sm2"}),n=(i.ecparams.curve,"04"+t+e);return ECPointFp.decodeFromHex(i.ecparams.curve,n)}},window.SM2CipherMode={C1C2C3:"0",C1C3C2:"1"};var SM2GM={mode:{}};SM2GM.mode.gm={name:"gm",doGenerate:function(){return new KJUR.crypto.ECDSA({curve:"sm2"}).generateKeyPairHex()},doGetPubkey:function(t){return t.ecpubhex},doGetPrvkey:function(t){return t.ecprvhex},doSign:function(t,e){var i=new KJUR.crypto.Signature({alg:"SM3withSM2",prov:"cryptojs/jsrsa"});return i.initSign({ecprvhex:t,eccurvename:"sm2"}),i.updateString(e),i.nakedsign()},doVerify:function(t,e,i){var n=new KJUR.crypto.Signature({alg:"SM3withSM2",prov:"cryptojs/jsrsa"});return n.initVerifyByPublicKey({ecpubhex:t,eccurvename:"sm2"}),n.updateString(e),n.nakedverify(i)},doCrypt:function(t,e){var i=CryptoJS.enc.Utf8.parse(e),n=t;n.length>128&&(n=n.substr(n.length-128));var r=n.substr(0,64),s=n.substr(64),o=new SM2Cipher("0"),a=o.CreatePoint(r,s);return i=o.GetWords(i.toString()),o.Encrypt(a,i)},doCryptAsn1:function(t,e){var i=this.doCrypt(t,e),n=i.substr(0,64),r=i.substr(64,64),s=i.substr(128,i.length-64-64-64),o=i.substr(i.length-64,64),a="";a=n[0]>"7"?"022100"+n:"0220"+n,r[0]>"7"?a+="022100"+r:a+="0220"+r,a+="0420"+o;var h=(s.length/2).toString(16);h.length<2?a+="040"+h+s:a+="04"+h+s;var c="";h=a.length/2,c=h>128?"3081"+h.toString(16)+a:"30"+h.toString(16)+a;var u=_sjcl2.default.codec.hex.toBits(c);return encodeURIComponent(_sjcl2.default.codec.base64.fromBits(u))},doDecrypt:function(t,e){var i=e,n=new BigInteger(t,16),e=new SM2Cipher("0");return e.Decrypt(n,i)}},exports.default=SM2GM.mode.gm},function(t,e,i){"use strict";var n=i(11);t.exports=n,e.Segment=n,e.POSTAG=i(3)},function(t,e,n){"use strict";function r(){s=localStorage.getItem("dict_segment"),o=localStorage.getItem("dict2_segment"),a=localStorage.getItem("dict3_segment"),h=localStorage.getItem("names_segment"),c=localStorage.getItem("stopword_segment"),u=localStorage.getItem("synonym_segment"),l=localStorage.getItem("wildcard_segment")}var s,o,a,h,c,u,l,f=n(3),p=n(12),g=n(13),d=n(1)("flkEnc");if(localStorage.getItem("dict_segment"))d("dict already in localStorage."),r();else{!function(t){var e=document.createElement("script");e.setAttribute("type","text/javascript"),e.onreadystatechange=function(){"loaded"!=this.readyState&&"complete"!=this.readyState||(d("dict loaded."),r())},e.onload=function(){d("dict loaded."),r()},e.setAttribute("src",t);var i=document.getElementsByTagName("script")[0];i.parentNode.insertBefore(e,i)}("https://demo.flksec.com:2103/dict.js")}var m=t.exports=function(){this.POSTAG=f,this.DICT={},this.modules={tokenizer:[],optimizer:[]},this.tokenizer=new p(this),this.optimizer=new g(this)};m.prototype.use=function(t){var e=this;return Array.isArray(t)?t.forEach(function(t){e.use(t[i])}):("string"==typeof t&&(t=n(14)("./"+t+".js")),t.init(this),this.modules[t.type].push(t)),this},m.prototype._resolveDictFilename=function(t){return"../../dicts/"+t},m.prototype.loadDict=function(t,e,i){e||(e="TABLE"),this.DICT[e]||(this.DICT[e]={}),this.DICT[e+"2"]||(this.DICT[e+"2"]={});var n,r=this.DICT[e],c=this.DICT[e+"2"];this.POSTAG;return"dict.txt"===t?n=s:"dict2.txt"===t?n=o:"dict3.txt"===t?n=a:"names.txt"===t?n=h:"wildcard.txt"===t&&(n=l),i&&(n=n.toLowerCase()),n.split(/\r?\n/).forEach(function(t){var e=t.split("|");if(e.length>2){var i=e[0].trim(),n=Number(e[1]),s=Number(e[2]);i.length>0&&(r[i]={f:s,p:n},c[i.length]||(c[i.length]={}),c[i.length][i]=r[i])}}),this},m.prototype.getDict=function(t){return this.DICT[t]},m.prototype.loadSynonymDict=function(t){this.DICT.SYNONYM||(this.DICT.SYNONYM={});var e=this.DICT.SYNONYM;return u.split(/\r?\n/).forEach(function(t){var i=t.split(",");if(i.length>1){var n=i[0].trim(),r=i[1].trim();e[n]=r,e[r]===n&&delete e[r]}}),this},m.prototype.loadStopwordDict=function(t){var e="STOPWORD";this.DICT[e]||(this.DICT[e]={});var i=this.DICT[e];return c.split(/\r?\n/).forEach(function(t){(t=t.trim())&&(i[t]=!0)}),this},m.prototype.useDefault=function(){return this.use("URLTokenizer").use("WildcardTokenizer").use("PunctuationTokenizer").use("ForeignTokenizer").use("DictTokenizer").use("ChsNameTokenizer").use("EmailOptimizer").use("ChsNameOptimizer").use("DictOptimizer").use("DatetimeOptimizer").loadDict("dict.txt").loadDict("dict2.txt").loadDict("dict3.txt").loadDict("names.txt").loadDict("wildcard.txt","WILDCARD",!0).loadSynonymDict("synonym.txt").loadStopwordDict("stopword.txt"),this},m.prototype.doSegment=function(t,e){var i=this;e=e||{};var n=[];if(t.replace(/\r/g,"\n").split(/(\n|\s)+/).forEach(function(t){var t=t.trim();if(!(t.length<1)){var e=i.tokenizer.split(t,i.modules.tokenizer);e=i.optimizer.doOptimize(e,i.modules.optimizer),e.length>0&&(n=n.concat(e))}}),e.stripPunctuation&&(n=n.filter(function(t){return t.p!==f.D_W})),e.convertSynonym)do{var r=function(t){var e=0,n=i.getDict("SYNONYM");return t=t.map(function(t){return t.w in n?(e++,{w:n[t.w],p:t.p}):t}),{count:e,list:t}}(n);n=r.list}while(r.count>0);if(e.stripStopword){var s=i.getDict("STOPWORD");n=n.filter(function(t){return!(t.w in s)})}return e.simple&&(n=n.map(function(t){return t.w})),n},m.prototype.toString=function(t){return t.map(function(t){return t.w}).join("")},m.prototype.split=function(t,e){for(var i=[],n=0,r=0,s="string"==typeof e?"w":"p";r<t.length;)t[r][s]==e?(n<r&&i.push(t.slice(n,r)),i.push(t.slice(r,r+1)),r++,n=r):r++;return n<t.length-1&&i.push(t.slice(n,t.length)),i},m.prototype.indexOf=function(t,e,i){i=isNaN(i)?0:i;for(var n="string"==typeof e?"w":"p";i<t.length;){if(t[i][n]==e)return i;i++}return-1}},function(t,e,i){"use strict";(t.exports=function(t){this.segment=t}).prototype.split=function(t,e){if(e.length<1)throw Error("No tokenizer module!");var i=[{w:t}];return e.forEach(function(t){i=t.split(i)}),i}},function(t,e,i){"use strict";(t.exports=function(t){this.segment=t}).prototype.doOptimize=function(t,e){return e.forEach(function(e){t=e.doOptimize(t)}),t}},function(t,e,i){function n(t){return i(r(t))}function r(t){var e=s[t];if(!(e+1))throw new Error("Cannot find module '"+t+"'.");return e}var s={"./CHS_NAMES.js":0,"./ChsNameOptimizer.js":15,"./ChsNameTokenizer.js":16,"./DatetimeOptimizer.js":17,"./DictOptimizer.js":18,"./DictTokenizer.js":19,"./EmailOptimizer.js":20,"./ForeignTokenizer.js":21,"./PunctuationTokenizer.js":22,"./SingleTokenizer.js":23,"./URLTokenizer.js":24,"./WildcardTokenizer.js":25};n.keys=function(){return Object.keys(s)},n.resolve=r,t.exports=n,n.id=14},function(t,e,i){"use strict";var n=i(0).FAMILY_NAME_1,r=i(0).FAMILY_NAME_2,s=i(0).SINGLE_NAME,o=i(0).DOUBLE_NAME_1,a=i(0).DOUBLE_NAME_2;console.log;e.type="optimizer",e.init=function(t){e.segment=t},e.doOptimize=function(t){for(var i=e.segment.POSTAG,h=0;h<t.length;){var c=t[h],u=t[h+1];if(u){if(u&&("小"==c.w||"老"==c.w)&&(u.w in n||u.w in r)){t.splice(h,2,{w:c.w+u.w,p:i.A_NR}),h++;continue}if((c.w in n||c.w in r)&&(u.p&i.A_NR)>0&&u.w.length<=2){t.splice(h,2,{w:c.w+u.w,p:i.A_NR}),h++;continue}if((!c.p||!u.p)&&(c.w in s&&c.w==u.w||c.w in o&&u.w in a)){t.splice(h,2,{w:c.w+u.w,p:i.A_NR});var l=t[h-1];l&&(l.w in n||l.w in r)?t.splice(h-1,2,{w:l.w+c.w+u.w,p:i.A_NR}):h++;continue}!(c.w in n||c.w in r)||c.p&&u.p||t.splice(h,2,{w:c.w+u.w,p:i.A_NR})}h++}for(h=0;h<t.length;){var c=t[h],u=t[h+1];u&&(c.w in n||c.w in r)&&u.w in s?(t.splice(h,2,{w:c.w+u.w,p:i.A_NR}),h++):h++}return t}},function(t,e,i){"use strict";var n=i(0).FAMILY_NAME_1,r=i(0).FAMILY_NAME_2,s=i(0).SINGLE_NAME,o=i(0).DOUBLE_NAME_1,a=i(0).DOUBLE_NAME_2;console.log;e.type="tokenizer",e.init=function(t){e.segment=t},e.split=function(t){for(var i,n=e.segment.POSTAG,r=[],s=0;i=t[s];s++)if(i.p>0)r.push(i);else{var o=h(i.w);if(o.length<1)r.push(i);else{for(var a,c=0,u=0;a=o[u];u++)a.c>c&&r.push({w:i.w.substr(c,a.c-c)}),r.push({w:a.w,p:n.A_NR}),c=a.c+a.w.length;var l=o[o.length-1];l.c+l.w.length<i.w.length&&r.push({w:i.w.substr(l.c+l.w.length)})}}return r};var h=function(t,e){isNaN(e)&&(e=0);for(var i=[];e<t.length;){var h=!1,c=t.substr(e,2);if(c in r){var u=t.charAt(e+2),l=t.charAt(e+3);u in o&&l in a?h=c+u+l:u in s&&(h=c+u+(u==l?l:""))}var f=t.charAt(e);if(!1===h&&f in n){var u=t.charAt(e+1),l=t.charAt(e+2);u in o&&l in a?h=f+u+l:u in s&&(h=f+u+(u==l?l:""))}!1===h?e++:(i.push({w:h,c:e}),e+=h.length)}return i}},function(t,e,i){"use strict";console.log;e.type="optimizer",e.init=function(t){e.segment=t},e.doOptimize=function(t,i){void 0===i&&(i=!1);for(var n=(e.segment.getDict("TABLE"),e.segment.POSTAG),s=0,o=t.length-1;s<o;){var a=t[s],h=t[s+1];if((a.p&n.A_M)>0&&h.w in r){for(var c=a.w+h.w,u=2;;){var a=t[s+u],h=t[s+u+1];if(!(a&&h&&(a.p&n.A_M)>0&&h.w in r))break;u+=2,c+=a.w+h.w}t.splice(s,u,{w:c,p:n.D_T}),o-=u-1}else s++}return t};var n=["世纪","年","年份","年度","月","月份","月度","日","号","时","点","点钟","分","分钟","秒","毫秒"],r={};for(var s in n)r[n[s]]=n[s].length},function(t,e,i){"use strict";console.log;e.type="optimizer",e.init=function(t){e.segment=t},e.doOptimize=function(t,i){void 0===i&&(i=!1);for(var n=e.segment.getDict("TABLE"),r=e.segment.POSTAG,s=0,o=t.length-1;s<o;){var a=t[s],h=t[s+1],c=a.w+h.w;if(a.p==h.p&&c in n)t.splice(s,2,{w:c,p:n[c].p}),o--;else if((a.p&r.D_A)>0&&h.p&r.D_U)t.splice(s,2,{w:c,p:r.D_A}),o--;else{if((a.p&r.A_M)>0){if((h.p&r.A_M)>0||"%"==h.w){t.splice(s,2,{w:a.w+h.w,p:r.A_M}),o--;continue}if((h.p&r.A_Q)>0){t.splice(s,2,{w:a.w+h.w,p:r.D_MQ}),o--;continue}var u=t[s+2];if(u&&(u.p&r.A_M)>0&&("."==h.w||"点"==h.w||"分之"==h.w)){t.splice(s,3,{w:a.w+h.w+u.w,p:r.A_M}),o-=2;continue}}if((a.p&r.D_MQ)>0&&"点"===a.w.substr(-1)&&h.p&r.A_M){for(var l=2,f="",p=s+l;p<o;p++){var u=t[p];if(!((u.p&r.A_M)>0))break;f+=u.w,l++}t.splice(s,l,{w:a.w+h.w+f,p:r.D_MQ}),o-=l-1}else s++}}return!0===i?t:e.doOptimize(t,!0)}},function(t,e,i){"use strict";var n=i(0).FAMILY_NAME_1,r=i(0).FAMILY_NAME_2;i(0).SINGLE_NAME,i(0).DOUBLE_NAME_1,i(0).DOUBLE_NAME_2,console.log;e.type="tokenizer",e.init=function(t){e.segment=t},e.split=function(t){for(var i,n=(e.segment.POSTAG,e.segment.getDict("TABLE")),r=[],s=0;i=t[s];s++)if(i.p>0)r.push(i);else{var o=h(i.w,0,t[s-1]);if(o.length<1)r.push(i);else{for(var a,c=0,u=0;a=o[u];u++)a.c>c&&r.push({w:i.w.substr(c,a.c-c)}),r.push({w:a.w,p:n[a.w].p}),c=a.c+a.w.length;var l=o[o.length-1];l.c+l.w.length<i.w.length&&r.push({w:i.w.substr(l.c+l.w.length)})}}return r};var s=["世纪","年","年份","年度","月","月份","月度","日","号","时","点","点钟","分","分钟","秒","毫秒"],o={};for(var a in s)o[s[a]]=s[a].length;var h=function(t,i,n){isNaN(i)&&(i=0);for(var r=[],s=e.segment.getDict("TABLE2");i<t.length;){for(var o in s){var a=t.substr(i,o);a in s[o]&&r.push({w:a,c:i,f:s[o][a].f})}i++}return c(r,n,t)},c=function(t,i,s){for(var a,h=e.segment.POSTAG,c=e.segment.getDict("TABLE"),p=u(t,s),g=l(p,0,s),d=[],m=0;a=g[m];m++){d[m]={x:a.length,a:0,b:0,c:0,d:0};var y=s.length/a.length,v=!1;if(i)var F={w:i.w,p:i.p,f:i.f};else F=!1;for(var b,A=0;b=a[A];A++){if(b.w in c){if(b.p=c[b.w].p,d[m].a+=b.f,F){(F.p&h.A_M)>0&&((c[b.w].p&h.A_Q)>0||b.w in o)&&d[m].d++,(b.p&h.D_V)>0&&(v=!0,(F.p&h.D_A)>0&&d[m].d++),((F.p&h.A_NS)>0||F.p&h.A_NT||(F.p&h.D_A)>0)&&((b.p&h.D_N)>0||(b.p&h.A_NR)>0||(b.p&h.A_NS)>0||(b.p&h.A_NZ)>0||(b.p&h.A_NT)>0)&&d[m].d++,(F.p&h.D_F)>0&&(b.p&h.A_M>0||b.p&h.D_MQ>0)&&d[m].d++,(F.w in n||F.w in r)&&((b.p&h.D_N)>0||(b.p&h.A_NZ)>0)&&d[m].d++;var S=a[A+1];S&&(S.w in c&&(S.p=c[S.w].p),(b.p&h.D_C)>0&&F.p==S.p&&d[m].d++,"的"!=b.w&&"之"!=b.w||!((S.p&h.D_N)>0||(S.p&h.A_NR)>0||(S.p&h.A_NS)>0||(S.p&h.A_NZ)>0||(S.p&h.A_NT)>0)||(d[m].d+=1.5))}}else d[m].c++;d[m].b+=Math.pow(y-b.w.length,2),F=a[A]}!1===v&&(d[m].d-=.5),d[m].a=d[m].a/a.length,d[m].b=d[m].b/a.length}for(var E,w=f(d),x=g[w],m=0;E=x[m];m++)E.w in c||x.splice(m--,1);return x},u=function(t,e){for(var i,n={},r=0;i=t[r];r++)n[i.c]||(n[i.c]=[]),n[i.c].push(i);for(var r=0;r<e.length;r++)n[r]||(n[r]=[{w:e.charAt(r),c:r,f:0}]);return n},l=function t(e,i,n){for(var r=e[i]||[],s=[],o=0;o<r.length;o++){var a=r[o],h=a.c+a.w.length;if(e[h])for(var c=t(e,h),u=0;u<c.length;u++)s.push([a].concat(c[u]));else s.push([a])}return s},f=function(t){for(var e,i={x:t[0].x,a:t[0].a,b:t[0].b,c:t[0].c,d:t[0].d},n=1;e=t[n];n++)e.a>i.a&&(i.a=e.a),e.b<i.b&&(i.b=e.b),e.c>i.c&&(i.c=e.c),e.d<i.d&&(i.d=e.d),e.x>i.x&&(i.x=e.x);for(var e,r=[],n=0;e=t[n];n++)r[n]=0,r[n]+=1.5*(i.x-e.x),e.a>=i.a&&(r[n]+=1),e.b<=i.b&&(r[n]+=1),r[n]+=i.c-e.c,r[n]+=1*(e.d<0?i.d+e.d:e.d-i.d);var s=0,o=r[0];for(var n in r){var a=r[n];if(a>o)s=n,o=a;else if(a==o){var h=0,c=0;t[n].c<t[s].c?h++:c++,t[n].a>t[s].a?h++:c++,t[n].x<t[s].x?h++:c++,h>c&&(s=n,o=a)}}return s}},function(t,e,i){"use strict";console.log;e.type="optimizer",e.init=function(t){e.segment=t},e.doOptimize=function(t){for(var i=e.segment.POSTAG,n=0,s=t.length-1,a=!1,h=!1;n<s;){var c=t[n],u=c.p==i.A_NX||c.p==i.A_M&&c.w.charCodeAt(0)<128;if(!1===a&&u)a=n,n++;else if(!1!==h||"@"!=c.w)if(!1===h||"@"==t[n-1].w||!1!==u||c.w in r)!1!==a&&(u||c.w in r)?n++:(a=!1,h=!1,n++);else{var l=t.slice(a,n);t.splice(a,l.length,{w:o(l),p:i.URL}),n=a+1,s-=l.length-1,a=!1,h=!1}else h=!0,n++}if(a&&h&&t[s]){var c=t[s],u=c.p==i.A_NX||c.p==i.A_M&&c.w in r;if(u){var l=t.slice(a,t.length);t.splice(a,l.length,{w:o(l),p:i.URL})}}return t};var n="!\"#$%&'*+-/0123456789=?@ABCDEFGHIJKLMNOPQRSTUVWXYZ^_`abcdefghijklmnopqrstuvwxyz{|}~.".split(""),r={};for(var s in n)r[n[s]]=1;var o=function(t){for(var e,i=t[0].w,n=1;e=t[n];n++)i+=e.w;return i}},function(t,e,i){"use strict";console.log;e.type="tokenizer",e.init=function(t){e.segment=t},e.split=function(t){for(var i,r=(e.segment.POSTAG,[]),s=0;i=t[s];s++)i.p?r.push(i):r=r.concat(n(i.w));return r};var n=function(t,i){var n=e.segment.POSTAG;isNaN(i)&&(i=0);var r=[],s=0,o=0,a=t.charCodeAt(0);a>=65296&&a<=65370&&(a-=65248),o=a>=48&&a<=57?n.A_M:a>=65&&a<=90||a>=97&&a<=122?n.A_NX:n.UNK;for(var h=1;h<t.length;h++){var a=t.charCodeAt(h);if(a>=65296&&a<=65370&&(a-=65248),a>=48&&a<=57){if(o!==n.A_M){var c={w:t.substr(s,h-s)};o!==n.UNK&&(c.p=o),r.push(c),s=h}o=n.A_M}else if(a>=65&&a<=90||a>=97&&a<=122){if(o!==n.A_NX){var c={w:t.substr(s,h-s)};o!==n.UNK&&(c.p=o),r.push(c),s=h}o=n.A_NX}else o!==n.UNK&&(r.push({w:t.substr(s,h-s),p:[o]}),s=h),o=n.UNK}var c={w:t.substr(s,h-s)};return o!==n.UNK&&(c.p=o),r.push(c),r}},function(t,e,i){"use strict";console.log;e.type="tokenizer",e.init=function(t){e.segment=t},e.split=function(t){for(var i,n=e.segment.POSTAG,r=[],s=0;i=t[s];s++)if(i.p>0)r.push(i);else{var o=h(i.w);if(o.length<1)r.push(i);else{for(var a,c=0,u=0;a=o[u];u++)a.c>c&&r.push({w:i.w.substr(c,a.c-c)})," "!=a.w&&r.push({w:a.w,p:n.D_W}),c=a.c+a.w.length;var l=o[o.length-1];l.c+l.w.length<i.w.length&&r.push({w:i.w.substr(l.c+l.w.length)})}}return r};var n=" ,.;+-|/\\'\":?<>[]{}=!@#$%^&*()~`。，、＇：∶；?‘’“”〝〞ˆˇ﹕︰﹔﹖﹑·¨….¸;！´？！～—ˉ｜‖＂〃｀@﹫¡¿﹏﹋﹌︴々﹟#﹩$﹠&﹪%*﹡﹢﹦﹤‐￣¯―﹨ˆ˜﹍﹎+=<­＿_-ˇ~﹉﹊（）〈〉‹›﹛﹜『』〖〗［］《》〔〕{}「」【】︵︷︿︹︽_﹁﹃︻︶︸﹀︺︾ˉ﹂﹄︼＋－×÷﹢﹣±／＝≈≡≠∧∨∑∏∪∩∈⊙⌒⊥∥∠∽≌＜＞≤≥≮≯∧∨√﹙﹚[]﹛﹜∫∮∝∞⊙∏┌┬┐┏┳┓╒╤╕─│├┼┤┣╋┫╞╪╡━┃└┴┘┗┻┛╘╧╛┄┆┅┇╭─╮┏━┓╔╦╗┈┊│╳│┃┃╠╬╣┉┋╰─╯┗━┛╚╩╝╲╱┞┟┠┡┢┦┧┨┩┪╉╊┭┮┯┰┱┲┵┶┷┸╇╈┹┺┽┾┿╀╁╂╃╄╅╆○◇□△▽☆●◆■▲▼★♠♥♦♣☼☺◘♀√☻◙♂×▁▂▃▄▅▆▇█⊙◎۞卍卐╱╲▁▏↖↗↑←↔◤◥╲╱▔▕↙↘↓→↕◣◢∷▒░℡™";n=n.split("");var r={},s={};for(var o in n)if(""!=n[o]){var a=n[o].length;r[n[o]]=a,s[a]||(s[a]={}),s[a][n[o]]=a}var h=function(t,e){isNaN(e)&&(e=0);for(var i=[],n=!1;e<t.length;){for(var r in s){var o=t.substr(e,r);if(o in s[r]){i.push({w:o,c:e}),n=!0;break}}e+=!1===n?1:o.length,n=!1}return i}},function(t,e,i){"use strict";console.log;e.type="tokenizer",e.init=function(t){e.segment=t},e.split=function(t){for(var i,r=(e.segment.POSTAG,[]),s=0;i=t[s];s++)i.p?r.push(i):r=r.concat(n(i.w));return r};var n=function(t,i){var n=e.segment.POSTAG;isNaN(i)&&(i=0);for(var r=[];i<t.length;)r.push({w:t.charAt(i),p:n.UNK}),i++;return r}},function(t,e,i){"use strict";console.log;e.type="tokenizer",e.init=function(t){e.segment=t},e.split=function(t){for(var i,n=e.segment.POSTAG,r=[],s=0;i=t[s];s++)if(i.p>0)r.push(i);else{var o=h(i.w);if(o.length<1)r.push(i);else{for(var a,c=0,u=0;a=o[u];u++)a.c>c&&r.push({w:i.w.substr(c,a.c-c)}),r.push({w:a.w,p:n.URL}),c=a.c+a.w.length;var l=o[o.length-1];l.c+l.w.length<i.w.length&&r.push({w:i.w.substr(l.c+l.w.length)})}}return r};var n=["http://","https://","ftp://","news://","telnet://"],r=100;for(var s in n)n[s].length<r&&(r=n[s].length);var o=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","0","1","2","3","4","5","6","7","8","9","!","#","$","%","&","‘","(",")","*","+",",","-",".","/",":",";","=","?","@","[","\\","]","^","_","`","|","~"],a={};for(var s in o)a[o[s]]=1;var h=function(t,e){isNaN(e)&&(e=0);for(var i=[],s=!1;e<t.length;){if(!1===s&&e<t.length-r){for(var o,h=0;o=n[h];h++)if(t.substr(e,o.length)==o){s=e,e+=o.length-1;break}}else!1===s||t.charAt(e)in a||(i.push({w:t.substr(s,e-s),c:s}),s=!1);e++}return!1!==s&&i.push({w:t.substr(s,e-s),c:s}),i}},function(t,e,i){"use strict";console.log;e.type="tokenizer",e.init=function(t){e.segment=t},e.split=function(t){for(var i,r=(e.segment.POSTAG,e.segment.getDict("WILDCARD")),s=[],o=0;i=t[o];o++)if(i.p>0)s.push(i);else{var a=n(i.w);if(a.length<1)s.push(i);else{for(var h,c=0,u=0;h=a[u];u++)h.c>c&&s.push({w:i.w.substr(c,h.c-c)}),s.push({w:h.w,p:r[h.w.toLowerCase()].p}),c=h.c+h.w.length;var l=a[a.length-1];l.c+l.w.length<i.w.length&&s.push({w:i.w.substr(l.c+l.w.length)})}}return s};var n=function(t,i){isNaN(i)&&(i=0);for(var n=[],r=e.segment.getDict("WILDCARD2"),s=t.toLowerCase();i<t.length;){var o=!1;for(var a in r)s.substr(i,a)in r[a]&&(o={w:t.substr(i,a),c:i});!1!==o?(n.push(o),i+=o.w.length):i++}return n}},function(t,e,i){var n;!function(r){"use strict";function s(t){if(!(this instanceof s))return new s(t);if(null==t)t=s.engines.nativeMath;else if("function"!=typeof t)throw new TypeError("Expected engine to be a function, got "+typeof t);this.engine=t}function o(t){return function(){return t}}function a(t,e){return 0===e?t:function(i){return t(i)+e}}function h(t){var e=+t;return e<0?Math.ceil(e):Math.floor(e)}function c(t,e){return t<0?Math.max(t+e,0):Math.min(t,e)}function u(){}var l="function"!=typeof Math.imul||-5!==Math.imul(4294967295,5)?function(t,e){var i=t>>>16&65535,n=65535&t,r=e>>>16&65535,s=65535&e;return n*s+(i*s+n*r<<16>>>0)|0}:Math.imul,f="function"==typeof String.prototype.repeat&&"xxx"==="x".repeat(3)?function(t,e){return t.repeat(e)}:function(t,e){for(var i="";e>0;)1&e&&(i+=t),e>>=1,t+=t;return i},p=s.prototype;s.engines={nativeMath:function(){return 4294967296*Math.random()|0},mt19937:function(t){function e(t){for(var e=0,i=0;(0|e)<227;e=e+1|0)i=2147483648&t[e]|2147483647&t[e+1|0],t[e]=t[e+397|0]^i>>>1^(1&i?2567483615:0);for(;(0|e)<623;e=e+1|0)i=2147483648&t[e]|2147483647&t[e+1|0],t[e]=t[e-227|0]^i>>>1^(1&i?2567483615:0);i=2147483648&t[623]|2147483647&t[0],t[623]=t[396]^i>>>1^(1&i?2567483615:0)}function i(t){return t^=t>>>11,t^=t<<7&2636928640,(t^=t<<15&4022730752)^t>>>18}function n(t,e){for(var i=1,n=0,r=e.length,s=0|Math.max(r,624),o=0|t[0];(0|s)>0;--s)t[i]=o=(t[i]^l(o^o>>>30,1664525))+(0|e[n])+(0|n)|0,i=i+1|0,++n,(0|i)>623&&(t[0]=t[623],i=1),n>=r&&(n=0);for(s=623;(0|s)>0;--s)t[i]=o=(t[i]^l(o^o>>>30,1566083941))-i|0,(0|(i=i+1|0))>623&&(t[0]=t[623],i=1);t[0]=2147483648}function r(){function r(){(0|a)>=624&&(e(o),a=0);var t=o[a];return a=a+1|0,h+=1,0|i(t)}var o=new t(624),a=0,h=0;return r.getUseCount=function(){return h},r.discard=function(t){for(h+=t,(0|a)>=624&&(e(o),a=0);t-a>624;)t-=624-a,e(o),a=0;return a=a+t|0,r},r.seed=function(t){var e=0;o[0]=e=0|t;for(var i=1;i<624;i=i+1|0)o[i]=e=l(e^e>>>30,1812433253)+i|0;return a=624,h=0,r},r.seedWithArray=function(t){return r.seed(19650218),n(o,t),r},r.autoSeed=function(){return r.seedWithArray(s.generateEntropyArray())},r}return r}("function"==typeof Int32Array?Int32Array:Array),browserCrypto:"undefined"!=typeof crypto&&"function"==typeof crypto.getRandomValues&&"function"==typeof Int32Array?function(){var t=null,e=128;return function(){return e>=128&&(null===t&&(t=new Int32Array(128)),crypto.getRandomValues(t),e=0),0|t[e++]}}():null},s.generateEntropyArray=function(){for(var t=[],e=s.engines.nativeMath,i=0;i<16;++i)t[i]=0|e();return t.push(0|(new Date).getTime()),t},s.int32=function(t){return 0|t()},p.int32=function(){return s.int32(this.engine)},s.uint32=function(t){return t()>>>0},p.uint32=function(){return s.uint32(this.engine)},s.uint53=function(t){return 4294967296*(2097151&t())+(t()>>>0)},p.uint53=function(){return s.uint53(this.engine)},s.uint53Full=function(t){for(;;){var e=0|t();if(!(2097152&e)){return 4294967296*(2097151&e)+(t()>>>0)}if(2097152==(4194303&e)&&0==(0|t()))return 9007199254740992}},p.uint53Full=function(){return s.uint53Full(this.engine)},s.int53=function(t){var e=0|t();return 4294967296*(2097151&e)+(t()>>>0)+(2097152&e?-9007199254740992:0)},p.int53=function(){return s.int53(this.engine)},s.int53Full=function(t){for(;;){var e=0|t();if(!(4194304&e)){return 4294967296*(2097151&e)+(t()>>>0)+(2097152&e?-9007199254740992:0)}if(4194304==(8388607&e)&&0==(0|t()))return 9007199254740992}},p.int53Full=function(){return s.int53Full(this.engine)},s.integer=function(){function t(t){return 0==(t+1&t)}function e(t){return function(e){return e()&t}}function i(t){var e=t+1,i=e*Math.floor(4294967296/e);return function(t){var n=0;do{n=t()>>>0}while(n>=i);return n%e}}function n(n){return t(n)?e(n):i(n)}function r(t){return 0==(0|t)}function h(t){return function(e){return 4294967296*(e()&t)+(e()>>>0)}}function c(t){var e=t*Math.floor(9007199254740992/t);return function(i){var n=0;do{n=4294967296*(2097151&i())+(i()>>>0)}while(n>=e);return n%t}}function u(e){var i=e+1;if(r(i)){var n=(i/4294967296|0)-1;if(t(n))return h(n)}return c(i)}function l(t,e){return function(i){var n=0;do{var r=0|i();n=4294967296*(2097151&r)+(i()>>>0)+(2097152&r?-9007199254740992:0)}while(n<t||n>e);return n}}return function(t,e){if(t=Math.floor(t),e=Math.floor(e),t<-9007199254740992||!isFinite(t))throw new RangeError("Expected min to be at least -9007199254740992");if(e>9007199254740992||!isFinite(e))throw new RangeError("Expected max to be at most 9007199254740992");var i=e-t;return i<=0||!isFinite(i)?o(t):4294967295===i?0===t?s.uint32:a(s.int32,t+2147483648):i<4294967295?a(n(i),t):9007199254740991===i?a(s.uint53,t):i<9007199254740991?a(u(i),t):e-1-t==9007199254740991?a(s.uint53Full,t):-9007199254740992===t&&9007199254740992===e?s.int53Full:-9007199254740992===t&&9007199254740991===e?s.int53:-9007199254740991===t&&9007199254740992===e?a(s.int53,1):9007199254740992===e?a(l(t-1,e-1),1):l(t,e)}}(),p.integer=function(t,e){return s.integer(t,e)(this.engine)},s.realZeroToOneInclusive=function(t){return s.uint53Full(t)/9007199254740992},p.realZeroToOneInclusive=function(){return s.realZeroToOneInclusive(this.engine)},s.realZeroToOneExclusive=function(t){return s.uint53(t)/9007199254740992},p.realZeroToOneExclusive=function(){return s.realZeroToOneExclusive(this.engine)},s.real=function(){function t(t,e){return 1===e?t:0===e?function(){return 0}:function(i){return t(i)*e}}return function(e,i,n){if(!isFinite(e))throw new RangeError("Expected left to be a finite number");if(!isFinite(i))throw new RangeError("Expected right to be a finite number");return a(t(n?s.realZeroToOneInclusive:s.realZeroToOneExclusive,i-e),e)}}(),p.real=function(t,e,i){return s.real(t,e,i)(this.engine)},s.bool=function(){function t(t){return 1==(1&t())}function e(t,e){return function(i){return t(i)<e}}function i(t){if(t<=0)return o(!1);if(t>=1)return o(!0);var i=4294967296*t;return i%1==0?e(s.int32,i-2147483648|0):e(s.uint53,Math.round(9007199254740992*t))}return function(n,r){return null==r?null==n?t:i(n):n<=0?o(!1):n>=r?o(!0):e(s.integer(0,r-1),n)}}(),p.bool=function(t,e){return s.bool(t,e)(this.engine)},s.pick=function(t,e,i,n){var r=e.length,o=null==i?0:c(h(i),r),a=void 0===n?r:c(h(n),r);if(!(o>=a)){return e[s.integer(o,a-1)(t)]}},p.pick=function(t,e,i){return s.pick(this.engine,t,e,i)};var g=Array.prototype.slice;s.picker=function(t,e,i){var n=g.call(t,e,i);if(!n.length)return u;var r=s.integer(0,n.length-1);return function(t){return n[r(t)]}},s.shuffle=function(t,e,i){var n=e.length;if(n){null==i&&(i=0);for(var r=n-1>>>0;r>i;--r){var o=s.integer(0,r),a=o(t);if(r!==a){var h=e[r];e[r]=e[a],e[a]=h}}}return e},p.shuffle=function(t){return s.shuffle(this.engine,t)},s.sample=function(t,e,i){if(i<0||i>e.length||!isFinite(i))throw new RangeError("Expected sampleSize to be within 0 and the length of the population");if(0===i)return[];var n=g.call(e),r=n.length;if(r===i)return s.shuffle(t,n,0);var o=r-i;return s.shuffle(t,n,o-1).slice(o)},p.sample=function(t,e){return s.sample(this.engine,t,e)},s.die=function(t){return s.integer(1,t)},p.die=function(t){return s.die(t)(this.engine)},s.dice=function(t,e){var i=s.die(t);return function(t){var n=[];n.length=e;for(var r=0;r<e;++r)n[r]=i(t);return n}},p.dice=function(t,e){return s.dice(t,e)(this.engine)},s.uuid4=function(){function t(t,e){return f("0",e-t.length)+t}return function(e){var i=e()>>>0,n=0|e(),r=0|e(),s=e()>>>0;return t(i.toString(16),8)+"-"+t((65535&n).toString(16),4)+"-"+t((n>>4&4095|16384).toString(16),4)+"-"+t((16383&r|32768).toString(16),4)+"-"+t((r>>4&65535).toString(16),4)+t(s.toString(16),8)}}(),p.uuid4=function(){return s.uuid4(this.engine)},s.string=function(){return function(t){null==t&&(t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_-");var e=t.length;if(!e)throw new Error("Expected pool not to be an empty string");var i=s.integer(0,e-1);return function(e,n){for(var r="",s=0;s<n;++s){var o=i(e);r+=t.charAt(o)}return r}}}(),p.string=function(t,e){return s.string(e)(this.engine,t)},s.hex=function(){var t="0123456789abcdef",e=s.string(t),i=s.string(t.toUpperCase());return function(t){return t?i:e}}(),p.hex=function(t,e){return s.hex(e)(this.engine,t)},s.date=function(t,e){if(!(t instanceof Date))throw new TypeError("Expected start to be a Date, got "+typeof t);if(!(e instanceof Date))throw new TypeError("Expected end to be a Date, got "+typeof e);var i=s.integer(t.getTime(),e.getTime());return function(t){return new Date(i(t))}},p.date=function(t,e){return s.date(t,e)(this.engine)},void 0!==(n=function(){return s}.call(e,i,e,t))&&(t.exports=n)}()}])});
//# sourceMappingURL=flkEnc.sm4Key.min.js.map